debug:™
"use strict";
var kDefaultBacktraceLength=10;
var Debug={};
var sourceLineBeginningSkip=/^(?:\s*(?:\/\*.*?\*\/)*)*/;
Debug.DebugEvent={Break:1,
Exception:2,
NewFunction:3,
BeforeCompile:4,
AfterCompile:5,
CompileError:6,
PromiseEvent:7,
AsyncTaskEvent:8};
Debug.ExceptionBreak={Caught:0,
Uncaught:1};
Debug.StepAction={StepOut:0,
StepNext:1,
StepIn:2,
StepMin:3,
StepInMin:4,
StepFrame:5};
Debug.ScriptType={Native:0,
Extension:1,
Normal:2};
Debug.ScriptCompilationType={Host:0,
Eval:1,
JSON:2};
Debug.ScriptBreakPointType={ScriptId:0,
ScriptName:1,
ScriptRegExp:2};
Debug.BreakPositionAlignment={
Statement:0,
BreakPosition:1
};
function ScriptTypeFlag(a){
return(1<<a);
}
var next_response_seq=0;
var next_break_point_number=1;
var break_points=[];
var script_break_points=[];
var debugger_flags={
breakPointsActive:{
value:true,
getValue:function(){return this.value;},
setValue:function(a){
this.value=!!a;
%SetDisableBreak(!this.value);
}
},
breakOnCaughtException:{
getValue:function(){return Debug.isBreakOnException();},
setValue:function(a){
if(a){
Debug.setBreakOnException();
}else{
Debug.clearBreakOnException();
}
}
},
breakOnUncaughtException:{
getValue:function(){return Debug.isBreakOnUncaughtException();},
setValue:function(a){
if(a){
Debug.setBreakOnUncaughtException();
}else{
Debug.clearBreakOnUncaughtException();
}
}
},
};
function MakeBreakPoint(a,b){
var c=new BreakPoint(a,b);
break_points.push(c);
return c;
}
function BreakPoint(a,b){
this.source_position_=a;
if(b){
this.script_break_point_=b;
}else{
this.number_=next_break_point_number++;
}
this.hit_count_=0;
this.active_=true;
this.condition_=null;
this.ignoreCount_=0;
}
BreakPoint.prototype.number=function(){
return this.number_;
};
BreakPoint.prototype.func=function(){
return this.func_;
};
BreakPoint.prototype.source_position=function(){
return this.source_position_;
};
BreakPoint.prototype.hit_count=function(){
return this.hit_count_;
};
BreakPoint.prototype.active=function(){
if(this.script_break_point()){
return this.script_break_point().active();
}
return this.active_;
};
BreakPoint.prototype.condition=function(){
if(this.script_break_point()&&this.script_break_point().condition()){
return this.script_break_point().condition();
}
return this.condition_;
};
BreakPoint.prototype.ignoreCount=function(){
return this.ignoreCount_;
};
BreakPoint.prototype.script_break_point=function(){
return this.script_break_point_;
};
BreakPoint.prototype.enable=function(){
this.active_=true;
};
BreakPoint.prototype.disable=function(){
this.active_=false;
};
BreakPoint.prototype.setCondition=function(a){
this.condition_=a;
};
BreakPoint.prototype.setIgnoreCount=function(a){
this.ignoreCount_=a;
};
BreakPoint.prototype.isTriggered=function(a){
if(!this.active())return false;
if(this.condition()){
try{
var b=a.frame(0).evaluate(this.condition());
if(!(b instanceof ValueMirror)||
!builtins.$toBoolean(b.value_)){
return false;
}
}catch(e){
return false;
}
}
this.hit_count_++;
if(this.script_break_point_){
this.script_break_point_.hit_count_++;
}
if(this.ignoreCount_>0){
this.ignoreCount_--;
return false;
}
return true;
};
function IsBreakPointTriggered(a,b){
return b.isTriggered(MakeExecutionState(a));
}
function ScriptBreakPoint(type,script_id_or_name,opt_line,opt_column,
opt_groupId,opt_position_alignment){
this.type_=type;
if(type==Debug.ScriptBreakPointType.ScriptId){
this.script_id_=script_id_or_name;
}else if(type==Debug.ScriptBreakPointType.ScriptName){
this.script_name_=script_id_or_name;
}else if(type==Debug.ScriptBreakPointType.ScriptRegExp){
this.script_regexp_object_=new RegExp(script_id_or_name);
}else{
throw new Error("Unexpected breakpoint type "+type);
}
this.line_=opt_line||0;
this.column_=opt_column;
this.groupId_=opt_groupId;
this.position_alignment_=(opt_position_alignment===(void 0))
?Debug.BreakPositionAlignment.Statement:opt_position_alignment;
this.hit_count_=0;
this.active_=true;
this.condition_=null;
this.ignoreCount_=0;
this.break_points_=[];
}
ScriptBreakPoint.prototype.cloneForOtherScript=function(a){
var b=new ScriptBreakPoint(Debug.ScriptBreakPointType.ScriptId,
a.id,this.line_,this.column_,this.groupId_,
this.position_alignment_);
b.number_=next_break_point_number++;
script_break_points.push(b);
b.hit_count_=this.hit_count_;
b.active_=this.active_;
b.condition_=this.condition_;
b.ignoreCount_=this.ignoreCount_;
return b;
};
ScriptBreakPoint.prototype.number=function(){
return this.number_;
};
ScriptBreakPoint.prototype.groupId=function(){
return this.groupId_;
};
ScriptBreakPoint.prototype.type=function(){
return this.type_;
};
ScriptBreakPoint.prototype.script_id=function(){
return this.script_id_;
};
ScriptBreakPoint.prototype.script_name=function(){
return this.script_name_;
};
ScriptBreakPoint.prototype.script_regexp_object=function(){
return this.script_regexp_object_;
};
ScriptBreakPoint.prototype.line=function(){
return this.line_;
};
ScriptBreakPoint.prototype.column=function(){
return this.column_;
};
ScriptBreakPoint.prototype.actual_locations=function(){
var a=[];
for(var b=0;b<this.break_points_.length;b++){
a.push(this.break_points_[b].actual_location);
}
return a;
};
ScriptBreakPoint.prototype.update_positions=function(a,b){
this.line_=a;
this.column_=b;
};
ScriptBreakPoint.prototype.hit_count=function(){
return this.hit_count_;
};
ScriptBreakPoint.prototype.active=function(){
return this.active_;
};
ScriptBreakPoint.prototype.condition=function(){
return this.condition_;
};
ScriptBreakPoint.prototype.ignoreCount=function(){
return this.ignoreCount_;
};
ScriptBreakPoint.prototype.enable=function(){
this.active_=true;
};
ScriptBreakPoint.prototype.disable=function(){
this.active_=false;
};
ScriptBreakPoint.prototype.setCondition=function(a){
this.condition_=a;
};
ScriptBreakPoint.prototype.setIgnoreCount=function(a){
this.ignoreCount_=a;
for(var b=0;b<this.break_points_.length;b++){
this.break_points_[b].setIgnoreCount(a);
}
};
ScriptBreakPoint.prototype.matchesScript=function(a){
if(this.type_==Debug.ScriptBreakPointType.ScriptId){
return this.script_id_==a.id;
}else{
if(!(a.line_offset<=this.line_&&
this.line_<a.line_offset+a.lineCount())){
return false;
}
if(this.type_==Debug.ScriptBreakPointType.ScriptName){
return this.script_name_==a.nameOrSourceURL();
}else if(this.type_==Debug.ScriptBreakPointType.ScriptRegExp){
return this.script_regexp_object_.test(a.nameOrSourceURL());
}else{
throw new Error("Unexpected breakpoint type "+this.type_);
}
}
};
ScriptBreakPoint.prototype.set=function(a){
var b=this.column();
var c=this.line();
if((b===(void 0))){
var d=a.sourceLine(this.line());
if(!a.sourceColumnStart_){
a.sourceColumnStart_=new Array(a.lineCount());
}
if((a.sourceColumnStart_[c]===(void 0))){
a.sourceColumnStart_[c]=
d.match(sourceLineBeginningSkip)[0].length;
}
b=a.sourceColumnStart_[c];
}
var e=Debug.findScriptSourcePosition(a,this.line(),b);
if((e===null))return;
var f=MakeBreakPoint(e,this);
f.setIgnoreCount(this.ignoreCount());
var g=%SetScriptBreakPoint(a,e,
this.position_alignment_,
f);
if((g===(void 0))){
g=e;
}
var h=a.locationFromPosition(g,true);
f.actual_location={line:h.line,
column:h.column,
script_id:a.id};
this.break_points_.push(f);
return f;
};
ScriptBreakPoint.prototype.clear=function(){
var a=[];
for(var b=0;b<break_points.length;b++){
if(break_points[b].script_break_point()&&
break_points[b].script_break_point()===this){
%ClearBreakPoint(break_points[b]);
}else{
a.push(break_points[b]);
}
}
break_points=a;
this.break_points_=[];
};
function UpdateScriptBreakPoints(a){
for(var b=0;b<script_break_points.length;b++){
var c=script_break_points[b];
if((c.type()==Debug.ScriptBreakPointType.ScriptName||
c.type()==Debug.ScriptBreakPointType.ScriptRegExp)&&
c.matchesScript(a)){
c.set(a);
}
}
}
function GetScriptBreakPoints(a){
var b=[];
for(var c=0;c<script_break_points.length;c++){
if(script_break_points[c].matchesScript(a)){
b.push(script_break_points[c]);
}
}
return b;
}
Debug.setListener=function(a,b){
if(!(%_IsFunction(a))&&!(a===(void 0))&&!(a===null)){
throw new Error('Parameters have wrong types.');
}
%SetDebugEventListener(a,b);
};
Debug.breakLocations=function(a,b){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
var c=(b===(void 0))
?Debug.BreakPositionAlignment.Statement:b;
return %GetBreakLocations(a,c);
};
Debug.findScript=function(a){
if((%_IsFunction(a))){
return %FunctionGetScript(a);
}else if((%_IsRegExp(a))){
var b=Debug.scripts();
var c=null;
var d=0;
for(var e in b){
var g=b[e];
if(a.test(g.name)){
c=g;
d++;
}
}
if(d==1){
return c;
}else{
return undefined;
}
}else{
return %GetScript(a);
}
};
Debug.scriptSource=function(a){
return this.findScript(a).source;
};
Debug.source=function(a){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
return %FunctionGetSourceCode(a);
};
Debug.sourcePosition=function(a){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
return %FunctionGetScriptSourcePosition(a);
};
Debug.findFunctionSourceLocation=function(a,b,c){
var d=%FunctionGetScript(a);
var e=%FunctionGetScriptSourcePosition(a);
return d.locationFromLine(b,c,e);
};
Debug.findScriptSourcePosition=function(a,b,c){
var d=a.locationFromLine(b,c);
return d?d.position:null;
};
Debug.findBreakPoint=function(a,b){
var c;
for(var d=0;d<break_points.length;d++){
if(break_points[d].number()==a){
c=break_points[d];
if(b){
break_points.splice(d,1);
}
break;
}
}
if(c){
return c;
}else{
return this.findScriptBreakPoint(a,b);
}
};
Debug.findBreakPointActualLocations=function(a){
for(var b=0;b<script_break_points.length;b++){
if(script_break_points[b].number()==a){
return script_break_points[b].actual_locations();
}
}
for(var b=0;b<break_points.length;b++){
if(break_points[b].number()==a){
return[break_points[b].actual_location];
}
}
return[];
};
Debug.setBreakPoint=function(a,b,c,d){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
if(%FunctionIsAPIFunction(a)){
throw new Error('Cannot set break point in native code.');
}
var e=
this.findFunctionSourceLocation(a,b,c).position;
var g=e-this.sourcePosition(a);
var h=%FunctionGetScript(a);
if(h.type==Debug.ScriptType.Native){
throw new Error('Cannot set break point in native code.');
}
if(h&&h.id){
g+=%FunctionGetScriptSourcePosition(a);
var i=h.locationFromPosition(g,false);
return this.setScriptBreakPointById(h.id,
i.line,i.column,
d);
}else{
var j=MakeBreakPoint(g);
var k=
%SetFunctionBreakPoint(a,g,j);
k+=this.sourcePosition(a);
var l=h.locationFromPosition(k,true);
j.actual_location={line:l.line,
column:l.column,
script_id:h.id};
j.setCondition(d);
return j.number();
}
};
Debug.setBreakPointByScriptIdAndPosition=function(script_id,position,
condition,enabled,
opt_position_alignment)
{
var a=MakeBreakPoint(position);
a.setCondition(condition);
if(!enabled){
a.disable();
}
var b=this.scripts();
var c=(opt_position_alignment===(void 0))
?Debug.BreakPositionAlignment.Statement:opt_position_alignment;
for(var d=0;d<b.length;d++){
if(script_id==b[d].id){
a.actual_position=%SetScriptBreakPoint(b[d],position,
c,a);
break;
}
}
return a;
};
Debug.enableBreakPoint=function(a){
var b=this.findBreakPoint(a,false);
if(b){
b.enable();
}
};
Debug.disableBreakPoint=function(a){
var b=this.findBreakPoint(a,false);
if(b){
b.disable();
}
};
Debug.changeBreakPointCondition=function(a,b){
var c=this.findBreakPoint(a,false);
c.setCondition(b);
};
Debug.changeBreakPointIgnoreCount=function(a,b){
if(b<0){
throw new Error('Invalid argument');
}
var c=this.findBreakPoint(a,false);
c.setIgnoreCount(b);
};
Debug.clearBreakPoint=function(a){
var b=this.findBreakPoint(a,true);
if(b){
return %ClearBreakPoint(b);
}else{
b=this.findScriptBreakPoint(a,true);
if(!b){
throw new Error('Invalid breakpoint');
}
}
};
Debug.clearAllBreakPoints=function(){
for(var a=0;a<break_points.length;a++){
var b=break_points[a];
%ClearBreakPoint(b);
}
break_points=[];
};
Debug.disableAllBreakPoints=function(){
for(var a=1;a<next_break_point_number;a++){
Debug.disableBreakPoint(a);
}
%ChangeBreakOnException(Debug.ExceptionBreak.Caught,false);
%ChangeBreakOnException(Debug.ExceptionBreak.Uncaught,false);
};
Debug.findScriptBreakPoint=function(a,b){
var c;
for(var d=0;d<script_break_points.length;d++){
if(script_break_points[d].number()==a){
c=script_break_points[d];
if(b){
c.clear();
script_break_points.splice(d,1);
}
break;
}
}
return c;
};
Debug.setScriptBreakPoint=function(type,script_id_or_name,
opt_line,opt_column,opt_condition,
opt_groupId,opt_position_alignment){
var a=
new ScriptBreakPoint(type,script_id_or_name,opt_line,opt_column,
opt_groupId,opt_position_alignment);
a.number_=next_break_point_number++;
a.setCondition(opt_condition);
script_break_points.push(a);
var b=this.scripts();
for(var c=0;c<b.length;c++){
if(a.matchesScript(b[c])){
a.set(b[c]);
}
}
return a.number();
};
Debug.setScriptBreakPointById=function(script_id,
opt_line,opt_column,
opt_condition,opt_groupId,
opt_position_alignment){
return this.setScriptBreakPoint(Debug.ScriptBreakPointType.ScriptId,
script_id,opt_line,opt_column,
opt_condition,opt_groupId,
opt_position_alignment);
};
Debug.setScriptBreakPointByName=function(script_name,
opt_line,opt_column,
opt_condition,opt_groupId){
return this.setScriptBreakPoint(Debug.ScriptBreakPointType.ScriptName,
script_name,opt_line,opt_column,
opt_condition,opt_groupId);
};
Debug.setScriptBreakPointByRegExp=function(script_regexp,
opt_line,opt_column,
opt_condition,opt_groupId){
return this.setScriptBreakPoint(Debug.ScriptBreakPointType.ScriptRegExp,
script_regexp,opt_line,opt_column,
opt_condition,opt_groupId);
};
Debug.enableScriptBreakPoint=function(a){
var b=this.findScriptBreakPoint(a,false);
b.enable();
};
Debug.disableScriptBreakPoint=function(a){
var b=this.findScriptBreakPoint(a,false);
b.disable();
};
Debug.changeScriptBreakPointCondition=function(
break_point_number,condition){
var a=this.findScriptBreakPoint(break_point_number,false);
a.setCondition(condition);
};
Debug.changeScriptBreakPointIgnoreCount=function(
break_point_number,ignoreCount){
if(ignoreCount<0){
throw new Error('Invalid argument');
}
var a=this.findScriptBreakPoint(break_point_number,false);
a.setIgnoreCount(ignoreCount);
};
Debug.scriptBreakPoints=function(){
return script_break_points;
};
Debug.clearStepping=function(){
%ClearStepping();
};
Debug.setBreakOnException=function(){
return %ChangeBreakOnException(Debug.ExceptionBreak.Caught,true);
};
Debug.clearBreakOnException=function(){
return %ChangeBreakOnException(Debug.ExceptionBreak.Caught,false);
};
Debug.isBreakOnException=function(){
return!!%IsBreakOnException(Debug.ExceptionBreak.Caught);
};
Debug.setBreakOnUncaughtException=function(){
return %ChangeBreakOnException(Debug.ExceptionBreak.Uncaught,true);
};
Debug.clearBreakOnUncaughtException=function(){
return %ChangeBreakOnException(Debug.ExceptionBreak.Uncaught,false);
};
Debug.isBreakOnUncaughtException=function(){
return!!%IsBreakOnException(Debug.ExceptionBreak.Uncaught);
};
Debug.showBreakPoints=function(a,b,c){
if(!(%_IsFunction(a)))throw new Error('Parameters have wrong types.');
var d=b?this.scriptSource(a):this.source(a);
var e=b?this.sourcePosition(a):0;
var g=this.breakLocations(a,c);
if(!g)return d;
g.sort(function(h,i){return h-i;});
var j="";
var k=0;
var l;
for(var m=0;m<g.length;m++){
l=g[m]-e;
j+=d.slice(k,l);
j+="[B"+m+"]";
k=l;
}
l=d.length;
j+=d.substring(k,l);
return j;
};
Debug.scripts=function(){
return %DebugGetLoadedScripts();
};
Debug.debuggerFlags=function(){
return debugger_flags;
};
Debug.MakeMirror=MakeMirror;
function MakeExecutionState(a){
return new ExecutionState(a);
}
function ExecutionState(a){
this.break_id=a;
this.selected_frame=0;
}
ExecutionState.prototype.prepareStep=function(opt_action,opt_count,
opt_callframe){
var a=Debug.StepAction.StepIn;
if(!(opt_action===(void 0)))a=builtins.$toNumber(opt_action);
var b=opt_count?builtins.$toNumber(opt_count):1;
var c=0;
if(!(opt_callframe===(void 0))){
c=opt_callframe.details_.frameId();
}
return %PrepareStep(this.break_id,a,b,c);
};
ExecutionState.prototype.evaluateGlobal=function(source,disable_break,
opt_additional_context){
return MakeMirror(%DebugEvaluateGlobal(this.break_id,source,
Boolean(disable_break),
opt_additional_context));
};
ExecutionState.prototype.frameCount=function(){
return %GetFrameCount(this.break_id);
};
ExecutionState.prototype.threadCount=function(){
return %GetThreadCount(this.break_id);
};
ExecutionState.prototype.frame=function(a){
if(a==null)a=this.selected_frame;
if(a<0||a>=this.frameCount()){
throw new Error('Illegal frame index.');
}
return new FrameMirror(this.break_id,a);
};
ExecutionState.prototype.setSelectedFrame=function(a){
var b=builtins.$toNumber(a);
if(b<0||b>=this.frameCount())throw new Error('Illegal frame index.');
this.selected_frame=b;
};
ExecutionState.prototype.selectedFrame=function(){
return this.selected_frame;
};
ExecutionState.prototype.debugCommandProcessor=function(a){
return new DebugCommandProcessor(this,a);
};
function MakeBreakEvent(a,b){
return new BreakEvent(a,b);
}
function BreakEvent(a,b){
this.frame_=new FrameMirror(a,0);
this.break_points_hit_=b;
}
BreakEvent.prototype.eventType=function(){
return Debug.DebugEvent.Break;
};
BreakEvent.prototype.func=function(){
return this.frame_.func();
};
BreakEvent.prototype.sourceLine=function(){
return this.frame_.sourceLine();
};
BreakEvent.prototype.sourceColumn=function(){
return this.frame_.sourceColumn();
};
BreakEvent.prototype.sourceLineText=function(){
return this.frame_.sourceLineText();
};
BreakEvent.prototype.breakPointsHit=function(){
return this.break_points_hit_;
};
BreakEvent.prototype.toJSONProtocol=function(){
var a={seq:next_response_seq++,
type:"event",
event:"break",
body:{invocationText:this.frame_.invocationText()}
};
var b=this.func().script();
if(b){
a.body.sourceLine=this.sourceLine(),
a.body.sourceColumn=this.sourceColumn(),
a.body.sourceLineText=this.sourceLineText(),
a.body.script=MakeScriptObject_(b,false);
}
if(this.breakPointsHit()){
a.body.breakpoints=[];
for(var c=0;c<this.breakPointsHit().length;c++){
var d=this.breakPointsHit()[c];
var e=d.script_break_point();
var g;
if(e){
g=e.number();
}else{
g=d.number();
}
a.body.breakpoints.push(g);
}
}
return JSON.stringify(ObjectToProtocolObject_(a));
};
function MakeExceptionEvent(a,b,c,d){
return new ExceptionEvent(a,b,c,d);
}
function ExceptionEvent(a,b,c,d){
this.exec_state_=new ExecutionState(a);
this.exception_=b;
this.uncaught_=c;
this.promise_=d;
}
ExceptionEvent.prototype.eventType=function(){
return Debug.DebugEvent.Exception;
};
ExceptionEvent.prototype.exception=function(){
return this.exception_;
};
ExceptionEvent.prototype.uncaught=function(){
return this.uncaught_;
};
ExceptionEvent.prototype.promise=function(){
return this.promise_;
};
ExceptionEvent.prototype.func=function(){
return this.exec_state_.frame(0).func();
};
ExceptionEvent.prototype.sourceLine=function(){
return this.exec_state_.frame(0).sourceLine();
};
ExceptionEvent.prototype.sourceColumn=function(){
return this.exec_state_.frame(0).sourceColumn();
};
ExceptionEvent.prototype.sourceLineText=function(){
return this.exec_state_.frame(0).sourceLineText();
};
ExceptionEvent.prototype.toJSONProtocol=function(){
var a=new ProtocolMessage();
a.event="exception";
a.body={uncaught:this.uncaught_,
exception:MakeMirror(this.exception_)
};
if(this.exec_state_.frameCount()>0){
a.body.sourceLine=this.sourceLine();
a.body.sourceColumn=this.sourceColumn();
a.body.sourceLineText=this.sourceLineText();
var b=this.func().script();
if(b){
a.body.script=MakeScriptObject_(b,false);
}
}else{
a.body.sourceLine=-1;
}
return a.toJSONProtocol();
};
function MakeCompileEvent(a,b){
return new CompileEvent(a,b);
}
function CompileEvent(a,b){
this.script_=MakeMirror(a);
this.type_=b;
}
CompileEvent.prototype.eventType=function(){
return this.type_;
};
CompileEvent.prototype.script=function(){
return this.script_;
};
CompileEvent.prototype.toJSONProtocol=function(){
var a=new ProtocolMessage();
a.running=true;
switch(this.type_){
case Debug.DebugEvent.BeforeCompile:
a.event="beforeCompile";
break;
case Debug.DebugEvent.AfterCompile:
a.event="afterCompile";
break;
case Debug.DebugEvent.CompileError:
a.event="compileError";
break;
}
a.body={};
a.body.script=this.script_;
return a.toJSONProtocol();
};
function MakeScriptObject_(a,b){
var c={id:a.id(),
name:a.name(),
lineOffset:a.lineOffset(),
columnOffset:a.columnOffset(),
lineCount:a.lineCount(),
};
if(!(a.data()===(void 0))){
c.data=a.data();
}
if(b){
c.source=a.source();
}
return c;
}
function MakePromiseEvent(a){
return new PromiseEvent(a);
}
function PromiseEvent(a){
this.promise_=a.promise;
this.parentPromise_=a.parentPromise;
this.status_=a.status;
this.value_=a.value;
}
PromiseEvent.prototype.promise=function(){
return MakeMirror(this.promise_);
}
PromiseEvent.prototype.parentPromise=function(){
return MakeMirror(this.parentPromise_);
}
PromiseEvent.prototype.status=function(){
return this.status_;
}
PromiseEvent.prototype.value=function(){
return MakeMirror(this.value_);
}
function MakeAsyncTaskEvent(a){
return new AsyncTaskEvent(a);
}
function AsyncTaskEvent(a){
this.type_=a.type;
this.name_=a.name;
this.id_=a.id;
}
AsyncTaskEvent.prototype.type=function(){
return this.type_;
}
AsyncTaskEvent.prototype.name=function(){
return this.name_;
}
AsyncTaskEvent.prototype.id=function(){
return this.id_;
}
function DebugCommandProcessor(a,b){
this.exec_state_=a;
this.running_=b||false;
}
DebugCommandProcessor.prototype.processDebugRequest=function(a){
return this.processDebugJSONRequest(a);
};
function ProtocolMessage(a){
this.seq=next_response_seq++;
if(a){
this.type='response';
this.request_seq=a.seq;
this.command=a.command;
}else{
this.type='event';
}
this.success=true;
this.running=undefined;
}
ProtocolMessage.prototype.setOption=function(a,b){
if(!this.options_){
this.options_={};
}
this.options_[a]=b;
};
ProtocolMessage.prototype.failed=function(a,b){
this.success=false;
this.message=a;
if((%_IsObject(b))){
this.error_details=b;
}
};
ProtocolMessage.prototype.toJSONProtocol=function(){
var a={};
a.seq=this.seq;
if(this.request_seq){
a.request_seq=this.request_seq;
}
a.type=this.type;
if(this.event){
a.event=this.event;
}
if(this.command){
a.command=this.command;
}
if(this.success){
a.success=this.success;
}else{
a.success=false;
}
if(this.body){
var b;
var c=MakeMirrorSerializer(true,this.options_);
if(this.body instanceof Mirror){
b=c.serializeValue(this.body);
}else if(this.body instanceof Array){
b=[];
for(var d=0;d<this.body.length;d++){
if(this.body[d]instanceof Mirror){
b.push(c.serializeValue(this.body[d]));
}else{
b.push(ObjectToProtocolObject_(this.body[d],c));
}
}
}else{
b=ObjectToProtocolObject_(this.body,c);
}
a.body=b;
a.refs=c.serializeReferencedObjects();
}
if(this.message){
a.message=this.message;
}
if(this.error_details){
a.error_details=this.error_details;
}
a.running=this.running;
return JSON.stringify(a);
};
DebugCommandProcessor.prototype.createResponse=function(a){
return new ProtocolMessage(a);
};
DebugCommandProcessor.prototype.processDebugJSONRequest=function(
json_request){
var a;
var b;
try{
try{
a=JSON.parse(json_request);
b=this.createResponse(a);
if(!a.type){
throw new Error('Type not specified');
}
if(a.type!='request'){
throw new Error("Illegal type '"+a.type+"' in request");
}
if(!a.command){
throw new Error('Command not specified');
}
if(a.arguments){
var c=a.arguments;
if(c.inlineRefs||c.compactFormat){
b.setOption('inlineRefs',true);
}
if(!(c.maxStringLength===(void 0))){
b.setOption('maxStringLength',c.maxStringLength);
}
}
var d=a.command.toLowerCase();
var e=DebugCommandProcessor.prototype.dispatch_[d];
if((%_IsFunction(e))){
%_CallFunction(this,a,b,e);
}else{
throw new Error('Unknown command "'+a.command+'" in request');
}
}catch(e){
if(!b){
b=this.createResponse();
}
b.success=false;
b.message=builtins.$toString(e);
}
try{
if(!(b.running===(void 0))){
this.running_=b.running;
}
b.running=this.running_;
return b.toJSONProtocol();
}catch(e){
return'{"seq":'+b.seq+','+
'"request_seq":'+a.seq+','+
'"type":"response",'+
'"success":false,'+
'"message":"Internal error: '+builtins.$toString(e)+'"}';
}
}catch(e){
return'{"seq":0,"type":"response","success":false,"message":"Internal error"}';
}
};
DebugCommandProcessor.prototype.continueRequest_=function(a,b){
if(a.arguments){
var c=1;
var d=Debug.StepAction.StepIn;
var e=a.arguments.stepaction;
var g=a.arguments.stepcount;
if(g){
c=builtins.$toNumber(g);
if(c<0){
throw new Error('Invalid stepcount argument "'+g+'".');
}
}
if(e){
if(e=='in'){
d=Debug.StepAction.StepIn;
}else if(e=='min'){
d=Debug.StepAction.StepMin;
}else if(e=='next'){
d=Debug.StepAction.StepNext;
}else if(e=='out'){
d=Debug.StepAction.StepOut;
}else{
throw new Error('Invalid stepaction argument "'+e+'".');
}
}
this.exec_state_.prepareStep(d,c);
}
b.running=true;
};
DebugCommandProcessor.prototype.breakRequest_=function(a,b){
};
DebugCommandProcessor.prototype.setBreakPointRequest_=
function(a,b){
if(!a.arguments){
b.failed('Missing arguments');
return;
}
var c=a.arguments.type;
var d=a.arguments.target;
var e=a.arguments.line;
var g=a.arguments.column;
var h=(a.arguments.enabled===(void 0))?
true:a.arguments.enabled;
var i=a.arguments.condition;
var j=a.arguments.ignoreCount;
var k=a.arguments.groupId;
if(!c||(d===(void 0))){
b.failed('Missing argument "type" or "target"');
return;
}
var l;
if(c=='function'){
if(!(typeof(d)==='string')){
b.failed('Argument "target" is not a string value');
return;
}
var m;
try{
m=this.exec_state_.evaluateGlobal(d).value();
}catch(e){
b.failed('Error: "'+builtins.$toString(e)+
'" evaluating "'+d+'"');
return;
}
if(!(%_IsFunction(m))){
b.failed('"'+d+'" does not evaluate to a function');
return;
}
l=Debug.setBreakPoint(m,e,g,i);
}else if(c=='handle'){
var n=parseInt(d,10);
var o=LookupMirror(n);
if(!o){
return b.failed('Object #'+n+'# not found');
}
if(!o.isFunction()){
return b.failed('Object #'+n+'# is not a function');
}
l=Debug.setBreakPoint(o.value(),
e,g,i);
}else if(c=='script'){
l=
Debug.setScriptBreakPointByName(d,e,g,i,
k);
}else if(c=='scriptId'){
l=
Debug.setScriptBreakPointById(d,e,g,i,k);
}else if(c=='scriptRegExp'){
l=
Debug.setScriptBreakPointByRegExp(d,e,g,i,
k);
}else{
b.failed('Illegal type "'+c+'"');
return;
}
var p=Debug.findBreakPoint(l);
if(j){
Debug.changeBreakPointIgnoreCount(l,j);
}
if(!h){
Debug.disableBreakPoint(l);
}
b.body={type:c,
breakpoint:l};
if(p instanceof ScriptBreakPoint){
if(p.type()==Debug.ScriptBreakPointType.ScriptId){
b.body.type='scriptId';
b.body.script_id=p.script_id();
}else if(p.type()==Debug.ScriptBreakPointType.ScriptName){
b.body.type='scriptName';
b.body.script_name=p.script_name();
}else if(p.type()==Debug.ScriptBreakPointType.ScriptRegExp){
b.body.type='scriptRegExp';
b.body.script_regexp=p.script_regexp_object().source;
}else{
throw new Error("Internal error: Unexpected breakpoint type: "+
p.type());
}
b.body.line=p.line();
b.body.column=p.column();
b.body.actual_locations=p.actual_locations();
}else{
b.body.type='function';
b.body.actual_locations=[p.actual_location];
}
};
DebugCommandProcessor.prototype.changeBreakPointRequest_=function(
request,response){
if(!request.arguments){
response.failed('Missing arguments');
return;
}
var a=builtins.$toNumber(request.arguments.breakpoint);
var b=request.arguments.enabled;
var c=request.arguments.condition;
var d=request.arguments.ignoreCount;
if(!a){
response.failed('Missing argument "breakpoint"');
return;
}
if(!(b===(void 0))){
if(b){
Debug.enableBreakPoint(a);
}else{
Debug.disableBreakPoint(a);
}
}
if(!(c===(void 0))){
Debug.changeBreakPointCondition(a,c);
}
if(!(d===(void 0))){
Debug.changeBreakPointIgnoreCount(a,d);
}
};
DebugCommandProcessor.prototype.clearBreakPointGroupRequest_=function(
request,response){
if(!request.arguments){
response.failed('Missing arguments');
return;
}
var a=request.arguments.groupId;
if(!a){
response.failed('Missing argument "groupId"');
return;
}
var b=[];
var c=[];
for(var d=0;d<script_break_points.length;d++){
var e=script_break_points[d];
if(e.groupId()==a){
b.push(e.number());
e.clear();
}else{
c.push(e);
}
}
script_break_points=c;
response.body={breakpoints:b};
};
DebugCommandProcessor.prototype.clearBreakPointRequest_=function(
request,response){
if(!request.arguments){
response.failed('Missing arguments');
return;
}
var a=builtins.$toNumber(request.arguments.breakpoint);
if(!a){
response.failed('Missing argument "breakpoint"');
return;
}
Debug.clearBreakPoint(a);
response.body={breakpoint:a};
};
DebugCommandProcessor.prototype.listBreakpointsRequest_=function(
request,response){
var a=[];
for(var b=0;b<script_break_points.length;b++){
var c=script_break_points[b];
var d={
number:c.number(),
line:c.line(),
column:c.column(),
groupId:c.groupId(),
hit_count:c.hit_count(),
active:c.active(),
condition:c.condition(),
ignoreCount:c.ignoreCount(),
actual_locations:c.actual_locations()
};
if(c.type()==Debug.ScriptBreakPointType.ScriptId){
d.type='scriptId';
d.script_id=c.script_id();
}else if(c.type()==Debug.ScriptBreakPointType.ScriptName){
d.type='scriptName';
d.script_name=c.script_name();
}else if(c.type()==Debug.ScriptBreakPointType.ScriptRegExp){
d.type='scriptRegExp';
d.script_regexp=c.script_regexp_object().source;
}else{
throw new Error("Internal error: Unexpected breakpoint type: "+
c.type());
}
a.push(d);
}
response.body={
breakpoints:a,
breakOnExceptions:Debug.isBreakOnException(),
breakOnUncaughtExceptions:Debug.isBreakOnUncaughtException()
};
};
DebugCommandProcessor.prototype.disconnectRequest_=
function(a,b){
Debug.disableAllBreakPoints();
this.continueRequest_(a,b);
};
DebugCommandProcessor.prototype.setExceptionBreakRequest_=
function(a,b){
if(!a.arguments){
b.failed('Missing arguments');
return;
}
var c=a.arguments.type;
if(!c){
b.failed('Missing argument "type"');
return;
}
var d;
if(c=='all'){
d=!Debug.isBreakOnException();
}else if(c=='uncaught'){
d=!Debug.isBreakOnUncaughtException();
}
if(!(a.arguments.enabled===(void 0))){
d=a.arguments.enabled;
if((d!=true)&&(d!=false)){
b.failed('Illegal value for "enabled":"'+d+'"');
}
}
if(c=='all'){
%ChangeBreakOnException(Debug.ExceptionBreak.Caught,d);
}else if(c=='uncaught'){
%ChangeBreakOnException(Debug.ExceptionBreak.Uncaught,d);
}else{
b.failed('Unknown "type":"'+c+'"');
}
b.body={'type':c,'enabled':d};
};
DebugCommandProcessor.prototype.backtraceRequest_=function(
request,response){
var a=this.exec_state_.frameCount();
if(a==0){
response.body={
totalFrames:a
};
return;
}
var b=0;
var c=kDefaultBacktraceLength;
if(request.arguments){
if(request.arguments.fromFrame){
b=request.arguments.fromFrame;
}
if(request.arguments.toFrame){
c=request.arguments.toFrame;
}
if(request.arguments.bottom){
var d=a-b;
b=a-c;
c=d;
}
if(b<0||c<0){
return response.failed('Invalid frame number');
}
}
c=Math.min(a,c);
if(c<=b){
var e='Invalid frame range';
return response.failed(e);
}
var g=[];
for(var h=b;h<c;h++){
g.push(this.exec_state_.frame(h));
}
response.body={
fromFrame:b,
toFrame:c,
totalFrames:a,
frames:g
};
};
DebugCommandProcessor.prototype.frameRequest_=function(a,b){
if(this.exec_state_.frameCount()==0){
return b.failed('No frames');
}
if(a.arguments){
var c=a.arguments.number;
if(c<0||this.exec_state_.frameCount()<=c){
return b.failed('Invalid frame number');
}
this.exec_state_.setSelectedFrame(a.arguments.number);
}
b.body=this.exec_state_.frame();
};
DebugCommandProcessor.prototype.resolveFrameFromScopeDescription_=
function(a){
if(a&&!(a.frameNumber===(void 0))){
var b=a.frameNumber;
if(b<0||this.exec_state_.frameCount()<=b){
throw new Error('Invalid frame number');
}
return this.exec_state_.frame(b);
}else{
return this.exec_state_.frame();
}
};
DebugCommandProcessor.prototype.resolveScopeHolder_=
function(a){
if(a&&"functionHandle"in a){
if(!(typeof(a.functionHandle)==='number')){
throw new Error('Function handle must be a number');
}
var b=LookupMirror(a.functionHandle);
if(!b){
throw new Error('Failed to find function object by handle');
}
if(!b.isFunction()){
throw new Error('Value of non-function type is found by handle');
}
return b;
}else{
if(this.exec_state_.frameCount()==0){
throw new Error('No scopes');
}
var c=this.resolveFrameFromScopeDescription_(a);
return c;
}
}
DebugCommandProcessor.prototype.scopesRequest_=function(a,b){
var c=this.resolveScopeHolder_(a.arguments);
var d=c.scopeCount();
var e=[];
for(var g=0;g<d;g++){
e.push(c.scope(g));
}
b.body={
fromScope:0,
toScope:d,
totalScopes:d,
scopes:e
};
};
DebugCommandProcessor.prototype.scopeRequest_=function(a,b){
var c=this.resolveScopeHolder_(a.arguments);
var d=0;
if(a.arguments&&!(a.arguments.number===(void 0))){
d=builtins.$toNumber(a.arguments.number);
if(d<0||c.scopeCount()<=d){
return b.failed('Invalid scope number');
}
}
b.body=c.scope(d);
};
DebugCommandProcessor.resolveValue_=function(a){
if("handle"in a){
var b=LookupMirror(a.handle);
if(!b){
throw new Error("Failed to resolve value by handle, ' #"+
a.handle+"# not found");
}
return b.value();
}else if("stringDescription"in a){
if(a.type==BOOLEAN_TYPE){
return Boolean(a.stringDescription);
}else if(a.type==NUMBER_TYPE){
return Number(a.stringDescription);
}if(a.type==STRING_TYPE){
return String(a.stringDescription);
}else{
throw new Error("Unknown type");
}
}else if("value"in a){
return a.value;
}else if(a.type==UNDEFINED_TYPE){
return(void 0);
}else if(a.type==NULL_TYPE){
return null;
}else{
throw new Error("Failed to parse value description");
}
};
DebugCommandProcessor.prototype.setVariableValueRequest_=
function(a,b){
if(!a.arguments){
b.failed('Missing arguments');
return;
}
if((a.arguments.name===(void 0))){
b.failed('Missing variable name');
}
var c=a.arguments.name;
var d=a.arguments.scope;
var e=this.resolveScopeHolder_(d);
if((d.number===(void 0))){
b.failed('Missing scope number');
}
var g=builtins.$toNumber(d.number);
var h=e.scope(g);
var i=
DebugCommandProcessor.resolveValue_(a.arguments.newValue);
h.setVariableValue(c,i);
var j=MakeMirror(i);
b.body={
newValue:j
};
};
DebugCommandProcessor.prototype.evaluateRequest_=function(a,b){
if(!a.arguments){
return b.failed('Missing arguments');
}
var c=a.arguments.expression;
var d=a.arguments.frame;
var e=a.arguments.global;
var g=a.arguments.disable_break;
var h=a.arguments.additional_context;
try{
c=String(c);
}catch(e){
return b.failed('Failed to convert expression argument to string');
}
if(!(d===(void 0))&&e){
return b.failed('Arguments "frame" and "global" are exclusive');
}
var i;
if(h){
i={};
for(var j=0;j<h.length;j++){
var k=h[j];
if(!(typeof(k.name)==='string')){
return b.failed("Context element #"+j+
" doesn't contain name:string property");
}
var l=DebugCommandProcessor.resolveValue_(k);
i[k.name]=l;
}
}
if(e){
b.body=this.exec_state_.evaluateGlobal(
c,Boolean(g),i);
return;
}
if((g===(void 0))){
g=true;
}
if(this.exec_state_.frameCount()==0){
return b.failed('No frames');
}
if(!(d===(void 0))){
var m=builtins.$toNumber(d);
if(m<0||m>=this.exec_state_.frameCount()){
return b.failed('Invalid frame "'+d+'"');
}
b.body=this.exec_state_.frame(m).evaluate(
c,Boolean(g),i);
return;
}else{
b.body=this.exec_state_.frame().evaluate(
c,Boolean(g),i);
return;
}
};
DebugCommandProcessor.prototype.lookupRequest_=function(a,b){
if(!a.arguments){
return b.failed('Missing arguments');
}
var c=a.arguments.handles;
if((c===(void 0))){
return b.failed('Argument "handles" missing');
}
if(!(a.arguments.includeSource===(void 0))){
var d=builtins.$toBoolean(a.arguments.includeSource);
b.setOption('includeSource',d);
}
var e={};
for(var g=0;g<c.length;g++){
var h=c[g];
var i=LookupMirror(h);
if(!i){
return b.failed('Object #'+h+'# not found');
}
e[h]=i;
}
b.body=e;
};
DebugCommandProcessor.prototype.referencesRequest_=
function(a,b){
if(!a.arguments){
return b.failed('Missing arguments');
}
var c=a.arguments.type;
var d=a.arguments.handle;
if((c===(void 0))){
return b.failed('Argument "type" missing');
}
if((d===(void 0))){
return b.failed('Argument "handle" missing');
}
if(c!='referencedBy'&&c!='constructedBy'){
return b.failed('Invalid type "'+c+'"');
}
var e=LookupMirror(d);
if(e){
if(c=='referencedBy'){
b.body=e.referencedBy();
}else{
b.body=e.constructedBy();
}
}else{
return b.failed('Object #'+d+'# not found');
}
};
DebugCommandProcessor.prototype.sourceRequest_=function(a,b){
if(this.exec_state_.frameCount()==0){
return b.failed('No source');
}
var c;
var d;
var e=this.exec_state_.frame();
if(a.arguments){
c=a.arguments.fromLine;
d=a.arguments.toLine;
if(!(a.arguments.frame===(void 0))){
var g=builtins.$toNumber(a.arguments.frame);
if(g<0||g>=this.exec_state_.frameCount()){
return b.failed('Invalid frame "'+e+'"');
}
e=this.exec_state_.frame(g);
}
}
var h=e.func().script();
if(!h){
return b.failed('No source');
}
var i=h.sourceSlice(c,d);
if(!i){
return b.failed('Invalid line interval');
}
b.body={};
b.body.source=i.sourceText();
b.body.fromLine=i.from_line;
b.body.toLine=i.to_line;
b.body.fromPosition=i.from_position;
b.body.toPosition=i.to_position;
b.body.totalLines=h.lineCount();
};
DebugCommandProcessor.prototype.scriptsRequest_=function(a,b){
var c=ScriptTypeFlag(Debug.ScriptType.Normal);
var d=false;
var e=null;
if(a.arguments){
if(!(a.arguments.types===(void 0))){
c=builtins.$toNumber(a.arguments.types);
if(isNaN(c)||c<0){
return b.failed('Invalid types "'+
a.arguments.types+'"');
}
}
if(!(a.arguments.includeSource===(void 0))){
d=builtins.$toBoolean(a.arguments.includeSource);
b.setOption('includeSource',d);
}
if((%_IsArray(a.arguments.ids))){
e={};
var g=a.arguments.ids;
for(var h=0;h<g.length;h++){
e[g[h]]=true;
}
}
var i=null;
var j=null;
if(!(a.arguments.filter===(void 0))){
var k=builtins.$toNumber(a.arguments.filter);
if(!isNaN(k)){
j=k;
}
i=a.arguments.filter;
}
}
var l=%DebugGetLoadedScripts();
b.body=[];
for(var h=0;h<l.length;h++){
if(e&&!e[l[h].id]){
continue;
}
if(i||j){
var m=l[h];
var n=false;
if(j&&!n){
if(m.id&&m.id===j){
n=true;
}
}
if(i&&!n){
if(m.name&&m.name.indexOf(i)>=0){
n=true;
}
}
if(!n)continue;
}
if(c&ScriptTypeFlag(l[h].type)){
b.body.push(MakeMirror(l[h]));
}
}
};
DebugCommandProcessor.prototype.threadsRequest_=function(a,b){
var c=this.exec_state_.threadCount();
var d=[];
for(var e=0;e<c;e++){
var g=%GetThreadDetails(this.exec_state_.break_id,e);
var h={current:g[0],
id:g[1]
};
d.push(h);
}
b.body={
totalThreads:c,
threads:d
};
};
DebugCommandProcessor.prototype.suspendRequest_=function(a,b){
b.running=false;
};
DebugCommandProcessor.prototype.versionRequest_=function(a,b){
b.body={
V8Version:%GetV8Version()
};
};
DebugCommandProcessor.prototype.changeLiveRequest_=function(
request,response){
if(!request.arguments){
return response.failed('Missing arguments');
}
var a=request.arguments.script_id;
var b=!!request.arguments.preview_only;
var c=%DebugGetLoadedScripts();
var d=null;
for(var e=0;e<c.length;e++){
if(c[e].id==a){
d=c[e];
}
}
if(!d){
response.failed('Script not found');
return;
}
var g=new Array();
if(!(typeof(request.arguments.new_source)==='string')){
throw"new_source argument expected";
}
var h=request.arguments.new_source;
var i;
try{
i=Debug.LiveEdit.SetScriptSource(d,
h,b,g);
}catch(e){
if(e instanceof Debug.LiveEdit.Failure&&"details"in e){
response.failed(e.message,e.details);
return;
}
throw e;
}
response.body={change_log:g,result:i};
if(!b&&!this.running_&&i.stack_modified){
response.body.stepin_recommended=true;
}
};
DebugCommandProcessor.prototype.restartFrameRequest_=function(
request,response){
if(!request.arguments){
return response.failed('Missing arguments');
}
var a=request.arguments.frame;
if(this.exec_state_.frameCount()==0){
return response.failed('No frames');
}
var b;
if(!(a===(void 0))){
var c=builtins.$toNumber(a);
if(c<0||c>=this.exec_state_.frameCount()){
return response.failed('Invalid frame "'+a+'"');
}
b=this.exec_state_.frame(c);
}else{
b=this.exec_state_.frame();
}
var d=Debug.LiveEdit.RestartFrame(b);
response.body={result:d};
};
DebugCommandProcessor.prototype.debuggerFlagsRequest_=function(request,
response){
if(!request.arguments){
response.failed('Missing arguments');
return;
}
var a=request.arguments.flags;
response.body={flags:[]};
if(!(a===(void 0))){
for(var b=0;b<a.length;b++){
var c=a[b].name;
var d=debugger_flags[c];
if(!d){
continue;
}
if('value'in a[b]){
d.setValue(a[b].value);
}
response.body.flags.push({name:c,value:d.getValue()});
}
}else{
for(var c in debugger_flags){
var e=debugger_flags[c].getValue();
response.body.flags.push({name:c,value:e});
}
}
};
DebugCommandProcessor.prototype.v8FlagsRequest_=function(a,b){
var c=a.arguments.flags;
if(!c)c='';
%SetFlags(c);
};
DebugCommandProcessor.prototype.gcRequest_=function(a,b){
var c=a.arguments.type;
if(!c)c='all';
var d=%GetHeapUsage();
%CollectGarbage(c);
var e=%GetHeapUsage();
b.body={"before":d,"after":e};
};
DebugCommandProcessor.prototype.dispatch_=(function(){
var a=DebugCommandProcessor.prototype;
return{
"continue":a.continueRequest_,
"break":a.breakRequest_,
"setbreakpoint":a.setBreakPointRequest_,
"changebreakpoint":a.changeBreakPointRequest_,
"clearbreakpoint":a.clearBreakPointRequest_,
"clearbreakpointgroup":a.clearBreakPointGroupRequest_,
"disconnect":a.disconnectRequest_,
"setexceptionbreak":a.setExceptionBreakRequest_,
"listbreakpoints":a.listBreakpointsRequest_,
"backtrace":a.backtraceRequest_,
"frame":a.frameRequest_,
"scopes":a.scopesRequest_,
"scope":a.scopeRequest_,
"setvariablevalue":a.setVariableValueRequest_,
"evaluate":a.evaluateRequest_,
"lookup":a.lookupRequest_,
"references":a.referencesRequest_,
"source":a.sourceRequest_,
"scripts":a.scriptsRequest_,
"threads":a.threadsRequest_,
"suspend":a.suspendRequest_,
"version":a.versionRequest_,
"changelive":a.changeLiveRequest_,
"restartframe":a.restartFrameRequest_,
"flags":a.debuggerFlagsRequest_,
"v8flag":a.v8FlagsRequest_,
"gc":a.gcRequest_,
};
})();
DebugCommandProcessor.prototype.isRunning=function(){
return this.running_;
};
DebugCommandProcessor.prototype.systemBreak=function(a,b){
return %SystemBreak();
};
function ObjectToProtocolObject_(a,b){
var c={};
for(var d in a){
if(typeof d=='string'){
var e=ValueToProtocolValue_(a[d],
b);
if(!(e===(void 0))){
c[d]=e;
}
}
}
return c;
}
function ArrayToProtocolArray_(a,b){
var c=[];
for(var d=0;d<a.length;d++){
c.push(ValueToProtocolValue_(a[d],b));
}
return c;
}
function ValueToProtocolValue_(a,b){
var c;
switch(typeof a){
case'object':
if(a instanceof Mirror){
c=b.serializeValue(a);
}else if((%_IsArray(a))){
c=ArrayToProtocolArray_(a,b);
}else{
c=ObjectToProtocolObject_(a,b);
}
break;
case'boolean':
case'string':
case'number':
c=a;
break;
default:
c=null;
}
return c;
}

mirror~‘
"use strict";
var next_handle_=0;
var next_transient_handle_=-1;
var mirror_cache_=[];
var mirror_cache_enabled_=true;
function ToggleMirrorCache(a){
mirror_cache_enabled_=a;
next_handle_=0;
mirror_cache_=[];
}
function ObjectIsPromise(a){
try{
return(%_IsSpecObject(a))&&
!(%DebugGetProperty(a,builtins.$promiseStatus)===(void 0));
}catch(e){
return false;
}
}
function MakeMirror(a,b){
var c;
if(!b&&mirror_cache_enabled_){
for(var d in mirror_cache_){
c=mirror_cache_[d];
if(c.value()===a){
return c;
}
if(c.isNumber()&&isNaN(c.value())&&
typeof a=='number'&&isNaN(a)){
return c;
}
}
}
if((a===(void 0))){
c=new UndefinedMirror();
}else if((a===null)){
c=new NullMirror();
}else if((typeof(a)==='boolean')){
c=new BooleanMirror(a);
}else if((typeof(a)==='number')){
c=new NumberMirror(a);
}else if((typeof(a)==='string')){
c=new StringMirror(a);
}else if((typeof(a)==='symbol')){
c=new SymbolMirror(a);
}else if((%_IsArray(a))){
c=new ArrayMirror(a);
}else if((%_ClassOf(a)==='Date')){
c=new DateMirror(a);
}else if((%_IsFunction(a))){
c=new FunctionMirror(a);
}else if((%_IsRegExp(a))){
c=new RegExpMirror(a);
}else if((%_ClassOf(a)==='Error')){
c=new ErrorMirror(a);
}else if((%_ClassOf(a)==='Script')){
c=new ScriptMirror(a);
}else if((%_ClassOf(a)==='Map')||(%_ClassOf(a)==='WeakMap')){
c=new MapMirror(a);
}else if((%_ClassOf(a)==='Set')||(%_ClassOf(a)==='WeakSet')){
c=new SetMirror(a);
}else if((%_ClassOf(a)==='Map Iterator')||(%_ClassOf(a)==='Set Iterator')){
c=new IteratorMirror(a);
}else if(ObjectIsPromise(a)){
c=new PromiseMirror(a);
}else if((%_ClassOf(a)==='Generator')){
c=new GeneratorMirror(a);
}else{
c=new ObjectMirror(a,OBJECT_TYPE,b);
}
if(mirror_cache_enabled_)mirror_cache_[c.handle()]=c;
return c;
}
function LookupMirror(a){
if(!mirror_cache_enabled_)throw new Error("Mirror cache is disabled");
return mirror_cache_[a];
}
function GetUndefinedMirror(){
return MakeMirror((void 0));
}
function inherits(a,b){
var c=function(){};
c.prototype=b.prototype;
a.super_=b.prototype;
a.prototype=new c();
a.prototype.constructor=a;
}
var UNDEFINED_TYPE='undefined';
var NULL_TYPE='null';
var BOOLEAN_TYPE='boolean';
var NUMBER_TYPE='number';
var STRING_TYPE='string';
var SYMBOL_TYPE='symbol';
var OBJECT_TYPE='object';
var FUNCTION_TYPE='function';
var REGEXP_TYPE='regexp';
var ERROR_TYPE='error';
var PROPERTY_TYPE='property';
var INTERNAL_PROPERTY_TYPE='internalProperty';
var FRAME_TYPE='frame';
var SCRIPT_TYPE='script';
var CONTEXT_TYPE='context';
var SCOPE_TYPE='scope';
var PROMISE_TYPE='promise';
var MAP_TYPE='map';
var SET_TYPE='set';
var ITERATOR_TYPE='iterator';
var GENERATOR_TYPE='generator';
var kMaxProtocolStringLength=80;
var PropertyKind={};
PropertyKind.Named=1;
PropertyKind.Indexed=2;
var PropertyType={};
PropertyType.Data=0;
PropertyType.DataConstant=2;
PropertyType.AccessorConstant=3;
var PropertyAttribute={};
PropertyAttribute.None=0;
PropertyAttribute.ReadOnly=1;
PropertyAttribute.DontEnum=2;
PropertyAttribute.DontDelete=4;
var ScopeType={Global:0,
Local:1,
With:2,
Closure:3,
Catch:4,
Block:5,
Script:6};
function Mirror(a){
this.type_=a;
}
Mirror.prototype.type=function(){
return this.type_;
};
Mirror.prototype.isValue=function(){
return this instanceof ValueMirror;
};
Mirror.prototype.isUndefined=function(){
return this instanceof UndefinedMirror;
};
Mirror.prototype.isNull=function(){
return this instanceof NullMirror;
};
Mirror.prototype.isBoolean=function(){
return this instanceof BooleanMirror;
};
Mirror.prototype.isNumber=function(){
return this instanceof NumberMirror;
};
Mirror.prototype.isString=function(){
return this instanceof StringMirror;
};
Mirror.prototype.isSymbol=function(){
return this instanceof SymbolMirror;
};
Mirror.prototype.isObject=function(){
return this instanceof ObjectMirror;
};
Mirror.prototype.isFunction=function(){
return this instanceof FunctionMirror;
};
Mirror.prototype.isUnresolvedFunction=function(){
return this instanceof UnresolvedFunctionMirror;
};
Mirror.prototype.isArray=function(){
return this instanceof ArrayMirror;
};
Mirror.prototype.isDate=function(){
return this instanceof DateMirror;
};
Mirror.prototype.isRegExp=function(){
return this instanceof RegExpMirror;
};
Mirror.prototype.isError=function(){
return this instanceof ErrorMirror;
};
Mirror.prototype.isPromise=function(){
return this instanceof PromiseMirror;
};
Mirror.prototype.isGenerator=function(){
return this instanceof GeneratorMirror;
};
Mirror.prototype.isProperty=function(){
return this instanceof PropertyMirror;
};
Mirror.prototype.isInternalProperty=function(){
return this instanceof InternalPropertyMirror;
};
Mirror.prototype.isFrame=function(){
return this instanceof FrameMirror;
};
Mirror.prototype.isScript=function(){
return this instanceof ScriptMirror;
};
Mirror.prototype.isContext=function(){
return this instanceof ContextMirror;
};
Mirror.prototype.isScope=function(){
return this instanceof ScopeMirror;
};
Mirror.prototype.isMap=function(){
return this instanceof MapMirror;
};
Mirror.prototype.isSet=function(){
return this instanceof SetMirror;
};
Mirror.prototype.isIterator=function(){
return this instanceof IteratorMirror;
};
Mirror.prototype.allocateHandle_=function(){
if(mirror_cache_enabled_)this.handle_=next_handle_++;
};
Mirror.prototype.allocateTransientHandle_=function(){
this.handle_=next_transient_handle_--;
};
Mirror.prototype.toText=function(){
return"#<"+this.constructor.name+">";
};
function ValueMirror(a,b,c){
%_CallFunction(this,a,Mirror);
this.value_=b;
if(!c){
this.allocateHandle_();
}else{
this.allocateTransientHandle_();
}
}
inherits(ValueMirror,Mirror);
Mirror.prototype.handle=function(){
return this.handle_;
};
ValueMirror.prototype.isPrimitive=function(){
var a=this.type();
return a==='undefined'||
a==='null'||
a==='boolean'||
a==='number'||
a==='string'||
a==='symbol';
};
ValueMirror.prototype.value=function(){
return this.value_;
};
function UndefinedMirror(){
%_CallFunction(this,UNDEFINED_TYPE,(void 0),ValueMirror);
}
inherits(UndefinedMirror,ValueMirror);
UndefinedMirror.prototype.toText=function(){
return'undefined';
};
function NullMirror(){
%_CallFunction(this,NULL_TYPE,null,ValueMirror);
}
inherits(NullMirror,ValueMirror);
NullMirror.prototype.toText=function(){
return'null';
};
function BooleanMirror(a){
%_CallFunction(this,BOOLEAN_TYPE,a,ValueMirror);
}
inherits(BooleanMirror,ValueMirror);
BooleanMirror.prototype.toText=function(){
return this.value_?'true':'false';
};
function NumberMirror(a){
%_CallFunction(this,NUMBER_TYPE,a,ValueMirror);
}
inherits(NumberMirror,ValueMirror);
NumberMirror.prototype.toText=function(){
return %_NumberToString(this.value_);
};
function StringMirror(a){
%_CallFunction(this,STRING_TYPE,a,ValueMirror);
}
inherits(StringMirror,ValueMirror);
StringMirror.prototype.length=function(){
return this.value_.length;
};
StringMirror.prototype.getTruncatedValue=function(a){
if(a!=-1&&this.length()>a){
return this.value_.substring(0,a)+
'... (length: '+this.length()+')';
}
return this.value_;
};
StringMirror.prototype.toText=function(){
return this.getTruncatedValue(kMaxProtocolStringLength);
};
function SymbolMirror(a){
%_CallFunction(this,SYMBOL_TYPE,a,ValueMirror);
}
inherits(SymbolMirror,ValueMirror);
SymbolMirror.prototype.description=function(){
return %SymbolDescription(%_ValueOf(this.value_));
}
SymbolMirror.prototype.toText=function(){
return %_CallFunction(this.value_,builtins.$symbolToString);
}
function ObjectMirror(a,b,c){
%_CallFunction(this,b||OBJECT_TYPE,a,c,ValueMirror);
}
inherits(ObjectMirror,ValueMirror);
ObjectMirror.prototype.className=function(){
return %_ClassOf(this.value_);
};
ObjectMirror.prototype.constructorFunction=function(){
return MakeMirror(%DebugGetProperty(this.value_,'constructor'));
};
ObjectMirror.prototype.prototypeObject=function(){
return MakeMirror(%DebugGetProperty(this.value_,'prototype'));
};
ObjectMirror.prototype.protoObject=function(){
return MakeMirror(%DebugGetPrototype(this.value_));
};
ObjectMirror.prototype.hasNamedInterceptor=function(){
var a=%GetInterceptorInfo(this.value_);
return(a&2)!=0;
};
ObjectMirror.prototype.hasIndexedInterceptor=function(){
var a=%GetInterceptorInfo(this.value_);
return(a&1)!=0;
};
function TryGetPropertyNames(a){
try{
return %GetOwnPropertyNames(a,32);
}catch(e){
return[];
}
}
ObjectMirror.prototype.propertyNames=function(a,b){
a=a||PropertyKind.Named|PropertyKind.Indexed;
var c;
var d;
var e=0;
if(a&PropertyKind.Named){
c=TryGetPropertyNames(this.value_);
e+=c.length;
if(this.hasNamedInterceptor()&&(a&PropertyKind.Named)){
var g=
%GetNamedInterceptorPropertyNames(this.value_);
if(g){
c=c.concat(g);
e+=g.length;
}
}
}
if(a&PropertyKind.Indexed){
d=%GetOwnElementNames(this.value_);
e+=d.length;
if(this.hasIndexedInterceptor()&&(a&PropertyKind.Indexed)){
var h=
%GetIndexedInterceptorElementNames(this.value_);
if(h){
d=d.concat(h);
e+=h.length;
}
}
}
b=Math.min(b||e,e);
var i=new Array(b);
var j=0;
if(a&PropertyKind.Named){
for(var k=0;j<b&&k<c.length;k++){
i[j++]=c[k];
}
}
if(a&PropertyKind.Indexed){
for(var k=0;j<b&&k<d.length;k++){
i[j++]=d[k];
}
}
return i;
};
ObjectMirror.prototype.properties=function(a,b){
var c=this.propertyNames(a,b);
var d=new Array(c.length);
for(var e=0;e<c.length;e++){
d[e]=this.property(c[e]);
}
return d;
};
ObjectMirror.prototype.internalProperties=function(){
return ObjectMirror.GetInternalProperties(this.value_);
}
ObjectMirror.prototype.property=function(a){
var b=%DebugGetPropertyDetails(this.value_,builtins.$toName(a));
if(b){
return new PropertyMirror(this,a,b);
}
return GetUndefinedMirror();
};
ObjectMirror.prototype.lookupProperty=function(a){
var b=this.properties();
for(var c=0;c<b.length;c++){
var d=b[c];
if(d.propertyType()!=PropertyType.AccessorConstant){
if(%_ObjectEquals(d.value_,a.value_)){
return d;
}
}
}
return GetUndefinedMirror();
};
ObjectMirror.prototype.referencedBy=function(a){
var b=%DebugReferencedBy(this.value_,
Mirror.prototype,a||0);
for(var c=0;c<b.length;c++){
b[c]=MakeMirror(b[c]);
}
return b;
};
ObjectMirror.prototype.toText=function(){
var a;
var b=this.constructorFunction();
if(!b.isFunction()){
a=this.className();
}else{
a=b.name();
if(!a){
a=this.className();
}
}
return'#<'+a+'>';
};
ObjectMirror.GetInternalProperties=function(a){
var b=%DebugGetInternalProperties(a);
var c=[];
for(var d=0;d<b.length;d+=2){
c.push(new InternalPropertyMirror(b[d],b[d+1]));
}
return c;
}
function FunctionMirror(a){
%_CallFunction(this,a,FUNCTION_TYPE,ObjectMirror);
this.resolved_=true;
}
inherits(FunctionMirror,ObjectMirror);
FunctionMirror.prototype.resolved=function(){
return this.resolved_;
};
FunctionMirror.prototype.name=function(){
return %FunctionGetName(this.value_);
};
FunctionMirror.prototype.inferredName=function(){
return %FunctionGetInferredName(this.value_);
};
FunctionMirror.prototype.source=function(){
if(this.resolved()){
return builtins.$functionSourceString(this.value_);
}
};
FunctionMirror.prototype.script=function(){
if(this.resolved()){
if(this.script_){
return this.script_;
}
var a=%FunctionGetScript(this.value_);
if(a){
return this.script_=MakeMirror(a);
}
}
};
FunctionMirror.prototype.sourcePosition_=function(){
if(this.resolved()){
return %FunctionGetScriptSourcePosition(this.value_);
}
};
FunctionMirror.prototype.sourceLocation=function(){
if(this.resolved()){
var a=this.script();
if(a){
return a.locationFromPosition(this.sourcePosition_(),true);
}
}
};
FunctionMirror.prototype.constructedBy=function(a){
if(this.resolved()){
var b=%DebugConstructedBy(this.value_,a||0);
for(var c=0;c<b.length;c++){
b[c]=MakeMirror(b[c]);
}
return b;
}else{
return[];
}
};
FunctionMirror.prototype.scopeCount=function(){
if(this.resolved()){
if((this.scopeCount_===(void 0))){
this.scopeCount_=%GetFunctionScopeCount(this.value());
}
return this.scopeCount_;
}else{
return 0;
}
};
FunctionMirror.prototype.scope=function(a){
if(this.resolved()){
return new ScopeMirror((void 0),this,a);
}
};
FunctionMirror.prototype.toText=function(){
return this.source();
};
function UnresolvedFunctionMirror(a){
%_CallFunction(this,FUNCTION_TYPE,a,ValueMirror);
this.propertyCount_=0;
this.elementCount_=0;
this.resolved_=false;
}
inherits(UnresolvedFunctionMirror,FunctionMirror);
UnresolvedFunctionMirror.prototype.className=function(){
return'Function';
};
UnresolvedFunctionMirror.prototype.constructorFunction=function(){
return GetUndefinedMirror();
};
UnresolvedFunctionMirror.prototype.prototypeObject=function(){
return GetUndefinedMirror();
};
UnresolvedFunctionMirror.prototype.protoObject=function(){
return GetUndefinedMirror();
};
UnresolvedFunctionMirror.prototype.name=function(){
return this.value_;
};
UnresolvedFunctionMirror.prototype.inferredName=function(){
return undefined;
};
UnresolvedFunctionMirror.prototype.propertyNames=function(a,b){
return[];
};
function ArrayMirror(a){
%_CallFunction(this,a,ObjectMirror);
}
inherits(ArrayMirror,ObjectMirror);
ArrayMirror.prototype.length=function(){
return this.value_.length;
};
ArrayMirror.prototype.indexedPropertiesFromRange=function(opt_from_index,
opt_to_index){
var a=opt_from_index||0;
var b=opt_to_index||this.length()-1;
if(a>b)return new Array();
var c=new Array(b-a+1);
for(var d=a;d<=b;d++){
var e=%DebugGetPropertyDetails(this.value_,builtins.$toString(d));
var g;
if(e){
g=new PropertyMirror(this,d,e);
}else{
g=GetUndefinedMirror();
}
c[d-a]=g;
}
return c;
};
function DateMirror(a){
%_CallFunction(this,a,ObjectMirror);
}
inherits(DateMirror,ObjectMirror);
DateMirror.prototype.toText=function(){
var a=JSON.stringify(this.value_);
return a.substring(1,a.length-1);
};
function RegExpMirror(a){
%_CallFunction(this,a,REGEXP_TYPE,ObjectMirror);
}
inherits(RegExpMirror,ObjectMirror);
RegExpMirror.prototype.source=function(){
return this.value_.source;
};
RegExpMirror.prototype.global=function(){
return this.value_.global;
};
RegExpMirror.prototype.ignoreCase=function(){
return this.value_.ignoreCase;
};
RegExpMirror.prototype.multiline=function(){
return this.value_.multiline;
};
RegExpMirror.prototype.sticky=function(){
return this.value_.sticky;
};
RegExpMirror.prototype.unicode=function(){
return this.value_.unicode;
};
RegExpMirror.prototype.toText=function(){
return"/"+this.source()+"/";
};
function ErrorMirror(a){
%_CallFunction(this,a,ERROR_TYPE,ObjectMirror);
}
inherits(ErrorMirror,ObjectMirror);
ErrorMirror.prototype.message=function(){
return this.value_.message;
};
ErrorMirror.prototype.toText=function(){
var a;
try{
a=%_CallFunction(this.value_,builtins.$errorToString);
}catch(e){
a='#<Error>';
}
return a;
};
function PromiseMirror(a){
%_CallFunction(this,a,PROMISE_TYPE,ObjectMirror);
}
inherits(PromiseMirror,ObjectMirror);
function PromiseGetStatus_(a){
var b=%DebugGetProperty(a,builtins.$promiseStatus);
if(b==0)return"pending";
if(b==1)return"resolved";
return"rejected";
}
function PromiseGetValue_(a){
return %DebugGetProperty(a,builtins.$promiseValue);
}
PromiseMirror.prototype.status=function(){
return PromiseGetStatus_(this.value_);
};
PromiseMirror.prototype.promiseValue=function(){
return MakeMirror(PromiseGetValue_(this.value_));
};
function MapMirror(a){
%_CallFunction(this,a,MAP_TYPE,ObjectMirror);
}
inherits(MapMirror,ObjectMirror);
MapMirror.prototype.entries=function(a){
var b=[];
if((%_ClassOf(this.value_)==='WeakMap')){
var c=%GetWeakMapEntries(this.value_,a||0);
for(var d=0;d<c.length;d+=2){
b.push({
key:c[d],
value:c[d+1]
});
}
return b;
}
var e=%_CallFunction(this.value_,builtins.$mapEntries);
var g;
while((!a||b.length<a)&&
!(g=e.next()).done){
b.push({
key:g.value[0],
value:g.value[1]
});
}
return b;
};
function SetMirror(a){
%_CallFunction(this,a,SET_TYPE,ObjectMirror);
}
inherits(SetMirror,ObjectMirror);
function IteratorGetValues_(a,b,c){
var d=[];
var e;
while((!c||d.length<c)&&
!(e=%_CallFunction(a,b)).done){
d.push(e.value);
}
return d;
}
SetMirror.prototype.values=function(a){
if((%_ClassOf(this.value_)==='WeakSet')){
return %GetWeakSetValues(this.value_,a||0);
}
var b=%_CallFunction(this.value_,builtins.$setValues);
return IteratorGetValues_(b,builtins.$setIteratorNext,a);
};
function IteratorMirror(a){
%_CallFunction(this,a,ITERATOR_TYPE,ObjectMirror);
}
inherits(IteratorMirror,ObjectMirror);
IteratorMirror.prototype.preview=function(a){
if((%_ClassOf(this.value_)==='Map Iterator')){
return IteratorGetValues_(%MapIteratorClone(this.value_),
builtins.$mapIteratorNext,
a);
}else if((%_ClassOf(this.value_)==='Set Iterator')){
return IteratorGetValues_(%SetIteratorClone(this.value_),
builtins.$setIteratorNext,
a);
}
};
function GeneratorMirror(a){
%_CallFunction(this,a,GENERATOR_TYPE,ObjectMirror);
}
inherits(GeneratorMirror,ObjectMirror);
function GeneratorGetStatus_(a){
var b=%GeneratorGetContinuation(a);
if(b<0)return"running";
if(b==0)return"closed";
return"suspended";
}
GeneratorMirror.prototype.status=function(){
return GeneratorGetStatus_(this.value_);
};
GeneratorMirror.prototype.sourcePosition_=function(){
return %GeneratorGetSourcePosition(this.value_);
};
GeneratorMirror.prototype.sourceLocation=function(){
var a=this.sourcePosition_();
if(!(a===(void 0))){
var b=this.func().script();
if(b){
return b.locationFromPosition(a,true);
}
}
};
GeneratorMirror.prototype.func=function(){
if(!this.func_){
this.func_=MakeMirror(%GeneratorGetFunction(this.value_));
}
return this.func_;
};
GeneratorMirror.prototype.context=function(){
if(!this.context_){
this.context_=new ContextMirror(%GeneratorGetContext(this.value_));
}
return this.context_;
};
GeneratorMirror.prototype.receiver=function(){
if(!this.receiver_){
this.receiver_=MakeMirror(%GeneratorGetReceiver(this.value_));
}
return this.receiver_;
};
function PropertyMirror(a,b,c){
%_CallFunction(this,PROPERTY_TYPE,Mirror);
this.mirror_=a;
this.name_=b;
this.value_=c[0];
this.details_=c[1];
this.is_interceptor_=c[2];
if(c.length>3){
this.exception_=c[3];
this.getter_=c[4];
this.setter_=c[5];
}
}
inherits(PropertyMirror,Mirror);
PropertyMirror.prototype.isReadOnly=function(){
return(this.attributes()&PropertyAttribute.ReadOnly)!=0;
};
PropertyMirror.prototype.isEnum=function(){
return(this.attributes()&PropertyAttribute.DontEnum)==0;
};
PropertyMirror.prototype.canDelete=function(){
return(this.attributes()&PropertyAttribute.DontDelete)==0;
};
PropertyMirror.prototype.name=function(){
return this.name_;
};
PropertyMirror.prototype.isIndexed=function(){
for(var a=0;a<this.name_.length;a++){
if(this.name_[a]<'0'||'9'<this.name_[a]){
return false;
}
}
return true;
};
PropertyMirror.prototype.value=function(){
return MakeMirror(this.value_,false);
};
PropertyMirror.prototype.isException=function(){
return this.exception_?true:false;
};
PropertyMirror.prototype.attributes=function(){
return %DebugPropertyAttributesFromDetails(this.details_);
};
PropertyMirror.prototype.propertyType=function(){
return %DebugPropertyTypeFromDetails(this.details_);
};
PropertyMirror.prototype.insertionIndex=function(){
return %DebugPropertyIndexFromDetails(this.details_);
};
PropertyMirror.prototype.hasGetter=function(){
return this.getter_?true:false;
};
PropertyMirror.prototype.hasSetter=function(){
return this.setter_?true:false;
};
PropertyMirror.prototype.getter=function(){
if(this.hasGetter()){
return MakeMirror(this.getter_);
}else{
return GetUndefinedMirror();
}
};
PropertyMirror.prototype.setter=function(){
if(this.hasSetter()){
return MakeMirror(this.setter_);
}else{
return GetUndefinedMirror();
}
};
PropertyMirror.prototype.isNative=function(){
return this.is_interceptor_||
((this.propertyType()==PropertyType.AccessorConstant)&&
!this.hasGetter()&&!this.hasSetter());
};
function InternalPropertyMirror(a,b){
%_CallFunction(this,INTERNAL_PROPERTY_TYPE,Mirror);
this.name_=a;
this.value_=b;
}
inherits(InternalPropertyMirror,Mirror);
InternalPropertyMirror.prototype.name=function(){
return this.name_;
};
InternalPropertyMirror.prototype.value=function(){
return MakeMirror(this.value_,false);
};
var kFrameDetailsFrameIdIndex=0;
var kFrameDetailsReceiverIndex=1;
var kFrameDetailsFunctionIndex=2;
var kFrameDetailsArgumentCountIndex=3;
var kFrameDetailsLocalCountIndex=4;
var kFrameDetailsSourcePositionIndex=5;
var kFrameDetailsConstructCallIndex=6;
var kFrameDetailsAtReturnIndex=7;
var kFrameDetailsFlagsIndex=8;
var kFrameDetailsFirstDynamicIndex=9;
var kFrameDetailsNameIndex=0;
var kFrameDetailsValueIndex=1;
var kFrameDetailsNameValueSize=2;
var kFrameDetailsFlagDebuggerFrameMask=1<<0;
var kFrameDetailsFlagOptimizedFrameMask=1<<1;
var kFrameDetailsFlagInlinedFrameIndexMask=7<<2;
function FrameDetails(a,b){
this.break_id_=a;
this.details_=%GetFrameDetails(a,b);
}
FrameDetails.prototype.frameId=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsFrameIdIndex];
};
FrameDetails.prototype.receiver=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsReceiverIndex];
};
FrameDetails.prototype.func=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsFunctionIndex];
};
FrameDetails.prototype.isConstructCall=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsConstructCallIndex];
};
FrameDetails.prototype.isAtReturn=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsAtReturnIndex];
};
FrameDetails.prototype.isDebuggerFrame=function(){
%CheckExecutionState(this.break_id_);
var a=kFrameDetailsFlagDebuggerFrameMask;
return(this.details_[kFrameDetailsFlagsIndex]&a)==a;
};
FrameDetails.prototype.isOptimizedFrame=function(){
%CheckExecutionState(this.break_id_);
var a=kFrameDetailsFlagOptimizedFrameMask;
return(this.details_[kFrameDetailsFlagsIndex]&a)==a;
};
FrameDetails.prototype.isInlinedFrame=function(){
return this.inlinedFrameIndex()>0;
};
FrameDetails.prototype.inlinedFrameIndex=function(){
%CheckExecutionState(this.break_id_);
var a=kFrameDetailsFlagInlinedFrameIndexMask;
return(this.details_[kFrameDetailsFlagsIndex]&a)>>2;
};
FrameDetails.prototype.argumentCount=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsArgumentCountIndex];
};
FrameDetails.prototype.argumentName=function(a){
%CheckExecutionState(this.break_id_);
if(a>=0&&a<this.argumentCount()){
return this.details_[kFrameDetailsFirstDynamicIndex+
a*kFrameDetailsNameValueSize+
kFrameDetailsNameIndex];
}
};
FrameDetails.prototype.argumentValue=function(a){
%CheckExecutionState(this.break_id_);
if(a>=0&&a<this.argumentCount()){
return this.details_[kFrameDetailsFirstDynamicIndex+
a*kFrameDetailsNameValueSize+
kFrameDetailsValueIndex];
}
};
FrameDetails.prototype.localCount=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsLocalCountIndex];
};
FrameDetails.prototype.sourcePosition=function(){
%CheckExecutionState(this.break_id_);
return this.details_[kFrameDetailsSourcePositionIndex];
};
FrameDetails.prototype.localName=function(a){
%CheckExecutionState(this.break_id_);
if(a>=0&&a<this.localCount()){
var b=kFrameDetailsFirstDynamicIndex+
this.argumentCount()*kFrameDetailsNameValueSize;
return this.details_[b+
a*kFrameDetailsNameValueSize+
kFrameDetailsNameIndex];
}
};
FrameDetails.prototype.localValue=function(a){
%CheckExecutionState(this.break_id_);
if(a>=0&&a<this.localCount()){
var b=kFrameDetailsFirstDynamicIndex+
this.argumentCount()*kFrameDetailsNameValueSize;
return this.details_[b+
a*kFrameDetailsNameValueSize+
kFrameDetailsValueIndex];
}
};
FrameDetails.prototype.returnValue=function(){
%CheckExecutionState(this.break_id_);
var a=
kFrameDetailsFirstDynamicIndex+
(this.argumentCount()+this.localCount())*kFrameDetailsNameValueSize;
if(this.details_[kFrameDetailsAtReturnIndex]){
return this.details_[a];
}
};
FrameDetails.prototype.scopeCount=function(){
if((this.scopeCount_===(void 0))){
this.scopeCount_=%GetScopeCount(this.break_id_,this.frameId());
}
return this.scopeCount_;
};
FrameDetails.prototype.stepInPositionsImpl=function(){
return %GetStepInPositions(this.break_id_,this.frameId());
};
function FrameMirror(a,b){
%_CallFunction(this,FRAME_TYPE,Mirror);
this.break_id_=a;
this.index_=b;
this.details_=new FrameDetails(a,b);
}
inherits(FrameMirror,Mirror);
FrameMirror.prototype.details=function(){
return this.details_;
};
FrameMirror.prototype.index=function(){
return this.index_;
};
FrameMirror.prototype.func=function(){
if(this.func_){
return this.func_;
}
var a=this.details_.func();
if((%_IsFunction(a))){
return this.func_=MakeMirror(a);
}else{
return new UnresolvedFunctionMirror(a);
}
};
FrameMirror.prototype.receiver=function(){
return MakeMirror(this.details_.receiver());
};
FrameMirror.prototype.isConstructCall=function(){
return this.details_.isConstructCall();
};
FrameMirror.prototype.isAtReturn=function(){
return this.details_.isAtReturn();
};
FrameMirror.prototype.isDebuggerFrame=function(){
return this.details_.isDebuggerFrame();
};
FrameMirror.prototype.isOptimizedFrame=function(){
return this.details_.isOptimizedFrame();
};
FrameMirror.prototype.isInlinedFrame=function(){
return this.details_.isInlinedFrame();
};
FrameMirror.prototype.inlinedFrameIndex=function(){
return this.details_.inlinedFrameIndex();
};
FrameMirror.prototype.argumentCount=function(){
return this.details_.argumentCount();
};
FrameMirror.prototype.argumentName=function(a){
return this.details_.argumentName(a);
};
FrameMirror.prototype.argumentValue=function(a){
return MakeMirror(this.details_.argumentValue(a));
};
FrameMirror.prototype.localCount=function(){
return this.details_.localCount();
};
FrameMirror.prototype.localName=function(a){
return this.details_.localName(a);
};
FrameMirror.prototype.localValue=function(a){
return MakeMirror(this.details_.localValue(a));
};
FrameMirror.prototype.returnValue=function(){
return MakeMirror(this.details_.returnValue());
};
FrameMirror.prototype.sourcePosition=function(){
return this.details_.sourcePosition();
};
FrameMirror.prototype.sourceLocation=function(){
var a=this.func();
if(a.resolved()){
var b=a.script();
if(b){
return b.locationFromPosition(this.sourcePosition(),true);
}
}
};
FrameMirror.prototype.sourceLine=function(){
var a=this.sourceLocation();
if(a){
return a.line;
}
};
FrameMirror.prototype.sourceColumn=function(){
var a=this.sourceLocation();
if(a){
return a.column;
}
};
FrameMirror.prototype.sourceLineText=function(){
var a=this.sourceLocation();
if(a){
return a.sourceText();
}
};
FrameMirror.prototype.scopeCount=function(){
return this.details_.scopeCount();
};
FrameMirror.prototype.scope=function(a){
return new ScopeMirror(this,(void 0),a);
};
FrameMirror.prototype.allScopes=function(a){
var b=%GetAllScopesDetails(this.break_id_,
this.details_.frameId(),
this.details_.inlinedFrameIndex(),
!!a);
var c=[];
for(var d=0;d<b.length;++d){
c.push(new ScopeMirror(this,(void 0),d,b[d]));
}
return c;
};
FrameMirror.prototype.stepInPositions=function(){
var a=this.func().script();
var b=this.func().sourcePosition_();
var c=this.details_.stepInPositionsImpl();
var d=[];
if(c){
for(var e=0;e<c.length;e++){
var g={};
var h=a.locationFromPosition(b+c[e],
true);
serializeLocationFields(h,g);
var i={
position:g
};
d.push(i);
}
}
return d;
};
FrameMirror.prototype.evaluate=function(source,disable_break,
opt_context_object){
return MakeMirror(%DebugEvaluate(this.break_id_,
this.details_.frameId(),
this.details_.inlinedFrameIndex(),
source,
Boolean(disable_break),
opt_context_object));
};
FrameMirror.prototype.invocationText=function(){
var a='';
var b=this.func();
var c=this.receiver();
if(this.isConstructCall()){
a+='new ';
a+=b.name()?b.name():'[anonymous]';
}else if(this.isDebuggerFrame()){
a+='[debugger]';
}else{
var d=
!c.className||(c.className()!='global');
if(d){
a+=c.toText();
}
var e=GetUndefinedMirror();
if(c.isObject()){
for(var g=c;
!g.isNull()&&e.isUndefined();
g=g.protoObject()){
e=g.lookupProperty(b);
}
}
if(!e.isUndefined()){
if(!e.isIndexed()){
if(d){
a+='.';
}
a+=e.name();
}else{
a+='[';
a+=e.name();
a+=']';
}
if(b.name()&&b.name()!=e.name()){
a+='(aka '+b.name()+')';
}
}else{
if(d){
a+='.';
}
a+=b.name()?b.name():'[anonymous]';
}
}
if(!this.isDebuggerFrame()){
a+='(';
for(var h=0;h<this.argumentCount();h++){
if(h!=0)a+=', ';
if(this.argumentName(h)){
a+=this.argumentName(h);
a+='=';
}
a+=this.argumentValue(h).toText();
}
a+=')';
}
if(this.isAtReturn()){
a+=' returning ';
a+=this.returnValue().toText();
}
return a;
};
FrameMirror.prototype.sourceAndPositionText=function(){
var a='';
var b=this.func();
if(b.resolved()){
var c=b.script();
if(c){
if(c.name()){
a+=c.name();
}else{
a+='[unnamed]';
}
if(!this.isDebuggerFrame()){
var d=this.sourceLocation();
a+=' line ';
a+=!(d===(void 0))?(d.line+1):'?';
a+=' column ';
a+=!(d===(void 0))?(d.column+1):'?';
if(!(this.sourcePosition()===(void 0))){
a+=' (position '+(this.sourcePosition()+1)+')';
}
}
}else{
a+='[no source]';
}
}else{
a+='[unresolved]';
}
return a;
};
FrameMirror.prototype.localsText=function(){
var a='';
var b=this.localCount();
if(b>0){
for(var c=0;c<b;++c){
a+='      var ';
a+=this.localName(c);
a+=' = ';
a+=this.localValue(c).toText();
if(c<b-1)a+='\n';
}
}
return a;
};
FrameMirror.prototype.restart=function(){
var a=%LiveEditRestartFrame(this.break_id_,this.index_);
if((a===(void 0))){
a="Failed to find requested frame";
}
return a;
};
FrameMirror.prototype.toText=function(a){
var b='';
b+='#'+(this.index()<=9?'0':'')+this.index();
b+=' ';
b+=this.invocationText();
b+=' ';
b+=this.sourceAndPositionText();
if(a){
b+='\n';
b+=this.localsText();
}
return b;
};
var kScopeDetailsTypeIndex=0;
var kScopeDetailsObjectIndex=1;
function ScopeDetails(a,b,c,d){
if(a){
this.break_id_=a.break_id_;
this.details_=d||
%GetScopeDetails(a.break_id_,
a.details_.frameId(),
a.details_.inlinedFrameIndex(),
c);
this.frame_id_=a.details_.frameId();
this.inlined_frame_id_=a.details_.inlinedFrameIndex();
}else{
this.details_=d||%GetFunctionScopeDetails(b.value(),c);
this.fun_value_=b.value();
this.break_id_=undefined;
}
this.index_=c;
}
ScopeDetails.prototype.type=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[kScopeDetailsTypeIndex];
};
ScopeDetails.prototype.object=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[kScopeDetailsObjectIndex];
};
ScopeDetails.prototype.setVariableValueImpl=function(a,b){
var c;
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
c=%SetScopeVariableValue(this.break_id_,this.frame_id_,
this.inlined_frame_id_,this.index_,a,b);
}else{
c=%SetScopeVariableValue(this.fun_value_,null,null,this.index_,
a,b);
}
if(!c){
throw new Error("Failed to set variable value");
}
};
function ScopeMirror(a,b,c,d){
%_CallFunction(this,SCOPE_TYPE,Mirror);
if(a){
this.frame_index_=a.index_;
}else{
this.frame_index_=undefined;
}
this.scope_index_=c;
this.details_=new ScopeDetails(a,b,c,d);
}
inherits(ScopeMirror,Mirror);
ScopeMirror.prototype.details=function(){
return this.details_;
};
ScopeMirror.prototype.frameIndex=function(){
return this.frame_index_;
};
ScopeMirror.prototype.scopeIndex=function(){
return this.scope_index_;
};
ScopeMirror.prototype.scopeType=function(){
return this.details_.type();
};
ScopeMirror.prototype.scopeObject=function(){
var a=this.scopeType()==ScopeType.Local||
this.scopeType()==ScopeType.Closure||
this.scopeType()==ScopeType.Script;
return MakeMirror(this.details_.object(),a);
};
ScopeMirror.prototype.setVariableValue=function(a,b){
this.details_.setVariableValueImpl(a,b);
};
function ScriptMirror(a){
%_CallFunction(this,SCRIPT_TYPE,Mirror);
this.script_=a;
this.context_=new ContextMirror(a.context_data);
this.allocateHandle_();
}
inherits(ScriptMirror,Mirror);
ScriptMirror.prototype.value=function(){
return this.script_;
};
ScriptMirror.prototype.name=function(){
return this.script_.name||this.script_.nameOrSourceURL();
};
ScriptMirror.prototype.id=function(){
return this.script_.id;
};
ScriptMirror.prototype.source=function(){
return this.script_.source;
};
ScriptMirror.prototype.setSource=function(a){
%DebugSetScriptSource(this.script_,a);
};
ScriptMirror.prototype.lineOffset=function(){
return this.script_.line_offset;
};
ScriptMirror.prototype.columnOffset=function(){
return this.script_.column_offset;
};
ScriptMirror.prototype.data=function(){
return this.script_.data;
};
ScriptMirror.prototype.scriptType=function(){
return this.script_.type;
};
ScriptMirror.prototype.compilationType=function(){
return this.script_.compilation_type;
};
ScriptMirror.prototype.lineCount=function(){
return this.script_.lineCount();
};
ScriptMirror.prototype.locationFromPosition=function(
position,include_resource_offset){
return this.script_.locationFromPosition(position,include_resource_offset);
};
ScriptMirror.prototype.sourceSlice=function(a,b){
return this.script_.sourceSlice(a,b);
};
ScriptMirror.prototype.context=function(){
return this.context_;
};
ScriptMirror.prototype.evalFromScript=function(){
return MakeMirror(this.script_.eval_from_script);
};
ScriptMirror.prototype.evalFromFunctionName=function(){
return MakeMirror(this.script_.eval_from_function_name);
};
ScriptMirror.prototype.evalFromLocation=function(){
var a=this.evalFromScript();
if(!a.isUndefined()){
var b=this.script_.eval_from_script_position;
return a.locationFromPosition(b,true);
}
};
ScriptMirror.prototype.toText=function(){
var a='';
a+=this.name();
a+=' (lines: ';
if(this.lineOffset()>0){
a+=this.lineOffset();
a+='-';
a+=this.lineOffset()+this.lineCount()-1;
}else{
a+=this.lineCount();
}
a+=')';
return a;
};
function ContextMirror(a){
%_CallFunction(this,CONTEXT_TYPE,Mirror);
this.data_=a;
this.allocateHandle_();
}
inherits(ContextMirror,Mirror);
ContextMirror.prototype.data=function(){
return this.data_;
};
function MakeMirrorSerializer(a,b){
return new JSONProtocolSerializer(a,b);
}
function JSONProtocolSerializer(a,b){
this.details_=a;
this.options_=b;
this.mirrors_=[];
}
JSONProtocolSerializer.prototype.serializeReference=function(a){
return this.serialize_(a,true,true);
};
JSONProtocolSerializer.prototype.serializeValue=function(a){
var b=this.serialize_(a,false,true);
return b;
};
JSONProtocolSerializer.prototype.serializeReferencedObjects=function(){
var a=[];
var b=this.mirrors_.length;
for(var c=0;c<b;c++){
a.push(this.serialize_(this.mirrors_[c],false,false));
}
return a;
};
JSONProtocolSerializer.prototype.includeSource_=function(){
return this.options_&&this.options_.includeSource;
};
JSONProtocolSerializer.prototype.inlineRefs_=function(){
return this.options_&&this.options_.inlineRefs;
};
JSONProtocolSerializer.prototype.maxStringLength_=function(){
if((this.options_===(void 0))||
(this.options_.maxStringLength===(void 0))){
return kMaxProtocolStringLength;
}
return this.options_.maxStringLength;
};
JSONProtocolSerializer.prototype.add_=function(a){
for(var b=0;b<this.mirrors_.length;b++){
if(this.mirrors_[b]===a){
return;
}
}
this.mirrors_.push(a);
};
JSONProtocolSerializer.prototype.serializeReferenceWithDisplayData_=
function(a){
var b={};
b.ref=a.handle();
b.type=a.type();
switch(a.type()){
case UNDEFINED_TYPE:
case NULL_TYPE:
case BOOLEAN_TYPE:
case NUMBER_TYPE:
b.value=a.value();
break;
case STRING_TYPE:
b.value=a.getTruncatedValue(this.maxStringLength_());
break;
case SYMBOL_TYPE:
b.description=a.description();
break;
case FUNCTION_TYPE:
b.name=a.name();
b.inferredName=a.inferredName();
if(a.script()){
b.scriptId=a.script().id();
}
break;
case ERROR_TYPE:
case REGEXP_TYPE:
b.value=a.toText();
break;
case OBJECT_TYPE:
b.className=a.className();
break;
}
return b;
};
JSONProtocolSerializer.prototype.serialize_=function(mirror,reference,
details){
if(reference&&
(mirror.isValue()||mirror.isScript()||mirror.isContext())){
if(this.inlineRefs_()&&mirror.isValue()){
return this.serializeReferenceWithDisplayData_(mirror);
}else{
this.add_(mirror);
return{'ref':mirror.handle()};
}
}
var a={};
if(mirror.isValue()||mirror.isScript()||mirror.isContext()){
a.handle=mirror.handle();
}
a.type=mirror.type();
switch(mirror.type()){
case UNDEFINED_TYPE:
case NULL_TYPE:
break;
case BOOLEAN_TYPE:
a.value=mirror.value();
break;
case NUMBER_TYPE:
a.value=NumberToJSON_(mirror.value());
break;
case STRING_TYPE:
if(this.maxStringLength_()!=-1&&
mirror.length()>this.maxStringLength_()){
var b=mirror.getTruncatedValue(this.maxStringLength_());
a.value=b;
a.fromIndex=0;
a.toIndex=this.maxStringLength_();
}else{
a.value=mirror.value();
}
a.length=mirror.length();
break;
case SYMBOL_TYPE:
a.description=mirror.description();
break;
case OBJECT_TYPE:
case FUNCTION_TYPE:
case ERROR_TYPE:
case REGEXP_TYPE:
case PROMISE_TYPE:
case GENERATOR_TYPE:
this.serializeObject_(mirror,a,details);
break;
case PROPERTY_TYPE:
case INTERNAL_PROPERTY_TYPE:
throw new Error('PropertyMirror cannot be serialized independently');
break;
case FRAME_TYPE:
this.serializeFrame_(mirror,a);
break;
case SCOPE_TYPE:
this.serializeScope_(mirror,a);
break;
case SCRIPT_TYPE:
if(mirror.name()){
a.name=mirror.name();
}
a.id=mirror.id();
a.lineOffset=mirror.lineOffset();
a.columnOffset=mirror.columnOffset();
a.lineCount=mirror.lineCount();
if(mirror.data()){
a.data=mirror.data();
}
if(this.includeSource_()){
a.source=mirror.source();
}else{
var c=mirror.source().substring(0,80);
a.sourceStart=c;
}
a.sourceLength=mirror.source().length;
a.scriptType=mirror.scriptType();
a.compilationType=mirror.compilationType();
if(mirror.compilationType()==1&&
mirror.evalFromScript()){
a.evalFromScript=
this.serializeReference(mirror.evalFromScript());
var d=mirror.evalFromLocation();
if(d){
a.evalFromLocation={line:d.line,
column:d.column};
}
if(mirror.evalFromFunctionName()){
a.evalFromFunctionName=mirror.evalFromFunctionName();
}
}
if(mirror.context()){
a.context=this.serializeReference(mirror.context());
}
break;
case CONTEXT_TYPE:
a.data=mirror.data();
break;
}
a.text=mirror.toText();
return a;
};
JSONProtocolSerializer.prototype.serializeObject_=function(mirror,content,
details){
content.className=mirror.className();
content.constructorFunction=
this.serializeReference(mirror.constructorFunction());
content.protoObject=this.serializeReference(mirror.protoObject());
content.prototypeObject=this.serializeReference(mirror.prototypeObject());
if(mirror.hasNamedInterceptor()){
content.namedInterceptor=true;
}
if(mirror.hasIndexedInterceptor()){
content.indexedInterceptor=true;
}
if(mirror.isFunction()){
content.name=mirror.name();
if(!(mirror.inferredName()===(void 0))){
content.inferredName=mirror.inferredName();
}
content.resolved=mirror.resolved();
if(mirror.resolved()){
content.source=mirror.source();
}
if(mirror.script()){
content.script=this.serializeReference(mirror.script());
content.scriptId=mirror.script().id();
serializeLocationFields(mirror.sourceLocation(),content);
}
content.scopes=[];
for(var a=0;a<mirror.scopeCount();a++){
var b=mirror.scope(a);
content.scopes.push({
type:b.scopeType(),
index:a
});
}
}
if(mirror.isGenerator()){
content.status=mirror.status();
content.func=this.serializeReference(mirror.func())
content.receiver=this.serializeReference(mirror.receiver())
serializeLocationFields(mirror.sourceLocation(),content);
}
if(mirror.isDate()){
content.value=mirror.value();
}
if(mirror.isPromise()){
content.status=mirror.status();
content.promiseValue=this.serializeReference(mirror.promiseValue());
}
var c=mirror.propertyNames(PropertyKind.Named);
var d=mirror.propertyNames(PropertyKind.Indexed);
var e=new Array(c.length+d.length);
for(var a=0;a<c.length;a++){
var g=mirror.property(c[a]);
e[a]=this.serializeProperty_(g);
if(details){
this.add_(g.value());
}
}
for(var a=0;a<d.length;a++){
var g=mirror.property(d[a]);
e[c.length+a]=this.serializeProperty_(g);
if(details){
this.add_(g.value());
}
}
content.properties=e;
var h=mirror.internalProperties();
if(h.length>0){
var i=[];
for(var a=0;a<h.length;a++){
i.push(this.serializeInternalProperty_(h[a]));
}
content.internalProperties=i;
}
};
function serializeLocationFields(a,b){
if(!a){
return;
}
b.position=a.position;
var c=a.line;
if(!(c===(void 0))){
b.line=c;
}
var d=a.column;
if(!(d===(void 0))){
b.column=d;
}
}
JSONProtocolSerializer.prototype.serializeProperty_=function(a){
var b={};
b.name=a.name();
var c=a.value();
if(this.inlineRefs_()&&c.isValue()){
b.value=this.serializeReferenceWithDisplayData_(c);
}else{
if(a.attributes()!=PropertyAttribute.None){
b.attributes=a.attributes();
}
b.propertyType=a.propertyType();
b.ref=c.handle();
}
return b;
};
JSONProtocolSerializer.prototype.serializeInternalProperty_=
function(a){
var b={};
b.name=a.name();
var c=a.value();
if(this.inlineRefs_()&&c.isValue()){
b.value=this.serializeReferenceWithDisplayData_(c);
}else{
b.ref=c.handle();
}
return b;
};
JSONProtocolSerializer.prototype.serializeFrame_=function(a,b){
b.index=a.index();
b.receiver=this.serializeReference(a.receiver());
var c=a.func();
b.func=this.serializeReference(c);
var d=c.script();
if(d){
b.script=this.serializeReference(d);
}
b.constructCall=a.isConstructCall();
b.atReturn=a.isAtReturn();
if(a.isAtReturn()){
b.returnValue=this.serializeReference(a.returnValue());
}
b.debuggerFrame=a.isDebuggerFrame();
var e=new Array(a.argumentCount());
for(var g=0;g<a.argumentCount();g++){
var h={};
var i=a.argumentName(g);
if(i){
h.name=i;
}
h.value=this.serializeReference(a.argumentValue(g));
e[g]=h;
}
b.arguments=e;
var e=new Array(a.localCount());
for(var g=0;g<a.localCount();g++){
var j={};
j.name=a.localName(g);
j.value=this.serializeReference(a.localValue(g));
e[g]=j;
}
b.locals=e;
serializeLocationFields(a.sourceLocation(),b);
var k=a.sourceLineText();
if(!(k===(void 0))){
b.sourceLineText=k;
}
b.scopes=[];
for(var g=0;g<a.scopeCount();g++){
var l=a.scope(g);
b.scopes.push({
type:l.scopeType(),
index:g
});
}
};
JSONProtocolSerializer.prototype.serializeScope_=function(a,b){
b.index=a.scopeIndex();
b.frameIndex=a.frameIndex();
b.type=a.scopeType();
b.object=this.inlineRefs_()?
this.serializeValue(a.scopeObject()):
this.serializeReference(a.scopeObject());
};
function NumberToJSON_(a){
if(isNaN(a)){
return'NaN';
}
if(!(%_IsSmi(%IS_VAR(a))||((a==a)&&(a!=1/0)&&(a!=-1/0)))){
if(a>0){
return'Infinity';
}else{
return'-Infinity';
}
}
return a;
}

 liveeditÁø
"use strict";
Debug.LiveEdit=new function(){
var a;
var b="stack_update_needs_step_in";
function ApplyPatchMultiChunk(script,diff_array,new_source,preview_only,
change_log){
var c=script.source;
var d=GatherCompileInfo(c,script);
var e=BuildCodeInfoTree(d);
var g=new PosTranslator(diff_array);
MarkChangedFunctions(e,g.GetChunks());
FindLiveSharedInfos(e,script);
var h;
try{
h=GatherCompileInfo(new_source,script);
}catch(e){
var i=
new Failure("Failed to compile new version of script: "+e);
if(e instanceof SyntaxError){
var j={
type:"liveedit_compile_error",
syntaxErrorMessage:e.message
};
CopyErrorPositionToDetails(e,j);
i.details=j;
}
throw i;
}
var k=BuildCodeInfoTree(h);
FindCorrespondingFunctions(e,k);
var l=new Array();
var m=new Array();
var n=new Array();
var o=new Array();
function HarvestTodo(p){
function CollectDamaged(q){
m.push(q);
for(var r=0;r<q.children.length;r++){
CollectDamaged(q.children[r]);
}
}
function CollectNew(t){
for(var r=0;r<t.length;r++){
n.push(t[r]);
CollectNew(t[r].children);
}
}
if(p.status==a.DAMAGED){
CollectDamaged(p);
return;
}
if(p.status==a.UNCHANGED){
o.push(p);
}else if(p.status==a.SOURCE_CHANGED){
o.push(p);
}else if(p.status==a.CHANGED){
l.push(p);
CollectNew(p.unmatched_new_nodes);
}
for(var r=0;r<p.children.length;r++){
HarvestTodo(p.children[r]);
}
}
var u={
change_tree:DescribeChangeTree(e),
textual_diff:{
old_len:c.length,
new_len:new_source.length,
chunks:diff_array
},
updated:false
};
if(preview_only){
return u;
}
HarvestTodo(e);
var v=new Array();
for(var r=0;r<l.length;r++){
var w=
l[r].live_shared_function_infos;
if(w){
for(var x=0;x<w.length;x++){
v.push(w[x]);
}
}
}
var y=
CheckStackActivations(v,change_log);
u.stack_modified=y!=0;
u[b]=
u.stack_modified;
var z=TemporaryRemoveBreakPoints(script,change_log);
var A;
if(m.length==0){
%LiveEditReplaceScript(script,new_source,null);
A=(void 0);
}else{
var B=CreateNameForOldScript(script);
A=%LiveEditReplaceScript(script,new_source,
B);
var C=new Array();
change_log.push({linked_to_old_script:C});
for(var r=0;r<m.length;r++){
LinkToOldScript(m[r],A,
C);
}
u.created_script_name=B;
}
for(var r=0;r<n.length;r++){
%LiveEditFunctionSetScript(
n[r].info.shared_function_info,script);
}
for(var r=0;r<l.length;r++){
PatchFunctionCode(l[r],change_log);
}
var D=new Array();
change_log.push({position_patched:D});
for(var r=0;r<o.length;r++){
PatchPositions(o[r],diff_array,
D);
if(o[r].live_shared_function_infos){
o[r].live_shared_function_infos.
forEach(function(E){
%LiveEditFunctionSourceUpdated(E.raw_array);
});
}
}
z(g,A);
u.updated=true;
return u;
}
this.ApplyPatchMultiChunk=ApplyPatchMultiChunk;
function GatherCompileInfo(F,G){
var H=%LiveEditGatherCompileInfo(G,F);
var I=new Array();
var J=new Array();
for(var r=0;r<H.length;r++){
var E=new FunctionCompileInfo(H[r]);
%LiveEditFunctionSetScript(E.shared_function_info,(void 0));
I.push(E);
J.push(r);
}
for(var r=0;r<I.length;r++){
var K=r;
for(var x=r+1;x<I.length;x++){
if(I[K].start_position>I[x].start_position){
K=x;
}
}
if(K!=r){
var L=I[K];
var M=J[K];
I[K]=I[r];
J[K]=J[r];
I[r]=L;
J[r]=M;
}
}
var N=0;
function ResetIndexes(O,P){
var Q=-1;
while(N<I.length&&
I[N].outer_index==P){
var R=N;
I[R].outer_index=O;
if(Q!=-1){
I[Q].next_sibling_index=R;
}
Q=R;
N++;
ResetIndexes(R,J[R]);
}
if(Q!=-1){
I[Q].next_sibling_index=-1;
}
}
ResetIndexes(-1,-1);
Assert(N==I.length);
return I;
}
function PatchFunctionCode(p,S){
var T=p.corresponding_node.info;
if(p.live_shared_function_infos){
p.live_shared_function_infos.forEach(function(U){
%LiveEditReplaceFunctionCode(T.raw_array,
U.raw_array);
for(var r=0;r<p.children.length;r++){
if(p.children[r].corresponding_node){
var V=
p.children[r].corresponding_node.info.
shared_function_info;
if(p.children[r].live_shared_function_infos){
p.children[r].live_shared_function_infos.
forEach(function(W){
%LiveEditReplaceRefToNestedFunction(
U.info,
V,
W.info);
});
}
}
}
});
S.push({function_patched:T.function_name});
}else{
S.push({function_patched:T.function_name,
function_info_not_found:true});
}
}
function LinkToOldScript(X,A,Y){
if(X.live_shared_function_infos){
X.live_shared_function_infos.
forEach(function(E){
%LiveEditFunctionSetScript(E.info,A);
});
Y.push({name:X.info.function_name});
}else{
Y.push(
{name:X.info.function_name,not_found:true});
}
}
function TemporaryRemoveBreakPoints(Z,S){
var aa=GetScriptBreakPoints(Z);
var ab=[];
S.push({break_points_update:ab});
var ac=[];
for(var r=0;r<aa.length;r++){
var ad=aa[r];
ad.clear();
var ae=Debug.findScriptSourcePosition(Z,
ad.line(),ad.column());
var af={
position:ae,
line:ad.line(),
column:ad.column()
};
ac.push(af);
}
return function(g,ag){
for(var r=0;r<aa.length;r++){
var ad=aa[r];
if(ag){
var ah=ad.cloneForOtherScript(ag);
ah.set(ag);
ab.push({
type:"copied_to_old",
id:ad.number(),
new_id:ah.number(),
positions:ac[r]
});
}
var ai=g.Translate(
ac[r].position,
PosTranslator.ShiftWithTopInsideChunkHandler);
var aj=
Z.locationFromPosition(ai,false);
ad.update_positions(aj.line,aj.column);
var ak={
position:ai,
line:aj.line,
column:aj.column
};
ad.set(Z);
ab.push({type:"position_changed",
id:ad.number(),
old_positions:ac[r],
new_positions:ak
});
}
};
}
function Assert(al,am){
if(!al){
if(am){
throw"Assert "+am;
}else{
throw"Assert";
}
}
}
function DiffChunk(an,ao,ap,aq){
this.pos1=an;
this.pos2=ao;
this.len1=ap;
this.len2=aq;
}
function PosTranslator(ar){
var as=new Array();
var at=0;
for(var r=0;r<ar.length;r+=3){
var au=ar[r];
var av=au+at;
var aw=ar[r+1];
var ax=ar[r+2];
as.push(new DiffChunk(au,av,aw-au,
ax-av));
at=ax-aw;
}
this.chunks=as;
}
PosTranslator.prototype.GetChunks=function(){
return this.chunks;
};
PosTranslator.prototype.Translate=function(ay,az){
var aA=this.chunks;
if(aA.length==0||ay<aA[0].pos1){
return ay;
}
var aB=0;
var aC=aA.length-1;
while(aB<aC){
var aD=Math.floor((aB+aC)/2);
if(ay<aA[aD+1].pos1){
aC=aD;
}else{
aB=aD+1;
}
}
var aE=aA[aB];
if(ay>=aE.pos1+aE.len1){
return ay+aE.pos2+aE.len2-aE.pos1-aE.len1;
}
if(!az){
az=PosTranslator.DefaultInsideChunkHandler;
}
return az(ay,aE);
};
PosTranslator.DefaultInsideChunkHandler=function(ay,aF){
Assert(false,"Cannot translate position in changed area");
};
PosTranslator.ShiftWithTopInsideChunkHandler=
function(ay,aF){
return ay-aF.pos1+aF.pos2;
};
var a={
UNCHANGED:"unchanged",
SOURCE_CHANGED:"source changed",
CHANGED:"changed",
DAMAGED:"damaged"
};
function CodeInfoTreeNode(aG,aH,aI){
this.info=aG;
this.children=aH;
this.array_index=aI;
this.parent=(void 0);
this.status=a.UNCHANGED;
this.status_explanation=(void 0);
this.new_start_pos=(void 0);
this.new_end_pos=(void 0);
this.corresponding_node=(void 0);
this.unmatched_new_nodes=(void 0);
this.textual_corresponding_node=(void 0);
this.textually_unmatched_new_nodes=(void 0);
this.live_shared_function_infos=(void 0);
}
function BuildCodeInfoTree(aJ){
var aK=0;
function BuildNode(){
var aL=aK;
aK++;
var aM=new Array();
while(aK<aJ.length&&
aJ[aK].outer_index==aL){
aM.push(BuildNode());
}
var q=new CodeInfoTreeNode(aJ[aL],aM,
aL);
for(var r=0;r<aM.length;r++){
aM[r].parent=q;
}
return q;
}
var aN=BuildNode();
Assert(aK==aJ.length);
return aN;
}
function MarkChangedFunctions(aO,as){
var aP=new function(){
var aQ=0;
var aR=0;
this.current=function(){return as[aQ];};
this.next=function(){
var aE=as[aQ];
aR=aE.pos2+aE.len2-(aE.pos1+aE.len1);
aQ++;
};
this.done=function(){return aQ>=as.length;};
this.TranslatePos=function(ay){return ay+aR;};
};
function ProcessInternals(aS){
aS.new_start_pos=aP.TranslatePos(
aS.info.start_position);
var aT=0;
var aU=false;
var aV=false;
while(!aP.done()&&
aP.current().pos1<aS.info.end_position){
if(aT<aS.children.length){
var aW=aS.children[aT];
if(aW.info.end_position<=aP.current().pos1){
ProcessUnchangedChild(aW);
aT++;
continue;
}else if(aW.info.start_position>=
aP.current().pos1+aP.current().len1){
aU=true;
aP.next();
continue;
}else if(aW.info.start_position<=aP.current().pos1&&
aW.info.end_position>=aP.current().pos1+
aP.current().len1){
ProcessInternals(aW);
aV=aV||
(aW.status!=a.UNCHANGED);
aU=aU||
(aW.status==a.DAMAGED);
aT++;
continue;
}else{
aU=true;
aW.status=a.DAMAGED;
aW.status_explanation=
"Text diff overlaps with function boundary";
aT++;
continue;
}
}else{
if(aP.current().pos1+aP.current().len1<=
aS.info.end_position){
aS.status=a.CHANGED;
aP.next();
continue;
}else{
aS.status=a.DAMAGED;
aS.status_explanation=
"Text diff overlaps with function boundary";
return;
}
}
Assert("Unreachable",false);
}
while(aT<aS.children.length){
var aW=aS.children[aT];
ProcessUnchangedChild(aW);
aT++;
}
if(aU){
aS.status=a.CHANGED;
}else if(aV){
aS.status=a.SOURCE_CHANGED;
}
aS.new_end_pos=
aP.TranslatePos(aS.info.end_position);
}
function ProcessUnchangedChild(q){
q.new_start_pos=aP.TranslatePos(q.info.start_position);
q.new_end_pos=aP.TranslatePos(q.info.end_position);
}
ProcessInternals(aO);
}
function FindCorrespondingFunctions(aX,aY){
function ProcessNode(p,aZ){
var ba=
IsFunctionContextLocalsChanged(p.info,aZ.info);
if(ba){
p.status=a.CHANGED;
}
var bb=p.children;
var bc=aZ.children;
var bd=[];
var be=[];
var bf=0;
var bg=0;
while(bf<bb.length){
if(bb[bf].status==a.DAMAGED){
bf++;
}else if(bg<bc.length){
if(bc[bg].info.start_position<
bb[bf].new_start_pos){
bd.push(bc[bg]);
be.push(bc[bg]);
bg++;
}else if(bc[bg].info.start_position==
bb[bf].new_start_pos){
if(bc[bg].info.end_position==
bb[bf].new_end_pos){
bb[bf].corresponding_node=
bc[bg];
bb[bf].textual_corresponding_node=
bc[bg];
if(ba){
bb[bf].status=a.DAMAGED;
bb[bf].status_explanation=
"Enclosing function is now incompatible. "+
ba;
bb[bf].corresponding_node=(void 0);
}else if(bb[bf].status!=
a.UNCHANGED){
ProcessNode(bb[bf],
bc[bg]);
if(bb[bf].status==a.DAMAGED){
bd.push(
bb[bf].corresponding_node);
bb[bf].corresponding_node=(void 0);
p.status=a.CHANGED;
}
}
}else{
bb[bf].status=a.DAMAGED;
bb[bf].status_explanation=
"No corresponding function in new script found";
p.status=a.CHANGED;
bd.push(bc[bg]);
be.push(bc[bg]);
}
bg++;
bf++;
}else{
bb[bf].status=a.DAMAGED;
bb[bf].status_explanation=
"No corresponding function in new script found";
p.status=a.CHANGED;
bf++;
}
}else{
bb[bf].status=a.DAMAGED;
bb[bf].status_explanation=
"No corresponding function in new script found";
p.status=a.CHANGED;
bf++;
}
}
while(bg<bc.length){
bd.push(bc[bg]);
be.push(bc[bg]);
bg++;
}
if(p.status==a.CHANGED){
if(p.info.param_num!=aZ.info.param_num){
p.status=a.DAMAGED;
p.status_explanation="Changed parameter number: "+
p.info.param_num+" and "+aZ.info.param_num;
}
}
p.unmatched_new_nodes=bd;
p.textually_unmatched_new_nodes=
be;
}
ProcessNode(aX,aY);
aX.corresponding_node=aY;
aX.textual_corresponding_node=aY;
Assert(aX.status!=a.DAMAGED,
"Script became damaged");
}
function FindLiveSharedInfos(aX,G){
var bh=%LiveEditFindSharedFunctionInfosForScript(G);
var bi=new Array();
for(var r=0;r<bh.length;r++){
bi.push(new SharedInfoWrapper(bh[r]));
}
function FindFunctionInfos(I){
var bj=[];
for(var r=0;r<bi.length;r++){
var bk=bi[r];
if(bk.start_position==I.start_position&&
bk.end_position==I.end_position){
bj.push(bk);
}
}
if(bj.length>0){
return bj;
}
}
function TraverseTree(q){
q.live_shared_function_infos=FindFunctionInfos(q.info);
for(var r=0;r<q.children.length;r++){
TraverseTree(q.children[r]);
}
}
TraverseTree(aX);
}
function FunctionCompileInfo(bl){
this.function_name=bl[0];
this.start_position=bl[1];
this.end_position=bl[2];
this.param_num=bl[3];
this.code=bl[4];
this.code_scope_info=bl[5];
this.scope_info=bl[6];
this.outer_index=bl[7];
this.shared_function_info=bl[8];
this.next_sibling_index=null;
this.raw_array=bl;
}
function SharedInfoWrapper(bl){
this.function_name=bl[0];
this.start_position=bl[1];
this.end_position=bl[2];
this.info=bl[3];
this.raw_array=bl;
}
function PatchPositions(X,ar,Y){
if(X.live_shared_function_infos){
X.live_shared_function_infos.forEach(function(E){
%LiveEditPatchFunctionPositions(E.raw_array,
ar);
});
Y.push({name:X.info.function_name});
}else{
Y.push(
{name:X.info.function_name,info_not_found:true});
}
}
function CreateNameForOldScript(G){
return G.name+" (old)";
}
function IsFunctionContextLocalsChanged(bm,bn){
var bo=bm.scope_info;
var bp=bn.scope_info;
var bq;
var br;
if(bo){
bq=bo.toString();
}else{
bq="";
}
if(bp){
br=bp.toString();
}else{
br="";
}
if(bq!=br){
return"Variable map changed: ["+bq+
"] => ["+br+"]";
}
return;
}
var bs;
function CheckStackActivations(bt,S){
var bu=new Array();
for(var r=0;r<bt.length;r++){
bu[r]=bt[r].info;
}
var bv=%LiveEditCheckAndDropActivations(bu,true);
if(bv[bu.length]){
throw new Failure(bv[bu.length]);
}
var bw=new Array();
var bx=new Array();
for(var r=0;r<bu.length;r++){
var by=bt[r];
if(bv[r]==bs.REPLACED_ON_ACTIVE_STACK){
bx.push({name:by.function_name});
}else if(bv[r]!=bs.AVAILABLE_FOR_PATCH){
var bz={
name:by.function_name,
start_pos:by.start_position,
end_pos:by.end_position,
replace_problem:
bs.SymbolName(bv[r])
};
bw.push(bz);
}
}
if(bx.length>0){
S.push({dropped_from_stack:bx});
}
if(bw.length>0){
S.push({functions_on_stack:bw});
throw new Failure("Blocked by functions on stack");
}
return bx.length;
}
var bs={
AVAILABLE_FOR_PATCH:1,
BLOCKED_ON_ACTIVE_STACK:2,
BLOCKED_ON_OTHER_STACK:3,
BLOCKED_UNDER_NATIVE_CODE:4,
REPLACED_ON_ACTIVE_STACK:5,
BLOCKED_UNDER_GENERATOR:6,
BLOCKED_ACTIVE_GENERATOR:7
};
bs.SymbolName=function(bA){
var bB=bs;
for(var bC in bB){
if(bB[bC]==bA){
return bC;
}
}
};
function Failure(am){
this.message=am;
}
this.Failure=Failure;
Failure.prototype.toString=function(){
return"LiveEdit Failure: "+this.message;
};
function CopyErrorPositionToDetails(bD,j){
function createPositionStruct(G,bE){
if(bE==-1)return;
var bF=G.locationFromPosition(bE,true);
if(bF==null)return;
return{
line:bF.line+1,
column:bF.column+1,
position:bE
};
}
if(!("scriptObject"in bD)||!("startPosition"in bD)){
return;
}
var G=bD.scriptObject;
var bG={
start:createPositionStruct(G,bD.startPosition),
end:createPositionStruct(G,bD.endPosition)
};
j.position=bG;
}
function GetPcFromSourcePos(bH,bI){
return %GetFunctionCodePositionFromSource(bH,bI);
}
this.GetPcFromSourcePos=GetPcFromSourcePos;
function SetScriptSource(G,bJ,bK,S){
var c=G.source;
var bL=CompareStrings(c,bJ);
return ApplyPatchMultiChunk(G,bL,bJ,bK,
S);
}
this.SetScriptSource=SetScriptSource;
function CompareStrings(bM,bN){
return %LiveEditCompareStrings(bM,bN);
}
function ApplySingleChunkPatch(G,change_pos,change_len,new_str,
S){
var c=G.source;
var bJ=c.substring(0,change_pos)+
new_str+c.substring(change_pos+change_len);
return ApplyPatchMultiChunk(G,
[change_pos,change_pos+change_len,change_pos+new_str.length],
bJ,false,S);
}
function DescribeChangeTree(aX){
function ProcessOldNode(q){
var bO=[];
for(var r=0;r<q.children.length;r++){
var aW=q.children[r];
if(aW.status!=a.UNCHANGED){
bO.push(ProcessOldNode(aW));
}
}
var bP=[];
if(q.textually_unmatched_new_nodes){
for(var r=0;r<q.textually_unmatched_new_nodes.length;r++){
var aW=q.textually_unmatched_new_nodes[r];
bP.push(ProcessNewNode(aW));
}
}
var bQ={
name:q.info.function_name,
positions:DescribePositions(q),
status:q.status,
children:bO,
new_children:bP
};
if(q.status_explanation){
bQ.status_explanation=q.status_explanation;
}
if(q.textual_corresponding_node){
bQ.new_positions=DescribePositions(q.textual_corresponding_node);
}
return bQ;
}
function ProcessNewNode(q){
var bO=[];
if(false){
for(var r=0;r<q.children.length;r++){
bO.push(ProcessNewNode(q.children[r]));
}
}
var bQ={
name:q.info.function_name,
positions:DescribePositions(q),
children:bO,
};
return bQ;
}
function DescribePositions(q){
return{
start_position:q.info.start_position,
end_position:q.info.end_position
};
}
return ProcessOldNode(aX);
}
function RestartFrame(bR){
var bv=bR.restart();
if((typeof(bv)==='string')){
throw new Failure("Failed to restart frame: "+bv);
}
var bv={};
bv[b]=true;
return bv;
}
this.RestartFrame=RestartFrame;
this.TestApi={
PosTranslator:PosTranslator,
CompareStrings:CompareStrings,
ApplySingleChunkPatch:ApplySingleChunkPatch
};
};

hruntimeâ
var EQUALS;
var STRICT_EQUALS;
var COMPARE;
var COMPARE_STRONG;
var ADD;
var ADD_STRONG;
var STRING_ADD_LEFT;
var STRING_ADD_LEFT_STRONG;
var STRING_ADD_RIGHT;
var STRING_ADD_RIGHT_STRONG;
var SUB;
var SUB_STRONG;
var MUL;
var MUL_STRONG;
var DIV;
var DIV_STRONG;
var MOD;
var MOD_STRONG;
var BIT_OR;
var BIT_OR_STRONG;
var BIT_AND;
var BIT_AND_STRONG;
var BIT_XOR;
var BIT_XOR_STRONG;
var SHL;
var SHL_STRONG;
var SAR;
var SAR_STRONG;
var SHR;
var SHR_STRONG;
var DELETE;
var IN;
var INSTANCE_OF;
var CALL_NON_FUNCTION;
var CALL_NON_FUNCTION_AS_CONSTRUCTOR;
var CALL_FUNCTION_PROXY;
var CALL_FUNCTION_PROXY_AS_CONSTRUCTOR;
var CONCAT_ITERABLE_TO_ARRAY;
var APPLY_PREPARE;
var REFLECT_APPLY_PREPARE;
var REFLECT_CONSTRUCT_PREPARE;
var STACK_OVERFLOW;
var TO_OBJECT;
var TO_NUMBER;
var TO_STRING;
var TO_NAME;
var StringLengthTFStub;
var StringAddTFStub;
var MathFloorStub;
var $defaultNumber;
var $defaultString;
var $NaN;
var $nonNumberToNumber;
var $nonStringToString;
var $sameValue;
var $sameValueZero;
var $toBoolean;
var $toInt32;
var $toInteger;
var $toLength;
var $toName;
var $toNumber;
var $toObject;
var $toPositiveInteger;
var $toPrimitive;
var $toString;
var $toUint32;
(function(a,b){
%CheckIsBootstrapping();
var c=a.Array;
var d=a.Boolean;
var e=a.String;
var g=a.Number;
EQUALS=function EQUALS(h){
if((typeof(this)==='string')&&(typeof(h)==='string'))return %StringEquals(this,h);
var i=this;
while(true){
if((typeof(i)==='number')){
while(true){
if((typeof(h)==='number'))return %NumberEquals(i,h);
if((h==null))return 1;
if((typeof(h)==='symbol'))return 1;
if(!(%_IsSpecObject(h))){
return %NumberEquals(i,%$toNumber(h));
}
h=%$toPrimitive(h,0);
}
}else if((typeof(i)==='string')){
while(true){
if((typeof(h)==='string'))return %StringEquals(i,h);
if((typeof(h)==='symbol'))return 1;
if((typeof(h)==='number'))return %NumberEquals(%$toNumber(i),h);
if((typeof(h)==='boolean'))return %NumberEquals(%$toNumber(i),%$toNumber(h));
if((h==null))return 1;
h=%$toPrimitive(h,0);
}
}else if((typeof(i)==='symbol')){
if((typeof(h)==='symbol'))return %_ObjectEquals(i,h)?0:1;
return 1;
}else if((typeof(i)==='boolean')){
if((typeof(h)==='boolean'))return %_ObjectEquals(i,h)?0:1;
if((h==null))return 1;
if((typeof(h)==='number'))return %NumberEquals(%$toNumber(i),h);
if((typeof(h)==='string'))return %NumberEquals(%$toNumber(i),%$toNumber(h));
if((typeof(h)==='symbol'))return 1;
i=%$toNumber(i);
h=%$toPrimitive(h,0);
}else if((i==null)){
return(h==null)?0:1;
}else{
if((%_IsSpecObject(h))){
return %_ObjectEquals(i,h)?0:1;
}
if((h==null))return 1;
if((typeof(h)==='symbol'))return 1;
if((typeof(h)==='boolean'))h=%$toNumber(h);
i=%$toPrimitive(i,0);
}
}
}
STRICT_EQUALS=function STRICT_EQUALS(i){
if((typeof(this)==='string')){
if(!(typeof(i)==='string'))return 1;
return %StringEquals(this,i);
}
if((typeof(this)==='number')){
if(!(typeof(i)==='number'))return 1;
return %NumberEquals(this,i);
}
return %_ObjectEquals(this,i)?0:1;
}
COMPARE=function COMPARE(i,j){
var k;
var l;
if((typeof(this)==='string')){
if((typeof(i)==='string'))return %_StringCompare(this,i);
if((i===(void 0)))return j;
k=this;
}else if((typeof(this)==='number')){
if((typeof(i)==='number'))return %NumberCompare(this,i,j);
if((i===(void 0)))return j;
k=this;
}else if((this===(void 0))){
if(!(i===(void 0))){
%$toPrimitive(i,1);
}
return j;
}else if((i===(void 0))){
%$toPrimitive(this,1);
return j;
}else{
k=%$toPrimitive(this,1);
}
l=%$toPrimitive(i,1);
if((typeof(k)==='string')&&(typeof(l)==='string')){
return %_StringCompare(k,l);
}else{
var m=%$toNumber(k);
var n=%$toNumber(l);
if((!%_IsSmi(%IS_VAR(m))&&!(m==m))||(!%_IsSmi(%IS_VAR(n))&&!(n==n)))return j;
return %NumberCompare(m,n,j);
}
}
COMPARE_STRONG=function COMPARE_STRONG(i,j){
if((typeof(this)==='string')&&(typeof(i)==='string'))return %_StringCompare(this,i);
if((typeof(this)==='number')&&(typeof(i)==='number'))return %NumberCompare(this,i,j);
throw %MakeTypeError(105);
}
ADD=function ADD(i){
if((typeof(this)==='number')&&(typeof(i)==='number'))return %NumberAdd(this,i);
if((typeof(this)==='string')&&(typeof(i)==='string'))return %_StringAdd(this,i);
var o=%$toPrimitive(this,0);
var p=%$toPrimitive(i,0);
if((typeof(o)==='string')){
return %_StringAdd(o,%$toString(p));
}else if((typeof(p)==='string')){
return %_StringAdd(%$nonStringToString(o),p);
}else{
return %NumberAdd(%$toNumber(o),%$toNumber(p));
}
}
ADD_STRONG=function ADD_STRONG(i){
if((typeof(this)==='number')&&(typeof(i)==='number'))return %NumberAdd(this,i);
if((typeof(this)==='string')&&(typeof(i)==='string'))return %_StringAdd(this,i);
throw %MakeTypeError(105);
}
STRING_ADD_LEFT=function STRING_ADD_LEFT(h){
if(!(typeof(h)==='string')){
if((%_ClassOf(h)==='String')&&%_IsStringWrapperSafeForDefaultValueOf(h)){
h=%_ValueOf(h);
}else{
h=(typeof(h)==='number')
?%_NumberToString(h)
:%$toString(%$toPrimitive(h,0));
}
}
return %_StringAdd(this,h);
}
STRING_ADD_LEFT_STRONG=function STRING_ADD_LEFT_STRONG(h){
if((typeof(h)==='string')){
return %_StringAdd(this,h);
}
throw %MakeTypeError(105);
}
STRING_ADD_RIGHT=function STRING_ADD_RIGHT(h){
var i=this;
if(!(typeof(i)==='string')){
if((%_ClassOf(i)==='String')&&%_IsStringWrapperSafeForDefaultValueOf(i)){
i=%_ValueOf(i);
}else{
i=(typeof(i)==='number')
?%_NumberToString(i)
:%$toString(%$toPrimitive(i,0));
}
}
return %_StringAdd(i,h);
}
STRING_ADD_RIGHT_STRONG=function STRING_ADD_RIGHT_STRONG(h){
if((typeof(this)==='string')){
return %_StringAdd(this,h);
}
throw %MakeTypeError(105);
}
SUB=function SUB(h){
var i=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
return %NumberSub(i,h);
}
SUB_STRONG=function SUB_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberSub(this,h);
}
throw %MakeTypeError(105);
}
MUL=function MUL(h){
var i=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
return %NumberMul(i,h);
}
MUL_STRONG=function MUL_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberMul(this,h);
}
throw %MakeTypeError(105);
}
DIV=function DIV(h){
var i=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
return %NumberDiv(i,h);
}
DIV_STRONG=function DIV_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberDiv(this,h);
}
throw %MakeTypeError(105);
}
MOD=function MOD(h){
var i=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
return %NumberMod(i,h);
}
MOD_STRONG=function MOD_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberMod(this,h);
}
throw %MakeTypeError(105);
}
BIT_OR=function BIT_OR(h){
var i=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
return %NumberOr(i,h);
}
BIT_OR_STRONG=function BIT_OR_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberOr(this,h);
}
throw %MakeTypeError(105);
}
BIT_AND=function BIT_AND(h){
var i;
if((typeof(this)==='number')){
i=this;
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
}else{
i=%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
if((!%_IsSmi(%IS_VAR(i))&&!(i==i)))return 0;
}
return %NumberAnd(i,h);
}
BIT_AND_STRONG=function BIT_AND_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberAnd(this,h);
}
throw %MakeTypeError(105);
}
BIT_XOR=function BIT_XOR(h){
var i=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
return %NumberXor(i,h);
}
BIT_XOR_STRONG=function BIT_XOR_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberXor(this,h);
}
throw %MakeTypeError(105);
}
SHL=function SHL(h){
var i=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
return %NumberShl(i,h);
}
SHL_STRONG=function SHL_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberShl(this,h);
}
throw %MakeTypeError(105);
}
SAR=function SAR(h){
var i;
if((typeof(this)==='number')){
i=this;
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
}else{
i=%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
if((!%_IsSmi(%IS_VAR(i))&&!(i==i)))return 0;
}
return %NumberSar(i,h);
}
SAR_STRONG=function SAR_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberSar(this,h);
}
throw %MakeTypeError(105);
}
SHR=function SHR(h){
var i=(typeof(this)==='number')?this:%$nonNumberToNumber(this);
if(!(typeof(h)==='number'))h=%$nonNumberToNumber(h);
return %NumberShr(i,h);
}
SHR_STRONG=function SHR_STRONG(h){
if((typeof(this)==='number')&&(typeof(h)==='number')){
return %NumberShr(this,h);
}
throw %MakeTypeError(105);
}
DELETE=function DELETE(q,r){
return %DeleteProperty(%$toObject(this),%$toName(q),r);
}
IN=function IN(i){
if(!(%_IsSpecObject(i))){
throw %MakeTypeError(37,this,i);
}
if(%_IsNonNegativeSmi(this)){
if((%_IsArray(i))&&%_HasFastPackedElements(i)){
return this<i.length;
}
return %HasElement(i,this);
}
return %HasProperty(i,%$toName(this));
}
INSTANCE_OF=function INSTANCE_OF(t){
var u=this;
if(!(%_ClassOf(t)==='Function')){
throw %MakeTypeError(34,t);
}
if(!(%_IsSpecObject(u))){
return 1;
}
var v=%BoundFunctionGetBindings(t);
if(v){
t=v[0];
}
var w=t.prototype;
if(!(%_IsSpecObject(w))){
throw %MakeTypeError(35,w);
}
return %IsInPrototypeChain(w,u)?0:1;
}
CALL_NON_FUNCTION=function CALL_NON_FUNCTION(){
var x=%GetFunctionDelegate(this);
if(!(%_IsFunction(x))){
var y=%RenderCallSite();
if(y=="")y=typeof this;
throw %MakeTypeError(12,y);
}
return %Apply(x,this,arguments,0,%_ArgumentsLength());
}
CALL_NON_FUNCTION_AS_CONSTRUCTOR=function CALL_NON_FUNCTION_AS_CONSTRUCTOR(){
var x=%GetConstructorDelegate(this);
if(!(%_IsFunction(x))){
var y=%RenderCallSite();
if(y=="")y=typeof this;
throw %MakeTypeError(12,y);
}
return %Apply(x,this,arguments,0,%_ArgumentsLength());
}
CALL_FUNCTION_PROXY=function CALL_FUNCTION_PROXY(){
var z=%_ArgumentsLength()-1;
var A=%_Arguments(z);
var B=%GetCallTrap(A);
return %Apply(B,this,arguments,0,z);
}
CALL_FUNCTION_PROXY_AS_CONSTRUCTOR=
function CALL_FUNCTION_PROXY_AS_CONSTRUCTOR(){
var A=this;
var B=%GetConstructTrap(A);
return %Apply(B,this,arguments,0,%_ArgumentsLength());
}
APPLY_PREPARE=function APPLY_PREPARE(C){
var D;
if((%_IsArray(C))){
D=C.length;
if(%_IsSmi(D)&&D>=0&&D<0x800000&&
(%_ClassOf(this)==='Function')){
return D;
}
}
D=(C==null)?0:%$toUint32(C.length);
if(D>0x800000)throw %MakeRangeError(145);
if(!(%_ClassOf(this)==='Function')){
throw %MakeTypeError(8,%$toString(this),typeof this);
}
if(C!=null&&!(%_IsSpecObject(C))){
throw %MakeTypeError(116,"Function.prototype.apply");
}
return D;
}
REFLECT_APPLY_PREPARE=function REFLECT_APPLY_PREPARE(C){
var D;
if((%_IsArray(C))){
D=C.length;
if(%_IsSmi(D)&&D>=0&&D<0x800000&&
(%_ClassOf(this)==='Function')){
return D;
}
}
if(!(%_ClassOf(this)==='Function')){
throw %MakeTypeError(12,%$toString(this));
}
if(!(%_IsSpecObject(C))){
throw %MakeTypeError(116,"Reflect.apply");
}
D=%$toLength(C.length);
if(D>0x800000)throw %MakeRangeError(145);
return D;
}
REFLECT_CONSTRUCT_PREPARE=function REFLECT_CONSTRUCT_PREPARE(
C,newTarget){
var D;
var E=(%_ClassOf(this)==='Function')&&%IsConstructor(this);
var F=(%_ClassOf(newTarget)==='Function')&&%IsConstructor(newTarget);
if((%_IsArray(C))){
D=C.length;
if(%_IsSmi(D)&&D>=0&&D<0x800000&&
E&&F){
return D;
}
}
if(!E){
if(!(%_ClassOf(this)==='Function')){
throw %MakeTypeError(12,%$toString(this));
}else{
throw %MakeTypeError(52,%$toString(this));
}
}
if(!F){
if(!(%_ClassOf(newTarget)==='Function')){
throw %MakeTypeError(12,%$toString(newTarget));
}else{
throw %MakeTypeError(52,%$toString(newTarget));
}
}
if(!(%_IsSpecObject(C))){
throw %MakeTypeError(116,"Reflect.construct");
}
D=%$toLength(C.length);
if(D>0x800000)throw %MakeRangeError(145);
return D;
}
CONCAT_ITERABLE_TO_ARRAY=function CONCAT_ITERABLE_TO_ARRAY(G){
return %$concatIterableToArray(this,G);
};
STACK_OVERFLOW=function STACK_OVERFLOW(D){
throw %MakeRangeError(145);
}
TO_OBJECT=function TO_OBJECT(){
return %$toObject(this);
}
TO_NUMBER=function TO_NUMBER(){
return %$toNumber(this);
}
TO_STRING=function TO_STRING(){
return %$toString(this);
}
TO_NAME=function TO_NAME(){
return %$toName(this);
}
StringLengthTFStub=function StringLengthTFStub(H,I){
var J=function(K,L,M,N){
return %_StringGetLength(%_JSValueGetValue(K));
}
return J;
}
StringAddTFStub=function StringAddTFStub(H,I){
var J=function(k,l){
return %StringAdd(k,l);
}
return J;
}
MathFloorStub=function MathFloorStub(H,I){
var J=function(O,M,N){
var P=%_MathFloor(+N);
if(%_IsMinusZero(P)){
%_FixedArraySet(%_GetTypeFeedbackVector(O),((M|0)+1)|0,1);
return-0;
}
var Q=P|0;
if(Q===P){
return Q;
}
return P;
}
return J;
}
function ToPrimitive(i,R){
if((typeof(i)==='string'))return i;
if(!(%_IsSpecObject(i)))return i;
if((%_ClassOf(i)==='Symbol'))throw MakeTypeError(109);
if(R==0)R=((%_ClassOf(i)==='Date'))?2:1;
return(R==1)?DefaultNumber(i):DefaultString(i);
}
function ToBoolean(i){
if((typeof(i)==='boolean'))return i;
if((typeof(i)==='string'))return i.length!=0;
if(i==null)return false;
if((typeof(i)==='number'))return!((i==0)||(!%_IsSmi(%IS_VAR(i))&&!(i==i)));
return true;
}
function ToNumber(i){
if((typeof(i)==='number'))return i;
if((typeof(i)==='string')){
return %_HasCachedArrayIndex(i)?%_GetCachedArrayIndex(i)
:%StringToNumber(i);
}
if((typeof(i)==='boolean'))return i?1:0;
if((i===(void 0)))return $NaN;
if((typeof(i)==='symbol'))throw MakeTypeError(110);
return((i===null))?0:ToNumber(DefaultNumber(i));
}
function NonNumberToNumber(i){
if((typeof(i)==='string')){
return %_HasCachedArrayIndex(i)?%_GetCachedArrayIndex(i)
:%StringToNumber(i);
}
if((typeof(i)==='boolean'))return i?1:0;
if((i===(void 0)))return $NaN;
if((typeof(i)==='symbol'))throw MakeTypeError(110);
return((i===null))?0:ToNumber(DefaultNumber(i));
}
function ToString(i){
if((typeof(i)==='string'))return i;
if((typeof(i)==='number'))return %_NumberToString(i);
if((typeof(i)==='boolean'))return i?'true':'false';
if((i===(void 0)))return'undefined';
if((typeof(i)==='symbol'))throw MakeTypeError(111);
return((i===null))?'null':ToString(DefaultString(i));
}
function NonStringToString(i){
if((typeof(i)==='number'))return %_NumberToString(i);
if((typeof(i)==='boolean'))return i?'true':'false';
if((i===(void 0)))return'undefined';
if((typeof(i)==='symbol'))throw MakeTypeError(111);
return((i===null))?'null':ToString(DefaultString(i));
}
function ToName(i){
return(typeof(i)==='symbol')?i:ToString(i);
}
function ToObject(i){
if((typeof(i)==='string'))return new e(i);
if((typeof(i)==='number'))return new g(i);
if((typeof(i)==='boolean'))return new d(i);
if((typeof(i)==='symbol'))return %NewSymbolWrapper(i);
if((i==null)&&!(%_IsUndetectableObject(i))){
throw MakeTypeError(112);
}
return i;
}
function ToInteger(i){
if(%_IsSmi(i))return i;
return %NumberToInteger(ToNumber(i));
}
function ToLength(S){
S=ToInteger(S);
if(S<0)return 0;
return S<g.MAX_SAFE_INTEGER?S
:g.MAX_SAFE_INTEGER;
}
function ToUint32(i){
if(%_IsSmi(i)&&i>=0)return i;
return %NumberToJSUint32(ToNumber(i));
}
function ToInt32(i){
if(%_IsSmi(i))return i;
return %NumberToJSInt32(ToNumber(i));
}
function SameValue(i,h){
if(typeof i!=typeof h)return false;
if((typeof(i)==='number')){
if((!%_IsSmi(%IS_VAR(i))&&!(i==i))&&(!%_IsSmi(%IS_VAR(h))&&!(h==h)))return true;
if(i===0&&h===0&&%_IsMinusZero(i)!=%_IsMinusZero(h)){
return false;
}
}
return i===h;
}
function SameValueZero(i,h){
if(typeof i!=typeof h)return false;
if((typeof(i)==='number')){
if((!%_IsSmi(%IS_VAR(i))&&!(i==i))&&(!%_IsSmi(%IS_VAR(h))&&!(h==h)))return true;
}
return i===h;
}
function ConcatIterableToArray(T,G){
var U=T.length;
for(var V of G){
%AddElement(T,U++,V,0);
}
return T;
}
function IsPrimitive(i){
return!(%_IsSpecObject(i));
}
function IsConcatSpreadable(w){
if(!(%_IsSpecObject(w)))return false;
var W=w[symbolIsConcatSpreadable];
if((W===(void 0)))return(%_IsArray(w));
return ToBoolean(W);
}
function DefaultNumber(i){
if(!(%_ClassOf(i)==='Symbol')){
var X=i.valueOf;
if((%_ClassOf(X)==='Function')){
var N=%_CallFunction(i,X);
if(IsPrimitive(N))return N;
}
var Y=i.toString;
if((%_ClassOf(Y)==='Function')){
var Z=%_CallFunction(i,Y);
if(IsPrimitive(Z))return Z;
}
}
throw MakeTypeError(15);
}
function DefaultString(i){
if(!(%_ClassOf(i)==='Symbol')){
var Y=i.toString;
if((%_ClassOf(Y)==='Function')){
var Z=%_CallFunction(i,Y);
if(IsPrimitive(Z))return Z;
}
var X=i.valueOf;
if((%_ClassOf(X)==='Function')){
var N=%_CallFunction(i,X);
if(IsPrimitive(N))return N;
}
}
throw MakeTypeError(15);
}
function ToPositiveInteger(i,aa){
var M=(%_IsSmi(%IS_VAR(i))?i:%NumberToIntegerMapMinusZero($toNumber(i)));
if(M<0)throw MakeRangeError(aa);
return M;
}
%FunctionSetPrototype(c,new c(0));
$concatIterableToArray=ConcatIterableToArray;
$defaultNumber=DefaultNumber;
$defaultString=DefaultString;
$NaN=%GetRootNaN();
$nonNumberToNumber=NonNumberToNumber;
$nonStringToString=NonStringToString;
$sameValue=SameValue;
$sameValueZero=SameValueZero;
$toBoolean=ToBoolean;
$toInt32=ToInt32;
$toInteger=ToInteger;
$toLength=ToLength;
$toName=ToName;
$toNumber=ToNumber;
$toObject=ToObject;
$toPositiveInteger=ToPositiveInteger;
$toPrimitive=ToPrimitive;
$toString=ToString;
$toUint32=ToUint32;
})

 prologue]4
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=(void 0);
var d=(void 0);
var e=(void 0);
function Export(g){
g.next=d;
d=g;
};
function Import(g){
g.next=c;
c=g;
};
function ImportFromExperimental(g){
g.next=e;
e=g;
};
function SetFunctionName(g,h,i){
if((typeof(h)==='symbol')){
h="["+%SymbolDescription(h)+"]";
}
if((i===(void 0))){
%FunctionSetName(g,h);
}else{
%FunctionSetName(g,i+" "+h);
}
}
function InstallConstants(j,k){
%CheckIsBootstrapping();
%OptimizeObjectForAddingMultipleProperties(j,k.length>>1);
var l=2|4|1;
for(var m=0;m<k.length;m+=2){
var h=k[m];
var n=k[m+1];
%AddNamedProperty(j,h,n,l);
}
%ToFastProperties(j);
}
function InstallFunctions(j,l,o){
%CheckIsBootstrapping();
%OptimizeObjectForAddingMultipleProperties(j,o.length>>1);
for(var m=0;m<o.length;m+=2){
var p=o[m];
var g=o[m+1];
SetFunctionName(g,p);
%FunctionRemovePrototype(g);
%AddNamedProperty(j,p,g,l);
%SetNativeFlag(g);
}
%ToFastProperties(j);
}
function InstallGetter(j,h,q,l){
%CheckIsBootstrapping();
if(typeof l=="undefined"){
l=2;
}
SetFunctionName(q,h,"get");
%FunctionRemovePrototype(q);
%DefineAccessorPropertyUnchecked(j,h,q,null,l);
%SetNativeFlag(q);
}
function InstallGetterSetter(j,h,q,r){
%CheckIsBootstrapping();
SetFunctionName(q,h,"get");
SetFunctionName(r,h,"set");
%FunctionRemovePrototype(q);
%FunctionRemovePrototype(r);
%DefineAccessorPropertyUnchecked(j,h,q,r,2);
%SetNativeFlag(q);
%SetNativeFlag(r);
}
function SetUpLockedPrototype(
constructor,fields,methods){
%CheckIsBootstrapping();
var t=constructor.prototype;
var u=(methods.length>>1)+(fields?fields.length:0);
if(u>=4){
%OptimizeObjectForAddingMultipleProperties(t,u);
}
if(fields){
for(var m=0;m<fields.length;m++){
%AddNamedProperty(t,fields[m],
(void 0),2|4);
}
}
for(var m=0;m<methods.length;m+=2){
var p=methods[m];
var g=methods[m+1];
%AddNamedProperty(t,p,g,2|4|1);
%SetNativeFlag(g);
}
%InternalSetPrototype(t,null);
%ToFastProperties(t);
}
var v=(void 0);
function PostNatives(b){
%CheckIsBootstrapping();
var w={};
for(;!(d===(void 0));d=d.next)d(w);
for(;!(c===(void 0));c=c.next)c(w);
var x=[
"ArrayToString",
"GetIterator",
"GetMethod",
"InnerArrayEvery",
"InnerArrayFilter",
"InnerArrayForEach",
"InnerArrayIndexOf",
"InnerArrayJoin",
"InnerArrayLastIndexOf",
"InnerArrayMap",
"InnerArrayReduce",
"InnerArrayReduceRight",
"InnerArrayReverse",
"InnerArraySome",
"InnerArraySort",
"InnerArrayToLocaleString",
"IsNaN",
"MathMax",
"MathMin",
"ObjectIsFrozen",
"OwnPropertyKeys",
"ToNameArray",
];
v={};
%OptimizeObjectForAddingMultipleProperties(
v,x.length);
for(var p of x){
v[p]=w[p];
}
%ToFastProperties(v);
w=(void 0);
b.PostNatives=(void 0);
b.ImportFromExperimental=(void 0);
};
function PostExperimentals(b){
%CheckIsBootstrapping();
for(;!(d===(void 0));d=d.next){
d(v);
}
for(;!(c===(void 0));c=c.next){
c(v);
}
for(;!(e===(void 0));
e=e.next){
e(v);
}
v=(void 0);
b.PostExperimentals=(void 0);
b.Import=(void 0);
b.Export=(void 0);
};
InstallFunctions(b,0,[
"Import",Import,
"Export",Export,
"ImportFromExperimental",ImportFromExperimental,
"SetFunctionName",SetFunctionName,
"InstallConstants",InstallConstants,
"InstallFunctions",InstallFunctions,
"InstallGetter",InstallGetter,
"InstallGetterSetter",InstallGetterSetter,
"SetUpLockedPrototype",SetUpLockedPrototype,
"PostNatives",PostNatives,
"PostExperimentals",PostExperimentals,
]);
})

$v8natives:â
var $functionSourceString;
var $globalEval;
var $objectDefineOwnProperty;
var $objectGetOwnPropertyDescriptor;
var $toCompletePropertyDescriptor;
(function(a,b){
%CheckIsBootstrapping();
var c=a.Array;
var d=a.Boolean;
var e=a.Function;
var g=a.Number;
var h=a.Object;
var i=b.InternalArray;
var j;
var k;
var l;
var m;
var n;
b.Import(function(o){
j=o.MathAbs;
n=o.StringIndexOf;
});
b.ImportFromExperimental(function(o){
k=o.ProxyDelegateCallAndConstruct;
l=o.ProxyDerivedHasOwnTrap;
m=o.ProxyDerivedKeysTrap;
});
function GlobalIsNaN(p){
p=((typeof(%IS_VAR(p))==='number')?p:$nonNumberToNumber(p));
return(!%_IsSmi(%IS_VAR(p))&&!(p==p));
}
function GlobalIsFinite(p){
p=((typeof(%IS_VAR(p))==='number')?p:$nonNumberToNumber(p));
return(%_IsSmi(%IS_VAR(p))||((p==p)&&(p!=1/0)&&(p!=-1/0)));
}
function GlobalParseInt(q,r){
if((r===(void 0))||r===10||r===0){
if(%_IsSmi(q))return q;
if((typeof(q)==='number')&&
((0.01<q&&q<1e9)||
(-1e9<q&&q<-0.01))){
return q|0;
}
q=((typeof(%IS_VAR(q))==='string')?q:$nonStringToString(q));
r=r|0;
}else{
q=((typeof(%IS_VAR(q))==='string')?q:$nonStringToString(q));
r=(%_IsSmi(%IS_VAR(r))?r:(r>>0));
if(!(r==0||(2<=r&&r<=36))){
return $NaN;
}
}
if(%_HasCachedArrayIndex(q)&&
(r==0||r==10)){
return %_GetCachedArrayIndex(q);
}
return %StringParseInt(q,r);
}
function GlobalParseFloat(q){
q=((typeof(%IS_VAR(q))==='string')?q:$nonStringToString(q));
if(%_HasCachedArrayIndex(q))return %_GetCachedArrayIndex(q);
return %StringParseFloat(q);
}
function GlobalEval(t){
if(!(typeof(t)==='string'))return t;
var u=%GlobalProxy(GlobalEval);
var v=%CompileString(t,false);
if(!(%_IsFunction(v)))return v;
return %_CallFunction(u,v);
}
var w=2|4|1;
b.InstallConstants(a,[
"NaN",$NaN,
"Infinity",(1/0),
"undefined",(void 0),
]);
b.InstallFunctions(a,2,[
"isNaN",GlobalIsNaN,
"isFinite",GlobalIsFinite,
"parseInt",GlobalParseInt,
"parseFloat",GlobalParseFloat,
"eval",GlobalEval
]);
function ObjectToString(){
if((this===(void 0))&&!(%_IsUndetectableObject(this)))return"[object Undefined]";
if((this===null))return"[object Null]";
var x=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var y=%_ClassOf(x);
var z;
if(harmony_tostring){
z=x[symbolToStringTag];
if(!(typeof(z)==='string')){
z=y;
}
}else{
z=y;
}
return`[object ${z}]`;
}
function ObjectToLocaleString(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Object.prototype.toLocaleString");
return this.toString();
}
function ObjectValueOf(){
return((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
}
function ObjectHasOwnProperty(A){
if(%_IsJSProxy(this)){
if((typeof(A)==='symbol'))return false;
var B=%GetHandler(this);
return CallTrap1(B,"hasOwn",l,$toName(A));
}
return %HasOwnProperty(((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this)),$toName(A));
}
function ObjectIsPrototypeOf(A){
if(!(%_IsSpecObject(A)))return false;
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Object.prototype.isPrototypeOf");
return %IsInPrototypeChain(this,A);
}
function ObjectPropertyIsEnumerable(A){
var C=$toName(A);
if(%_IsJSProxy(this)){
if((typeof(A)==='symbol'))return false;
var D=GetOwnPropertyJS(this,C);
return(D===(void 0))?false:D.isEnumerable();
}
return %IsPropertyEnumerable(((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this)),C);
}
function ObjectDefineGetter(E,F){
var G=this;
if(G==null&&!(%_IsUndetectableObject(G))){
G=%GlobalProxy(ObjectDefineGetter);
}
if(!(%_ClassOf(F)==='Function')){
throw MakeTypeError(60);
}
var D=new PropertyDescriptor();
D.setGet(F);
D.setEnumerable(true);
D.setConfigurable(true);
DefineOwnProperty(((%_IsSpecObject(%IS_VAR(G)))?G:$toObject(G)),$toName(E),D,false);
}
function ObjectLookupGetter(E){
var G=this;
if(G==null&&!(%_IsUndetectableObject(G))){
G=%GlobalProxy(ObjectLookupGetter);
}
return %LookupAccessor(((%_IsSpecObject(%IS_VAR(G)))?G:$toObject(G)),$toName(E),0);
}
function ObjectDefineSetter(E,F){
var G=this;
if(G==null&&!(%_IsUndetectableObject(G))){
G=%GlobalProxy(ObjectDefineSetter);
}
if(!(%_ClassOf(F)==='Function')){
throw MakeTypeError(63);
}
var D=new PropertyDescriptor();
D.setSet(F);
D.setEnumerable(true);
D.setConfigurable(true);
DefineOwnProperty(((%_IsSpecObject(%IS_VAR(G)))?G:$toObject(G)),$toName(E),D,false);
}
function ObjectLookupSetter(E){
var G=this;
if(G==null&&!(%_IsUndetectableObject(G))){
G=%GlobalProxy(ObjectLookupSetter);
}
return %LookupAccessor(((%_IsSpecObject(%IS_VAR(G)))?G:$toObject(G)),$toName(E),1);
}
function ObjectKeys(H){
H=((%_IsSpecObject(%IS_VAR(H)))?H:$toObject(H));
if(%_IsJSProxy(H)){
var B=%GetHandler(H);
var I=CallTrap0(B,"keys",m);
return ToNameArray(I,"keys",false);
}
return %OwnKeys(H);
}
function IsAccessorDescriptor(D){
if((D===(void 0)))return false;
return D.hasGetter()||D.hasSetter();
}
function IsDataDescriptor(D){
if((D===(void 0)))return false;
return D.hasValue()||D.hasWritable();
}
function IsGenericDescriptor(D){
if((D===(void 0)))return false;
return!(IsAccessorDescriptor(D)||IsDataDescriptor(D));
}
function IsInconsistentDescriptor(D){
return IsAccessorDescriptor(D)&&IsDataDescriptor(D);
}
function FromPropertyDescriptor(D){
if((D===(void 0)))return D;
if(IsDataDescriptor(D)){
return{value:D.getValue(),
writable:D.isWritable(),
enumerable:D.isEnumerable(),
configurable:D.isConfigurable()};
}
return{get:D.getGet(),
set:D.getSet(),
enumerable:D.isEnumerable(),
configurable:D.isConfigurable()};
}
function FromGenericPropertyDescriptor(D){
if((D===(void 0)))return D;
var H=new h();
if(D.hasValue()){
%AddNamedProperty(H,"value",D.getValue(),0);
}
if(D.hasWritable()){
%AddNamedProperty(H,"writable",D.isWritable(),0);
}
if(D.hasGetter()){
%AddNamedProperty(H,"get",D.getGet(),0);
}
if(D.hasSetter()){
%AddNamedProperty(H,"set",D.getSet(),0);
}
if(D.hasEnumerable()){
%AddNamedProperty(H,"enumerable",D.isEnumerable(),0);
}
if(D.hasConfigurable()){
%AddNamedProperty(H,"configurable",D.isConfigurable(),0);
}
return H;
}
function ToPropertyDescriptor(H){
if(!(%_IsSpecObject(H)))throw MakeTypeError(76,H);
var D=new PropertyDescriptor();
if("enumerable"in H){
D.setEnumerable($toBoolean(H.enumerable));
}
if("configurable"in H){
D.setConfigurable($toBoolean(H.configurable));
}
if("value"in H){
D.setValue(H.value);
}
if("writable"in H){
D.setWritable($toBoolean(H.writable));
}
if("get"in H){
var J=H.get;
if(!(J===(void 0))&&!(%_ClassOf(J)==='Function')){
throw MakeTypeError(61,J);
}
D.setGet(J);
}
if("set"in H){
var K=H.set;
if(!(K===(void 0))&&!(%_ClassOf(K)==='Function')){
throw MakeTypeError(64,K);
}
D.setSet(K);
}
if(IsInconsistentDescriptor(D)){
throw MakeTypeError(113,H);
}
return D;
}
function ToCompletePropertyDescriptor(H){
var D=ToPropertyDescriptor(H);
if(IsGenericDescriptor(D)||IsDataDescriptor(D)){
if(!D.hasValue())D.setValue((void 0));
if(!D.hasWritable())D.setWritable(false);
}else{
if(!D.hasGetter())D.setGet((void 0));
if(!D.hasSetter())D.setSet((void 0));
}
if(!D.hasEnumerable())D.setEnumerable(false);
if(!D.hasConfigurable())D.setConfigurable(false);
return D;
}
function PropertyDescriptor(){
this.value_=(void 0);
this.hasValue_=false;
this.writable_=false;
this.hasWritable_=false;
this.enumerable_=false;
this.hasEnumerable_=false;
this.configurable_=false;
this.hasConfigurable_=false;
this.get_=(void 0);
this.hasGetter_=false;
this.set_=(void 0);
this.hasSetter_=false;
}
b.SetUpLockedPrototype(PropertyDescriptor,[
"value_",
"hasValue_",
"writable_",
"hasWritable_",
"enumerable_",
"hasEnumerable_",
"configurable_",
"hasConfigurable_",
"get_",
"hasGetter_",
"set_",
"hasSetter_"
],[
"toString",function PropertyDescriptor_ToString(){
return"[object PropertyDescriptor]";
},
"setValue",function PropertyDescriptor_SetValue(L){
this.value_=L;
this.hasValue_=true;
},
"getValue",function PropertyDescriptor_GetValue(){
return this.value_;
},
"hasValue",function PropertyDescriptor_HasValue(){
return this.hasValue_;
},
"setEnumerable",function PropertyDescriptor_SetEnumerable(M){
this.enumerable_=M;
this.hasEnumerable_=true;
},
"isEnumerable",function PropertyDescriptor_IsEnumerable(){
return this.enumerable_;
},
"hasEnumerable",function PropertyDescriptor_HasEnumerable(){
return this.hasEnumerable_;
},
"setWritable",function PropertyDescriptor_SetWritable(N){
this.writable_=N;
this.hasWritable_=true;
},
"isWritable",function PropertyDescriptor_IsWritable(){
return this.writable_;
},
"hasWritable",function PropertyDescriptor_HasWritable(){
return this.hasWritable_;
},
"setConfigurable",
function PropertyDescriptor_SetConfigurable(O){
this.configurable_=O;
this.hasConfigurable_=true;
},
"hasConfigurable",function PropertyDescriptor_HasConfigurable(){
return this.hasConfigurable_;
},
"isConfigurable",function PropertyDescriptor_IsConfigurable(){
return this.configurable_;
},
"setGet",function PropertyDescriptor_SetGetter(J){
this.get_=J;
this.hasGetter_=true;
},
"getGet",function PropertyDescriptor_GetGetter(){
return this.get_;
},
"hasGetter",function PropertyDescriptor_HasGetter(){
return this.hasGetter_;
},
"setSet",function PropertyDescriptor_SetSetter(K){
this.set_=K;
this.hasSetter_=true;
},
"getSet",function PropertyDescriptor_GetSetter(){
return this.set_;
},
"hasSetter",function PropertyDescriptor_HasSetter(){
return this.hasSetter_;
}
]);
function ConvertDescriptorArrayToDescriptor(P){
if((P===(void 0))){
return(void 0);
}
var D=new PropertyDescriptor();
if(P[0]){
D.setGet(P[2]);
D.setSet(P[3]);
}else{
D.setValue(P[1]);
D.setWritable(P[4]);
}
D.setEnumerable(P[5]);
D.setConfigurable(P[6]);
return D;
}
function GetTrap(B,E,Q){
var R=B[E];
if((R===(void 0))){
if((Q===(void 0))){
throw MakeTypeError(83,B,E);
}
R=Q;
}else if(!(%_ClassOf(R)==='Function')){
throw MakeTypeError(84,B,E);
}
return R;
}
function CallTrap0(B,E,Q){
return %_CallFunction(B,GetTrap(B,E,Q));
}
function CallTrap1(B,E,Q,t){
return %_CallFunction(B,t,GetTrap(B,E,Q));
}
function CallTrap2(B,E,Q,t,S){
return %_CallFunction(B,t,S,GetTrap(B,E,Q));
}
function GetOwnPropertyJS(H,T){
var U=$toName(T);
if(%_IsJSProxy(H)){
if((typeof(T)==='symbol'))return(void 0);
var B=%GetHandler(H);
var V=CallTrap1(
B,"getOwnPropertyDescriptor",(void 0),U);
if((V===(void 0)))return V;
var D=ToCompletePropertyDescriptor(V);
if(!D.isConfigurable()){
throw MakeTypeError(87,
B,U,"getOwnPropertyDescriptor");
}
return D;
}
var W=%GetOwnProperty(((%_IsSpecObject(%IS_VAR(H)))?H:$toObject(H)),U);
return ConvertDescriptorArrayToDescriptor(W);
}
function Delete(H,U,X){
var D=GetOwnPropertyJS(H,U);
if((D===(void 0)))return true;
if(D.isConfigurable()){
%DeleteProperty(H,U,0);
return true;
}else if(X){
throw MakeTypeError(24,U);
}else{
return;
}
}
function GetMethod(H,U){
var Y=H[U];
if((Y==null))return(void 0);
if((%_ClassOf(Y)==='Function'))return Y;
throw MakeTypeError(12,typeof Y);
}
function DefineProxyProperty(H,U,w,X){
if((typeof(U)==='symbol'))return false;
var B=%GetHandler(H);
var Z=CallTrap2(B,"defineProperty",(void 0),U,w);
if(!$toBoolean(Z)){
if(X){
throw MakeTypeError(82,
B,"false","defineProperty");
}else{
return false;
}
}
return true;
}
function DefineObjectProperty(H,U,D,X){
var aa=%GetOwnProperty(H,$toName(U));
var ab=ConvertDescriptorArrayToDescriptor(aa);
var ac=%IsExtensible(H);
if((ab===(void 0))&&!ac){
if(X){
throw MakeTypeError(24,U);
}else{
return false;
}
}
if(!(ab===(void 0))){
if((IsGenericDescriptor(D)||
IsDataDescriptor(D)==IsDataDescriptor(ab))&&
(!D.hasEnumerable()||
$sameValue(D.isEnumerable(),ab.isEnumerable()))&&
(!D.hasConfigurable()||
$sameValue(D.isConfigurable(),ab.isConfigurable()))&&
(!D.hasWritable()||
$sameValue(D.isWritable(),ab.isWritable()))&&
(!D.hasValue()||
$sameValue(D.getValue(),ab.getValue()))&&
(!D.hasGetter()||
$sameValue(D.getGet(),ab.getGet()))&&
(!D.hasSetter()||
$sameValue(D.getSet(),ab.getSet()))){
return true;
}
if(!ab.isConfigurable()){
if(D.isConfigurable()||
(D.hasEnumerable()&&
D.isEnumerable()!=ab.isEnumerable())){
if(X){
throw MakeTypeError(90,U);
}else{
return false;
}
}
if(!IsGenericDescriptor(D)){
if(IsDataDescriptor(ab)!=IsDataDescriptor(D)){
if(X){
throw MakeTypeError(90,U);
}else{
return false;
}
}
if(IsDataDescriptor(ab)&&IsDataDescriptor(D)){
var ad=ab.isWritable();
if(ad!=D.isWritable()){
if(!ad||(%IsStrong(H))){
if(X){
throw ad
?MakeTypeError(106,H,U)
:MakeTypeError(90,U);
}else{
return false;
}
}
}
if(!ad&&D.hasValue()&&
!$sameValue(D.getValue(),ab.getValue())){
if(X){
throw MakeTypeError(90,U);
}else{
return false;
}
}
}
if(IsAccessorDescriptor(D)&&IsAccessorDescriptor(ab)){
if(D.hasSetter()&&
!$sameValue(D.getSet(),ab.getSet())){
if(X){
throw MakeTypeError(90,U);
}else{
return false;
}
}
if(D.hasGetter()&&!$sameValue(D.getGet(),ab.getGet())){
if(X){
throw MakeTypeError(90,U);
}else{
return false;
}
}
}
}
}
}
var ae=0;
if(D.hasEnumerable()){
ae|=D.isEnumerable()?0:2;
}else if(!(ab===(void 0))){
ae|=ab.isEnumerable()?0:2;
}else{
ae|=2;
}
if(D.hasConfigurable()){
ae|=D.isConfigurable()?0:4;
}else if(!(ab===(void 0))){
ae|=ab.isConfigurable()?0:4;
}else
ae|=4;
if(IsDataDescriptor(D)||
(IsGenericDescriptor(D)&&
((ab===(void 0))||IsDataDescriptor(ab)))){
if(D.hasWritable()){
ae|=D.isWritable()?0:1;
}else if(!(ab===(void 0))){
ae|=ab.isWritable()?0:1;
}else{
ae|=1;
}
var L=(void 0);
if(D.hasValue()){
L=D.getValue();
}else if(!(ab===(void 0))&&IsDataDescriptor(ab)){
L=ab.getValue();
}
%DefineDataPropertyUnchecked(H,U,L,ae);
}else{
var af=null;
if(D.hasGetter()){
af=D.getGet();
}else if(IsAccessorDescriptor(ab)&&ab.hasGetter()){
af=ab.getGet();
}
var ag=null;
if(D.hasSetter()){
ag=D.getSet();
}else if(IsAccessorDescriptor(ab)&&ab.hasSetter()){
ag=ab.getSet();
}
%DefineAccessorPropertyUnchecked(H,U,af,ag,ae);
}
return true;
}
function DefineArrayProperty(H,U,D,X){
if(U==="length"){
var ah=H.length;
var ai=ah;
if(!D.hasValue()){
return DefineObjectProperty(H,"length",D,X);
}
var aj=$toUint32(D.getValue());
if(aj!=$toNumber(D.getValue())){
throw MakeRangeError(122);
}
var ak=GetOwnPropertyJS(H,"length");
if(aj!=ah&&!ak.isWritable()){
if(X){
throw MakeTypeError(90,U);
}else{
return false;
}
}
var al=false;
var am=%IsObserved(H)&&aj!==ai;
var an;
if(am){
$observeBeginPerformSplice(H);
an=[];
if(aj<ai)
an.length=ai-aj;
}
while(aj<ah--){
var ao=$toString(ah);
if(am){
var ap=GetOwnPropertyJS(H,ao);
if(ap&&ap.hasValue())
an[ah-aj]=ap.getValue();
}
if(!Delete(H,ao,false)){
aj=ah+1;
al=true;
break;
}
}
al=!DefineObjectProperty(H,"length",D,X)||al;
if(am){
$observeEndPerformSplice(H);
$observeEnqueueSpliceRecord(H,
aj<ai?aj:ai,
an,
aj>ai?aj-ai:0);
}
if(al){
if(X){
throw MakeTypeError(90,U);
}else{
return false;
}
}
return true;
}
if(!(typeof(U)==='symbol')){
var ao=$toUint32(U);
var am=false;
if($toString(ao)==U&&ao!=4294967295){
var ah=H.length;
if(ao>=ah&&%IsObserved(H)){
am=true;
$observeBeginPerformSplice(H);
}
var ak=GetOwnPropertyJS(H,"length");
if((ao>=ah&&!ak.isWritable())||
!DefineObjectProperty(H,U,D,true)){
if(am)
$observeEndPerformSplice(H);
if(X){
throw MakeTypeError(24,U);
}else{
return false;
}
}
if(ao>=ah){
H.length=ao+1;
}
if(am){
$observeEndPerformSplice(H);
$observeEnqueueSpliceRecord(H,ah,[],ao+1-ah);
}
return true;
}
}
return DefineObjectProperty(H,U,D,X);
}
function DefineOwnProperty(H,U,D,X){
if(%_IsJSProxy(H)){
if((typeof(U)==='symbol'))return false;
var w=FromGenericPropertyDescriptor(D);
return DefineProxyProperty(H,U,w,X);
}else if((%_IsArray(H))){
return DefineArrayProperty(H,U,D,X);
}else{
return DefineObjectProperty(H,U,D,X);
}
}
function DefineOwnPropertyFromAPI(H,U,L,D){
return DefineOwnProperty(H,U,ToPropertyDescriptor({
value:L,
writable:D[0],
enumerable:D[1],
configurable:D[2]
}),
false);
}
function ObjectGetPrototypeOf(H){
return %_GetPrototype(((%_IsSpecObject(%IS_VAR(H)))?H:$toObject(H)));
}
function ObjectSetPrototypeOf(H,aq){
if((H==null)&&!(%_IsUndetectableObject(H)))throw MakeTypeError(14,"Object.setPrototypeOf");
if(aq!==null&&!(%_IsSpecObject(aq))){
throw MakeTypeError(78,aq);
}
if((%_IsSpecObject(H))){
%SetPrototype(H,aq);
}
return H;
}
function ObjectGetOwnPropertyDescriptor(H,U){
var D=GetOwnPropertyJS(((%_IsSpecObject(%IS_VAR(H)))?H:$toObject(H)),U);
return FromPropertyDescriptor(D);
}
function ToNameArray(H,R,ar){
if(!(%_IsSpecObject(H))){
throw MakeTypeError(85,R,H);
}
var as=$toUint32(H.length);
var at=new c(as);
var au=0;
var I={__proto__:null};
for(var ao=0;ao<as;ao++){
var av=$toName(H[ao]);
if((typeof(av)==='symbol')&&!ar)continue;
if(%HasOwnProperty(I,av)){
throw MakeTypeError(88,R,av);
}
at[au]=av;
++au;
I[av]=0;
}
at.length=au;
return at;
}
function ObjectGetOwnPropertyKeys(H,aw){
var ax=new i();
aw|=32;
var ay=%GetInterceptorInfo(H);
if((aw&8)===0){
var az=%GetOwnElementNames(H);
for(var aA=0;aA<az.length;++aA){
az[aA]=%_NumberToString(az[aA]);
}
ax.push(az);
if((ay&1)!=0){
var aB=%GetIndexedInterceptorElementNames(H);
if(!(aB===(void 0))){
ax.push(aB);
}
}
}
ax.push(%GetOwnPropertyNames(H,aw));
if((ay&2)!=0){
var aC=
%GetNamedInterceptorPropertyNames(H);
if(!(aC===(void 0))){
ax.push(aC);
}
}
var aD=
%Apply(i.prototype.concat,
ax[0],ax,1,ax.length-1);
if(ay!=0){
var aE={__proto__:null};
var aF=0;
for(var aA=0;aA<aD.length;++aA){
var E=aD[aA];
if((typeof(E)==='symbol')){
if((aw&16)||(%SymbolIsPrivate(E))){
continue;
}
}else{
if(aw&8)continue;
E=$toString(E);
}
if(aE[E])continue;
aE[E]=true;
aD[aF++]=E;
}
aD.length=aF;
}
return aD;
}
function OwnPropertyKeys(H){
if(%_IsJSProxy(H)){
var B=%GetHandler(H);
var I=CallTrap0(B,"ownKeys",(void 0));
return ToNameArray(I,"getOwnPropertyNames",false);
}
return ObjectGetOwnPropertyKeys(H,32);
}
function ObjectGetOwnPropertyNames(H){
H=((%_IsSpecObject(%IS_VAR(H)))?H:$toObject(H));
if(%_IsJSProxy(H)){
var B=%GetHandler(H);
var I=CallTrap0(B,"getOwnPropertyNames",(void 0));
return ToNameArray(I,"getOwnPropertyNames",false);
}
return ObjectGetOwnPropertyKeys(H,16);
}
function ObjectCreate(aq,aG){
if(!(%_IsSpecObject(aq))&&aq!==null){
throw MakeTypeError(78,aq);
}
var H={};
%InternalSetPrototype(H,aq);
if(!(aG===(void 0)))ObjectDefineProperties(H,aG);
return H;
}
function ObjectDefineProperty(H,U,w){
if(!(%_IsSpecObject(H))){
throw MakeTypeError(13,"Object.defineProperty");
}
var E=$toName(U);
if(%_IsJSProxy(H)){
var aH={__proto__:null};
for(var aI in w){
aH[aI]=w[aI];
}
DefineProxyProperty(H,E,aH,true);
}else{
var D=ToPropertyDescriptor(w);
DefineOwnProperty(H,E,D,true);
}
return H;
}
function GetOwnEnumerablePropertyNames(aJ){
var I=new i();
for(var aK in aJ){
if(%HasOwnProperty(aJ,aK)){
I.push(aK);
}
}
var aw=8|32;
var aL=%GetOwnPropertyNames(aJ,aw);
for(var aA=0;aA<aL.length;++aA){
var aM=aL[aA];
if((typeof(aM)==='symbol')){
var D=ObjectGetOwnPropertyDescriptor(aJ,aM);
if(D.enumerable)I.push(aM);
}
}
return I;
}
function ObjectDefineProperties(H,aG){
if(!(%_IsSpecObject(H))){
throw MakeTypeError(13,"Object.defineProperties");
}
var W=((%_IsSpecObject(%IS_VAR(aG)))?aG:$toObject(aG));
var I=GetOwnEnumerablePropertyNames(W);
var aN=new i();
for(var aA=0;aA<I.length;aA++){
aN.push(ToPropertyDescriptor(W[I[aA]]));
}
for(var aA=0;aA<I.length;aA++){
DefineOwnProperty(H,I[aA],aN[aA],true);
}
return H;
}
function ProxyFix(H){
var B=%GetHandler(H);
var W=CallTrap0(B,"fix",(void 0));
if((W===(void 0))){
throw MakeTypeError(82,B,"undefined","fix");
}
if(%IsJSFunctionProxy(H)){
var aO=%GetCallTrap(H);
var aP=%GetConstructTrap(H);
var aQ=k(aO,aP);
%Fix(H);
%SetCode(H,aQ);
var aR=new h();
ObjectDefineProperty(aR,"constructor",
{value:H,writable:true,enumerable:false,configurable:true});
%FunctionSetPrototype(H,aR);
H.length=0;
}else{
%Fix(H);
}
ObjectDefineProperties(H,W);
}
function ObjectSealJS(H){
if(!(%_IsSpecObject(H)))return H;
var aS=%_IsJSProxy(H);
if(aS||%HasSloppyArgumentsElements(H)||%IsObserved(H)){
if(aS){
ProxyFix(H);
}
var I=ObjectGetOwnPropertyNames(H);
for(var aA=0;aA<I.length;aA++){
var E=I[aA];
var D=GetOwnPropertyJS(H,E);
if(D.isConfigurable()){
D.setConfigurable(false);
DefineOwnProperty(H,E,D,true);
}
}
%PreventExtensions(H);
}else{
%ObjectSeal(H);
}
return H;
}
function ObjectFreezeJS(H){
if(!(%_IsSpecObject(H)))return H;
var aS=%_IsJSProxy(H);
if(aS||%HasSloppyArgumentsElements(H)||%IsObserved(H)||
(%IsStrong(H))){
if(aS){
ProxyFix(H);
}
var I=ObjectGetOwnPropertyNames(H);
for(var aA=0;aA<I.length;aA++){
var E=I[aA];
var D=GetOwnPropertyJS(H,E);
if(D.isWritable()||D.isConfigurable()){
if(IsDataDescriptor(D))D.setWritable(false);
D.setConfigurable(false);
DefineOwnProperty(H,E,D,true);
}
}
%PreventExtensions(H);
}else{
%ObjectFreeze(H);
}
return H;
}
function ObjectPreventExtension(H){
if(!(%_IsSpecObject(H)))return H;
if(%_IsJSProxy(H)){
ProxyFix(H);
}
%PreventExtensions(H);
return H;
}
function ObjectIsSealed(H){
if(!(%_IsSpecObject(H)))return true;
if(%_IsJSProxy(H)){
return false;
}
if(%IsExtensible(H)){
return false;
}
var I=ObjectGetOwnPropertyNames(H);
for(var aA=0;aA<I.length;aA++){
var E=I[aA];
var D=GetOwnPropertyJS(H,E);
if(D.isConfigurable()){
return false;
}
}
return true;
}
function ObjectIsFrozen(H){
if(!(%_IsSpecObject(H)))return true;
if(%_IsJSProxy(H)){
return false;
}
if(%IsExtensible(H)){
return false;
}
var I=ObjectGetOwnPropertyNames(H);
for(var aA=0;aA<I.length;aA++){
var E=I[aA];
var D=GetOwnPropertyJS(H,E);
if(IsDataDescriptor(D)&&D.isWritable())return false;
if(D.isConfigurable())return false;
}
return true;
}
function ObjectIsExtensible(H){
if(!(%_IsSpecObject(H)))return false;
if(%_IsJSProxy(H)){
return true;
}
return %IsExtensible(H);
}
function ObjectIs(aT,aU){
return $sameValue(aT,aU);
}
function ObjectGetProto(){
return %_GetPrototype(((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this)));
}
function ObjectSetProto(aq){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Object.prototype.__proto__");
if(((%_IsSpecObject(aq))||(aq===null))&&(%_IsSpecObject(this))){
%SetPrototype(this,aq);
}
}
function ObjectConstructor(t){
if(%_IsConstructCall()){
if(t==null)return this;
return((%_IsSpecObject(%IS_VAR(t)))?t:$toObject(t));
}else{
if(t==null)return{};
return((%_IsSpecObject(%IS_VAR(t)))?t:$toObject(t));
}
}
%SetNativeFlag(h);
%SetCode(h,ObjectConstructor);
%AddNamedProperty(h.prototype,"constructor",h,
2);
b.InstallFunctions(h.prototype,2,[
"toString",ObjectToString,
"toLocaleString",ObjectToLocaleString,
"valueOf",ObjectValueOf,
"hasOwnProperty",ObjectHasOwnProperty,
"isPrototypeOf",ObjectIsPrototypeOf,
"propertyIsEnumerable",ObjectPropertyIsEnumerable,
"__defineGetter__",ObjectDefineGetter,
"__lookupGetter__",ObjectLookupGetter,
"__defineSetter__",ObjectDefineSetter,
"__lookupSetter__",ObjectLookupSetter
]);
b.InstallGetterSetter(h.prototype,"__proto__",ObjectGetProto,
ObjectSetProto);
b.InstallFunctions(h,2,[
"keys",ObjectKeys,
"create",ObjectCreate,
"defineProperty",ObjectDefineProperty,
"defineProperties",ObjectDefineProperties,
"freeze",ObjectFreezeJS,
"getPrototypeOf",ObjectGetPrototypeOf,
"setPrototypeOf",ObjectSetPrototypeOf,
"getOwnPropertyDescriptor",ObjectGetOwnPropertyDescriptor,
"getOwnPropertyNames",ObjectGetOwnPropertyNames,
"is",ObjectIs,
"isExtensible",ObjectIsExtensible,
"isFrozen",ObjectIsFrozen,
"isSealed",ObjectIsSealed,
"preventExtensions",ObjectPreventExtension,
"seal",ObjectSealJS
]);
function BooleanConstructor(t){
if(%_IsConstructCall()){
%_SetValueOf(this,$toBoolean(t));
}else{
return $toBoolean(t);
}
}
function BooleanToString(){
var aV=this;
if(!(typeof(aV)==='boolean')){
if(!(%_ClassOf(aV)==='Boolean')){
throw MakeTypeError(55,'Boolean.prototype.toString');
}
aV=%_ValueOf(aV);
}
return aV?'true':'false';
}
function BooleanValueOf(){
if(!(typeof(this)==='boolean')&&!(%_ClassOf(this)==='Boolean')){
throw MakeTypeError(55,'Boolean.prototype.valueOf');
}
return %_ValueOf(this);
}
%SetCode(d,BooleanConstructor);
%FunctionSetPrototype(d,new d(false));
%AddNamedProperty(d.prototype,"constructor",d,
2);
b.InstallFunctions(d.prototype,2,[
"toString",BooleanToString,
"valueOf",BooleanValueOf
]);
function NumberConstructor(t){
var L=%_ArgumentsLength()==0?0:$toNumber(t);
if(%_IsConstructCall()){
%_SetValueOf(this,L);
}else{
return L;
}
}
function NumberToStringJS(r){
var p=this;
if(!(typeof(this)==='number')){
if(!(%_ClassOf(this)==='Number')){
throw MakeTypeError(55,'Number.prototype.toString');
}
p=%_ValueOf(this);
}
if((r===(void 0))||r===10){
return %_NumberToString(p);
}
r=(%_IsSmi(%IS_VAR(r))?r:%NumberToInteger($toNumber(r)));
if(r<2||r>36)throw MakeRangeError(147);
return %NumberToRadixString(p,r);
}
function NumberToLocaleString(){
return %_CallFunction(this,NumberToStringJS);
}
function NumberValueOf(){
if(!(typeof(this)==='number')&&!(%_ClassOf(this)==='Number')){
throw MakeTypeError(55,'Number.prototype.valueOf');
}
return %_ValueOf(this);
}
function NumberToFixedJS(aW){
var t=this;
if(!(typeof(this)==='number')){
if(!(%_ClassOf(this)==='Number')){
throw MakeTypeError(33,
"Number.prototype.toFixed",this);
}
t=%_ValueOf(this);
}
var v=(%_IsSmi(%IS_VAR(aW))?aW:%NumberToInteger($toNumber(aW)));
if(v<0||v>20){
throw MakeRangeError(143,"toFixed() digits");
}
if((!%_IsSmi(%IS_VAR(t))&&!(t==t)))return"NaN";
if(t==(1/0))return"Infinity";
if(t==-(1/0))return"-Infinity";
return %NumberToFixed(t,v);
}
function NumberToExponentialJS(aW){
var t=this;
if(!(typeof(this)==='number')){
if(!(%_ClassOf(this)==='Number')){
throw MakeTypeError(33,
"Number.prototype.toExponential",this);
}
t=%_ValueOf(this);
}
var v=(aW===(void 0))?(void 0):(%_IsSmi(%IS_VAR(aW))?aW:%NumberToInteger($toNumber(aW)));
if((!%_IsSmi(%IS_VAR(t))&&!(t==t)))return"NaN";
if(t==(1/0))return"Infinity";
if(t==-(1/0))return"-Infinity";
if((v===(void 0))){
v=-1;
}else if(v<0||v>20){
throw MakeRangeError(143,"toExponential()");
}
return %NumberToExponential(t,v);
}
function NumberToPrecisionJS(aX){
var t=this;
if(!(typeof(this)==='number')){
if(!(%_ClassOf(this)==='Number')){
throw MakeTypeError(33,
"Number.prototype.toPrecision",this);
}
t=%_ValueOf(this);
}
if((aX===(void 0)))return $toString(%_ValueOf(this));
var U=(%_IsSmi(%IS_VAR(aX))?aX:%NumberToInteger($toNumber(aX)));
if((!%_IsSmi(%IS_VAR(t))&&!(t==t)))return"NaN";
if(t==(1/0))return"Infinity";
if(t==-(1/0))return"-Infinity";
if(U<1||U>21){
throw MakeRangeError(146);
}
return %NumberToPrecision(t,U);
}
function NumberIsFinite(p){
return(typeof(p)==='number')&&(%_IsSmi(%IS_VAR(p))||((p==p)&&(p!=1/0)&&(p!=-1/0)));
}
function NumberIsInteger(p){
return NumberIsFinite(p)&&(%_IsSmi(%IS_VAR(p))?p:%NumberToInteger($toNumber(p)))==p;
}
function NumberIsNaN(p){
return(typeof(p)==='number')&&(!%_IsSmi(%IS_VAR(p))&&!(p==p));
}
function NumberIsSafeInteger(p){
if(NumberIsFinite(p)){
var aY=(%_IsSmi(%IS_VAR(p))?p:%NumberToInteger($toNumber(p)));
if(aY==p){
return j(aY)<=g.MAX_SAFE_INTEGER;
}
}
return false;
}
%SetCode(g,NumberConstructor);
%FunctionSetPrototype(g,new g(0));
%OptimizeObjectForAddingMultipleProperties(g.prototype,8);
%AddNamedProperty(g.prototype,"constructor",g,
2);
b.InstallConstants(g,[
"MAX_VALUE",1.7976931348623157e+308,
"MIN_VALUE",5e-324,
"NaN",$NaN,
"NEGATIVE_INFINITY",-(1/0),
"POSITIVE_INFINITY",(1/0),
"MAX_SAFE_INTEGER",%_MathPow(2,53)-1,
"MIN_SAFE_INTEGER",-%_MathPow(2,53)+1,
"EPSILON",%_MathPow(2,-52)
]);
b.InstallFunctions(g.prototype,2,[
"toString",NumberToStringJS,
"toLocaleString",NumberToLocaleString,
"valueOf",NumberValueOf,
"toFixed",NumberToFixedJS,
"toExponential",NumberToExponentialJS,
"toPrecision",NumberToPrecisionJS
]);
b.InstallFunctions(g,2,[
"isFinite",NumberIsFinite,
"isInteger",NumberIsInteger,
"isNaN",NumberIsNaN,
"isSafeInteger",NumberIsSafeInteger,
"parseInt",GlobalParseInt,
"parseFloat",GlobalParseFloat
]);
%SetForceInlineFlag(NumberIsNaN);
function NativeCodeFunctionSourceString(Y){
var E=%FunctionGetName(Y);
if(E){
return'function '+E+'() { [native code] }';
}
return'function () { [native code] }';
}
function FunctionSourceString(Y){
while(%IsJSFunctionProxy(Y)){
Y=%GetCallTrap(Y);
}
if(!(%_IsFunction(Y))){
throw MakeTypeError(55,'Function.prototype.toString');
}
if(%FunctionIsBuiltin(Y)){
return NativeCodeFunctionSourceString(Y);
}
var aZ=%ClassGetSourceCode(Y);
if((typeof(aZ)==='string')){
return aZ;
}
var ba=%FunctionGetSourceCode(Y);
if(!(typeof(ba)==='string')){
return NativeCodeFunctionSourceString(Y);
}
if(%FunctionIsArrow(Y)){
return ba;
}
var E=%FunctionNameShouldPrintAsAnonymous(Y)
?'anonymous'
:%FunctionGetName(Y);
var bb=%FunctionIsGenerator(Y);
var bc=%FunctionIsConciseMethod(Y)
?(bb?'*':'')
:(bb?'function* ':'function ');
return bc+E+ba;
}
function FunctionToString(){
return FunctionSourceString(this);
}
function FunctionBind(bd){
if(!(%_ClassOf(this)==='Function'))throw MakeTypeError(30);
var be=function(){
"use strict";
if(%_IsConstructCall()){
return %NewObjectFromBound(be);
}
var bf=%BoundFunctionGetBindings(be);
var bg=%_ArgumentsLength();
if(bg==0){
return %Apply(bf[0],bf[1],bf,2,bf.length-2);
}
if(bf.length===2){
return %Apply(bf[0],bf[1],arguments,0,bg);
}
var bh=bf.length-2;
var bi=new i(bh+bg);
for(var aA=0;aA<bh;aA++){
bi[aA]=bf[aA+2];
}
for(var aF=0;aF<bg;aF++){
bi[aA++]=%_Arguments(aF);
}
return %Apply(bf[0],bf[1],bi,0,bh+bg);
};
var aj=0;
var ai=this.length;
if((typeof ai==="number")&&
((ai>>>0)===ai)){
var bg=%_ArgumentsLength();
if(bg>0)bg--;
aj=ai-bg;
if(aj<0)aj=0;
}
var Z=%FunctionBindArguments(be,this,
bd,aj);
return Z;
}
function NewFunctionString(bj,bk){
var as=bj.length;
var U='';
if(as>1){
U=$toString(bj[0]);
for(var aA=1;aA<as-1;aA++){
U+=','+$toString(bj[aA]);
}
if(%_CallFunction(U,')',n)!=-1){
throw MakeSyntaxError(184);
}
U+='\n/'+'**/';
}
var bl=(as>0)?$toString(bj[as-1]):'';
return'('+bk+'('+U+') {\n'+bl+'\n})';
}
function FunctionConstructor(bm){
var ba=NewFunctionString(arguments,'function');
var u=%GlobalProxy(FunctionConstructor);
var v=%_CallFunction(u,%CompileString(ba,true));
%FunctionMarkNameShouldPrintAsAnonymous(v);
return v;
}
%SetCode(e,FunctionConstructor);
%AddNamedProperty(e.prototype,"constructor",e,
2);
b.InstallFunctions(e.prototype,2,[
"bind",FunctionBind,
"toString",FunctionToString
]);
function GetIterator(H,bn){
if((bn===(void 0))){
bn=H[symbolIterator];
}
if(!(%_ClassOf(bn)==='Function')){
throw MakeTypeError(56,H);
}
var bo=%_CallFunction(H,bn);
if(!(%_IsSpecObject(bo))){
throw MakeTypeError(50,bo);
}
return bo;
}
$functionSourceString=FunctionSourceString;
$globalEval=GlobalEval;
$objectDefineOwnProperty=DefineOwnPropertyFromAPI;
$objectGetOwnPropertyDescriptor=ObjectGetOwnPropertyDescriptor;
$toCompletePropertyDescriptor=ToCompletePropertyDescriptor;
b.ObjectDefineProperties=ObjectDefineProperties;
b.ObjectDefineProperty=ObjectDefineProperty;
b.Export(function(bp){
bp.Delete=Delete;
bp.GetIterator=GetIterator;
bp.GetMethod=GetMethod;
bp.IsFinite=GlobalIsFinite;
bp.IsNaN=GlobalIsNaN;
bp.NewFunctionString=NewFunctionString;
bp.NumberIsNaN=NumberIsNaN;
bp.ObjectDefineProperty=ObjectDefineProperty;
bp.ObjectFreeze=ObjectFreezeJS;
bp.ObjectGetOwnPropertyKeys=ObjectGetOwnPropertyKeys;
bp.ObjectHasOwnProperty=ObjectHasOwnProperty;
bp.ObjectIsFrozen=ObjectIsFrozen;
bp.ObjectIsSealed=ObjectIsSealed;
bp.ObjectToString=ObjectToString;
bp.OwnPropertyKeys=OwnPropertyKeys;
bp.ToNameArray=ToNameArray;
});
})

symbol%
var $symbolToString;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Object;
var d=a.Symbol;
var e;
b.Import(function(g){
e=g.ObjectGetOwnPropertyKeys;
});
function SymbolConstructor(h){
if(%_IsConstructCall())throw MakeTypeError(52,"Symbol");
return %CreateSymbol((h===(void 0))?h:$toString(h));
}
function SymbolToString(){
if(!((typeof(this)==='symbol')||(%_ClassOf(this)==='Symbol'))){
throw MakeTypeError(33,
"Symbol.prototype.toString",this);
}
var i=%SymbolDescription(%_ValueOf(this));
return"Symbol("+((i===(void 0))?"":i)+")";
}
function SymbolValueOf(){
if(!((typeof(this)==='symbol')||(%_ClassOf(this)==='Symbol'))){
throw MakeTypeError(33,
"Symbol.prototype.valueOf",this);
}
return %_ValueOf(this);
}
function SymbolFor(j){
j=((typeof(%IS_VAR(j))==='string')?j:$nonStringToString(j));
var k=%SymbolRegistry();
if((k.for[j]===(void 0))){
var l=%CreateSymbol(j);
k.for[j]=l;
k.keyFor[l]=j;
}
return k.for[j];
}
function SymbolKeyFor(l){
if(!(typeof(l)==='symbol'))throw MakeTypeError(108,l);
return %SymbolRegistry().keyFor[l];
}
function ObjectGetOwnPropertySymbols(m){
m=$toObject(m);
return e(m,8);
}
%SetCode(d,SymbolConstructor);
%FunctionSetPrototype(d,new c());
b.InstallConstants(d,[
"iterator",symbolIterator,
"unscopables",symbolUnscopables
]);
b.InstallFunctions(d,2,[
"for",SymbolFor,
"keyFor",SymbolKeyFor
]);
%AddNamedProperty(
d.prototype,"constructor",d,2);
%AddNamedProperty(
d.prototype,symbolToStringTag,"Symbol",2|1);
b.InstallFunctions(d.prototype,2,[
"toString",SymbolToString,
"valueOf",SymbolValueOf
]);
b.InstallFunctions(c,2,[
"getOwnPropertySymbols",ObjectGetOwnPropertySymbols
]);
$symbolToString=SymbolToString;
})

arrayž”
var $arrayConcat;
var $arrayPush;
var $arrayPop;
var $arrayShift;
var $arraySlice;
var $arraySplice;
var $arrayUnshift;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Array;
var d=b.InternalArray;
var e=b.InternalPackedArray;
var g;
var h;
var i;
var j;
var k;
var l;
b.Import(function(m){
g=m.Delete;
h=m.MathMin;
i=m.ObjectHasOwnProperty;
j=m.ObjectIsFrozen;
k=m.ObjectIsSealed;
l=m.ObjectToString;
});
var n=new d();
function GetSortedArrayKeys(o,p){
var q=new d();
if((typeof(p)==='number')){
var r=p;
for(var t=0;t<r;++t){
var u=o[t];
if(!(u===(void 0))||t in o){
q.push(t);
}
}
}else{
var v=p.length;
for(var w=0;w<v;++w){
var x=p[w];
if(!(x===(void 0))){
var u=o[x];
if(!(u===(void 0))||x in o){
q.push(x);
}
}
}
%_CallFunction(q,function(y,z){return y-z;},ArraySort);
}
return q;
}
function SparseJoinWithSeparatorJS(o,A,B,C){
var q=GetSortedArrayKeys(o,%GetArrayKeys(o,A));
var D=0;
var E=new d(q.length*2);
var F=-1;
for(var t=0;t<q.length;t++){
var x=q[t];
if(x!=F){
var u=o[x];
if(!(typeof(u)==='string'))u=B(u);
E[t*2]=x;
E[t*2+1]=u;
F=x;
}
}
return %SparseJoinWithSeparator(E,A,C);
}
function SparseJoin(o,A,B){
var q=GetSortedArrayKeys(o,%GetArrayKeys(o,A));
var G=-1;
var H=q.length;
var E=new d(H);
var I=0;
for(var t=0;t<H;t++){
var x=q[t];
if(x!=G){
var u=o[x];
if(!(typeof(u)==='string'))u=B(u);
E[I++]=u;
G=x;
}
}
return %StringBuilderConcat(E,I,'');
}
function UseSparseVariant(o,v,J,K){
if(!J||v<1000||%IsObserved(o)||
%HasComplexElements(o)){
return false;
}
if(!%_IsSmi(v)){
return true;
}
var L=v>>2;
var M=%EstimateNumberOfElements(o);
return(M<L)&&
(K>M*4);
}
function Join(o,v,C,B){
if(v==0)return'';
var J=(%_IsArray(o));
if(J){
if(!%PushIfAbsent(n,o))return'';
}
try{
if(UseSparseVariant(o,v,J,v)){
%NormalizeElements(o);
if(C.length==0){
return SparseJoin(o,v,B);
}else{
return SparseJoinWithSeparatorJS(o,v,B,C);
}
}
if(v==1){
var u=o[0];
if((typeof(u)==='string'))return u;
return B(u);
}
var E=new d(v);
if(C.length==0){
var I=0;
for(var t=0;t<v;t++){
var u=o[t];
if(!(typeof(u)==='string'))u=B(u);
E[I++]=u;
}
E.length=I;
var N=%_FastOneByteArrayJoin(E,'');
if(!(N===(void 0)))return N;
return %StringBuilderConcat(E,I,'');
}
if(!(typeof(o[0])==='number')){
for(var t=0;t<v;t++){
var u=o[t];
if(!(typeof(u)==='string'))u=B(u);
E[t]=u;
}
}else{
for(var t=0;t<v;t++){
var u=o[t];
if((typeof(u)==='number')){
u=%_NumberToString(u);
}else if(!(typeof(u)==='string')){
u=B(u);
}
E[t]=u;
}
}
var N=%_FastOneByteArrayJoin(E,C);
if(!(N===(void 0)))return N;
return %StringBuilderJoin(E,v,C);
}finally{
if(J)n.length=n.length-1;
}
}
function ConvertToString(O){
if((typeof(O)==='number'))return %_NumberToString(O);
if((typeof(O)==='boolean'))return O?'true':'false';
return((O==null))?'':$toString($defaultString(O));
}
function ConvertToLocaleString(u){
if((u==null)){
return'';
}else{
var P=$toObject(u);
return $toString(P.toLocaleString());
}
}
function SparseSlice(o,Q,R,A,S){
var p=%GetArrayKeys(o,Q+R);
if((typeof(p)==='number')){
var r=p;
for(var t=Q;t<r;++t){
var T=o[t];
if(!(T===(void 0))||t in o){
%AddElement(S,t-Q,T,0);
}
}
}else{
var v=p.length;
for(var w=0;w<v;++w){
var x=p[w];
if(!(x===(void 0))){
if(x>=Q){
var T=o[x];
if(!(T===(void 0))||x in o){
%AddElement(S,x-Q,T,0);
}
}
}
}
}
}
function SparseMove(o,Q,R,A,U){
if(U===R)return;
var V=new d(
h(A-R+U,0xffffffff));
var W;
var p=%GetArrayKeys(o,A);
if((typeof(p)==='number')){
var r=p;
for(var t=0;t<Q&&t<r;++t){
var T=o[t];
if(!(T===(void 0))||t in o){
V[t]=T;
}
}
for(var t=Q+R;t<r;++t){
var T=o[t];
if(!(T===(void 0))||t in o){
V[t-R+U]=T;
}
}
}else{
var v=p.length;
for(var w=0;w<v;++w){
var x=p[w];
if(!(x===(void 0))){
if(x<Q){
var T=o[x];
if(!(T===(void 0))||x in o){
V[x]=T;
}
}else if(x>=Q+R){
var T=o[x];
if(!(T===(void 0))||x in o){
var X=x-R+U;
V[X]=T;
if(X>0xfffffffe){
W=W||new d();
W.push(X);
}
}
}
}
}
}
%MoveArrayContents(V,o);
if(!(W===(void 0))){
var v=W.length;
for(var t=0;t<v;++t){
var x=W[t];
o[x]=V[x];
}
}
}
function SimpleSlice(o,Q,R,A,S){
var J=(%_IsArray(o));
for(var t=0;t<R;t++){
var Y=Q+t;
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(Y<o.length):(Y in o))){
var T=o[Y];
%AddElement(S,t,T,0);
}
}
}
function SimpleMove(o,Q,R,A,U){
var J=(%_IsArray(o));
if(U!==R){
if(U>R){
for(var t=A-R;t>Q;t--){
var Z=t+R-1;
var aa=t+U-1;
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(Z<o.length):(Z in o))){
o[aa]=o[Z];
}else{
delete o[aa];
}
}
}else{
for(var t=Q;t<A-R;t++){
var Z=t+R;
var aa=t+U;
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(Z<o.length):(Z in o))){
o[aa]=o[Z];
}else{
delete o[aa];
}
}
for(var t=A;t>A-R+U;t--){
delete o[t-1];
}
}
}
}
function ArrayToString(){
var o;
var ab;
if((%_IsArray(this))){
ab=this.join;
if(ab===ArrayJoin){
return Join(this,this.length,',',ConvertToString);
}
o=this;
}else{
o=$toObject(this);
ab=o.join;
}
if(!(%_ClassOf(ab)==='Function')){
return %_CallFunction(o,l);
}
return %_CallFunction(o,ab);
}
function InnerArrayToLocaleString(o,v){
var A=(v>>>0);
if(A===0)return"";
return Join(o,A,',',ConvertToLocaleString);
}
function ArrayToLocaleString(){
var o=$toObject(this);
var ac=o.length;
return InnerArrayToLocaleString(o,ac);
}
function InnerArrayJoin(C,o,v){
if((C===(void 0))){
C=',';
}else if(!(typeof(C)==='string')){
C=$nonStringToString(C);
}
var N=%_FastOneByteArrayJoin(o,C);
if(!(N===(void 0)))return N;
if(v===1){
var u=o[0];
if((typeof(u)==='string'))return u;
if((u==null))return'';
return $nonStringToString(u);
}
return Join(o,v,C,ConvertToString);
}
function ArrayJoin(C){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.join");
var o=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var v=(o.length>>>0);
return InnerArrayJoin(C,o,v);
}
function ObservedArrayPop(ad){
ad--;
var ae=this[ad];
try{
$observeBeginPerformSplice(this);
delete this[ad];
this.length=ad;
}finally{
$observeEndPerformSplice(this);
$observeEnqueueSpliceRecord(this,ad,[ae],0);
}
return ae;
}
function ArrayPop(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.pop");
var o=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var ad=(o.length>>>0);
if(ad==0){
o.length=ad;
return;
}
if(%IsObserved(o))
return ObservedArrayPop.call(o,ad);
ad--;
var ae=o[ad];
g(o,$toName(ad),true);
o.length=ad;
return ae;
}
function ObservedArrayPush(){
var ad=(this.length>>>0);
var af=%_ArgumentsLength();
try{
$observeBeginPerformSplice(this);
for(var t=0;t<af;t++){
this[t+ad]=%_Arguments(t);
}
var ag=ad+af;
this.length=ag;
}finally{
$observeEndPerformSplice(this);
$observeEnqueueSpliceRecord(this,ad,[],af);
}
return ag;
}
function ArrayPush(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.push");
if(%IsObserved(this))
return ObservedArrayPush.apply(this,arguments);
var o=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var ad=(o.length>>>0);
var af=%_ArgumentsLength();
for(var t=0;t<af;t++){
o[t+ad]=%_Arguments(t);
}
var ag=ad+af;
o.length=ag;
return ag;
}
function ArrayConcatJS(ah){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.concat");
var o=$toObject(this);
var ai=%_ArgumentsLength();
var aj=new d(1+ai);
aj[0]=o;
for(var t=0;t<ai;t++){
aj[t+1]=%_Arguments(t);
}
return %ArrayConcat(aj);
}
function SparseReverse(o,A){
var q=GetSortedArrayKeys(o,%GetArrayKeys(o,A));
var ak=q.length-1;
var al=0;
while(al<=ak){
var t=q[al];
var am=q[ak];
var an=A-am-1;
var ao,ap;
if(an<=t){
ap=am;
while(q[--ak]==am){}
ao=an;
}
if(an>=t){
ao=t;
while(q[++al]==t){}
ap=A-t-1;
}
var aq=o[ao];
if(!(aq===(void 0))||ao in o){
var ar=o[ap];
if(!(ar===(void 0))||ap in o){
o[ao]=ar;
o[ap]=aq;
}else{
o[ap]=aq;
delete o[ao];
}
}else{
var ar=o[ap];
if(!(ar===(void 0))||ap in o){
o[ao]=ar;
delete o[ap];
}
}
}
}
function InnerArrayReverse(o,A){
var am=A-1;
for(var t=0;t<am;t++,am--){
var aq=o[t];
if(!(aq===(void 0))||t in o){
var ar=o[am];
if(!(ar===(void 0))||am in o){
o[t]=ar;
o[am]=aq;
}else{
o[am]=aq;
delete o[t];
}
}else{
var ar=o[am];
if(!(ar===(void 0))||am in o){
o[t]=ar;
delete o[am];
}
}
}
return o;
}
function ArrayReverse(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.reverse");
var o=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var A=(o.length>>>0);
if(UseSparseVariant(o,A,(%_IsArray(o)),A)){
%NormalizeElements(o);
SparseReverse(o,A);
return o;
}
return InnerArrayReverse(o,A);
}
function ObservedArrayShift(A){
var as=this[0];
try{
$observeBeginPerformSplice(this);
SimpleMove(this,0,1,A,0);
this.length=A-1;
}finally{
$observeEndPerformSplice(this);
$observeEnqueueSpliceRecord(this,0,[as],0);
}
return as;
}
function ArrayShift(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.shift");
var o=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var A=(o.length>>>0);
if(A===0){
o.length=0;
return;
}
if(k(o))throw MakeTypeError(10);
if(%IsObserved(o))
return ObservedArrayShift.call(o,A);
var as=o[0];
if(UseSparseVariant(o,A,(%_IsArray(o)),A)){
SparseMove(o,0,1,A,0);
}else{
SimpleMove(o,0,1,A,0);
}
o.length=A-1;
return as;
}
function ObservedArrayUnshift(){
var A=(this.length>>>0);
var at=%_ArgumentsLength();
try{
$observeBeginPerformSplice(this);
SimpleMove(this,0,0,A,at);
for(var t=0;t<at;t++){
this[t]=%_Arguments(t);
}
var ag=A+at;
this.length=ag;
}finally{
$observeEndPerformSplice(this);
$observeEnqueueSpliceRecord(this,0,[],at);
}
return ag;
}
function ArrayUnshift(ah){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.unshift");
if(%IsObserved(this))
return ObservedArrayUnshift.apply(this,arguments);
var o=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var A=(o.length>>>0);
var at=%_ArgumentsLength();
if(A>0&&UseSparseVariant(o,A,(%_IsArray(o)),A)&&
!k(o)){
SparseMove(o,0,0,A,at);
}else{
SimpleMove(o,0,0,A,at);
}
for(var t=0;t<at;t++){
o[t]=%_Arguments(t);
}
var ag=A+at;
o.length=ag;
return ag;
}
function ArraySlice(au,av){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.slice");
var o=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var A=(o.length>>>0);
var Q=(%_IsSmi(%IS_VAR(au))?au:%NumberToInteger($toNumber(au)));
var aw=A;
if(!(av===(void 0)))aw=(%_IsSmi(%IS_VAR(av))?av:%NumberToInteger($toNumber(av)));
if(Q<0){
Q+=A;
if(Q<0)Q=0;
}else{
if(Q>A)Q=A;
}
if(aw<0){
aw+=A;
if(aw<0)aw=0;
}else{
if(aw>A)aw=A;
}
var N=[];
if(aw<Q)return N;
if(UseSparseVariant(o,A,(%_IsArray(o)),aw-Q)){
%NormalizeElements(o);
%NormalizeElements(N);
SparseSlice(o,Q,aw-Q,A,N);
}else{
SimpleSlice(o,Q,aw-Q,A,N);
}
N.length=aw-Q;
return N;
}
function ComputeSpliceStartIndex(Q,A){
if(Q<0){
Q+=A;
return Q<0?0:Q;
}
return Q>A?A:Q;
}
function ComputeSpliceDeleteCount(ax,at,A,Q){
var R=0;
if(at==1)
return A-Q;
R=(%_IsSmi(%IS_VAR(ax))?ax:%NumberToInteger($toNumber(ax)));
if(R<0)
return 0;
if(R>A-Q)
return A-Q;
return R;
}
function ObservedArraySplice(au,ax){
var at=%_ArgumentsLength();
var A=(this.length>>>0);
var Q=ComputeSpliceStartIndex((%_IsSmi(%IS_VAR(au))?au:%NumberToInteger($toNumber(au))),A);
var R=ComputeSpliceDeleteCount(ax,at,A,
Q);
var S=[];
S.length=R;
var ay=at>2?at-2:0;
try{
$observeBeginPerformSplice(this);
SimpleSlice(this,Q,R,A,S);
SimpleMove(this,Q,R,A,ay);
var t=Q;
var az=2;
var aA=%_ArgumentsLength();
while(az<aA){
this[t++]=%_Arguments(az++);
}
this.length=A-R+ay;
}finally{
$observeEndPerformSplice(this);
if(S.length||ay){
$observeEnqueueSpliceRecord(this,
Q,
S.slice(),
ay);
}
}
return S;
}
function ArraySplice(au,ax){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.splice");
if(%IsObserved(this))
return ObservedArraySplice.apply(this,arguments);
var at=%_ArgumentsLength();
var o=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var A=(o.length>>>0);
var Q=ComputeSpliceStartIndex((%_IsSmi(%IS_VAR(au))?au:%NumberToInteger($toNumber(au))),A);
var R=ComputeSpliceDeleteCount(ax,at,A,
Q);
var S=[];
S.length=R;
var ay=at>2?at-2:0;
if(R!=ay&&k(o)){
throw MakeTypeError(10);
}else if(R>0&&j(o)){
throw MakeTypeError(9);
}
var aB=R;
if(ay!=R){
aB+=A-Q-R;
}
if(UseSparseVariant(o,A,(%_IsArray(o)),aB)){
%NormalizeElements(o);
%NormalizeElements(S);
SparseSlice(o,Q,R,A,S);
SparseMove(o,Q,R,A,ay);
}else{
SimpleSlice(o,Q,R,A,S);
SimpleMove(o,Q,R,A,ay);
}
var t=Q;
var az=2;
var aA=%_ArgumentsLength();
while(az<aA){
o[t++]=%_Arguments(az++);
}
o.length=A-R+ay;
return S;
}
function InnerArraySort(v,aC){
if(!(%_ClassOf(aC)==='Function')){
aC=function(O,aD){
if(O===aD)return 0;
if(%_IsSmi(O)&&%_IsSmi(aD)){
return %SmiLexicographicCompare(O,aD);
}
O=$toString(O);
aD=$toString(aD);
if(O==aD)return 0;
else return O<aD?-1:1;
};
}
var aE=function InsertionSort(y,m,aF){
for(var t=m+1;t<aF;t++){
var aG=y[t];
for(var am=t-1;am>=m;am--){
var aH=y[am];
var aI=%_CallFunction((void 0),aH,aG,aC);
if(aI>0){
y[am+1]=aH;
}else{
break;
}
}
y[am+1]=aG;
}
};
var aJ=function(y,m,aF){
var aK=[];
var aL=200+((aF-m)&15);
for(var t=m+1,am=0;t<aF-1;t+=aL,am++){
aK[am]=[t,y[t]];
}
%_CallFunction(aK,function(y,z){
return %_CallFunction((void 0),y[1],z[1],aC);
},ArraySort);
var aM=aK[aK.length>>1][0];
return aM;
}
var aN=function QuickSort(y,m,aF){
var aM=0;
while(true){
if(aF-m<=10){
aE(y,m,aF);
return;
}
if(aF-m>1000){
aM=aJ(y,m,aF);
}else{
aM=m+((aF-m)>>1);
}
var aO=y[m];
var aP=y[aF-1];
var aQ=y[aM];
var aR=%_CallFunction((void 0),aO,aP,aC);
if(aR>0){
var aH=aO;
aO=aP;
aP=aH;
}
var aS=%_CallFunction((void 0),aO,aQ,aC);
if(aS>=0){
var aH=aO;
aO=aQ;
aQ=aP;
aP=aH;
}else{
var aT=%_CallFunction((void 0),aP,aQ,aC);
if(aT>0){
var aH=aP;
aP=aQ;
aQ=aH;
}
}
y[m]=aO;
y[aF-1]=aQ;
var aU=aP;
var aV=m+1;
var aW=aF-1;
y[aM]=y[aV];
y[aV]=aU;
partition:for(var t=aV+1;t<aW;t++){
var aG=y[t];
var aI=%_CallFunction((void 0),aG,aU,aC);
if(aI<0){
y[t]=y[aV];
y[aV]=aG;
aV++;
}else if(aI>0){
do{
aW--;
if(aW==t)break partition;
var aX=y[aW];
aI=%_CallFunction((void 0),aX,aU,aC);
}while(aI>0);
y[t]=y[aW];
y[aW]=aG;
if(aI<0){
aG=y[t];
y[t]=y[aV];
y[aV]=aG;
aV++;
}
}
}
if(aF-aW<aV-m){
aN(y,aW,aF);
aF=aV;
}else{
aN(y,m,aV);
m=aW;
}
}
};
var aY=function CopyFromPrototype(aZ,v){
var ba=0;
for(var bb=%_GetPrototype(aZ);bb;bb=%_GetPrototype(bb)){
var p=%GetArrayKeys(bb,v);
if((typeof(p)==='number')){
var bc=p;
for(var t=0;t<bc;t++){
if(!(%_CallFunction(aZ,t,i))&&(%_CallFunction(bb,t,i))){
aZ[t]=bb[t];
if(t>=ba){ba=t+1;}
}
}
}else{
for(var t=0;t<p.length;t++){
var Y=p[t];
if(!(Y===(void 0))&&!(%_CallFunction(aZ,Y,i))
&&(%_CallFunction(bb,Y,i))){
aZ[Y]=bb[Y];
if(Y>=ba){ba=Y+1;}
}
}
}
}
return ba;
};
var bd=function(aZ,m,aF){
for(var bb=%_GetPrototype(aZ);bb;bb=%_GetPrototype(bb)){
var p=%GetArrayKeys(bb,aF);
if((typeof(p)==='number')){
var bc=p;
for(var t=m;t<bc;t++){
if((%_CallFunction(bb,t,i))){
aZ[t]=(void 0);
}
}
}else{
for(var t=0;t<p.length;t++){
var Y=p[t];
if(!(Y===(void 0))&&m<=Y&&
(%_CallFunction(bb,Y,i))){
aZ[Y]=(void 0);
}
}
}
}
};
var be=function SafeRemoveArrayHoles(aZ){
var bf=0;
var bg=v-1;
var bh=0;
while(bf<bg){
while(bf<bg&&
!(aZ[bf]===(void 0))){
bf++;
}
if(!(%_CallFunction(aZ,bf,i))){
bh++;
}
while(bf<bg&&
(aZ[bg]===(void 0))){
if(!(%_CallFunction(aZ,bg,i))){
bh++;
}
bg--;
}
if(bf<bg){
aZ[bf]=aZ[bg];
aZ[bg]=(void 0);
}
}
if(!(aZ[bf]===(void 0)))bf++;
var t;
for(t=bf;t<v-bh;t++){
aZ[t]=(void 0);
}
for(t=v-bh;t<v;t++){
if(t in %_GetPrototype(aZ)){
aZ[t]=(void 0);
}else{
delete aZ[t];
}
}
return bf;
};
if(v<2)return this;
var J=(%_IsArray(this));
var bi;
if(!J){
bi=aY(this,v);
}
var bj=%RemoveArrayHoles(this,v);
if(bj==-1){
bj=be(this);
}
aN(this,0,bj);
if(!J&&(bj+1<bi)){
bd(this,bj,bi);
}
return this;
}
function ArraySort(aC){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.sort");
var v=(this.length>>>0);
return %_CallFunction(this,v,aC,InnerArraySort);
}
function InnerArrayFilter(bk,bl,o,v){
if(!(%_ClassOf(bk)==='Function'))throw MakeTypeError(12,bk);
var bm=false;
if((bl===null)){
if(%IsSloppyModeFunction(bk))bl=(void 0);
}else if(!(bl===(void 0))){
bm=(!(%_IsSpecObject(bl))&&%IsSloppyModeFunction(bk));
}
var bn=new d();
var bo=0;
var J=(%_IsArray(o));
var bp=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bk);
for(var t=0;t<v;t++){
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(t<o.length):(t in o))){
var aG=o[t];
if(bp)%DebugPrepareStepInIfStepping(bk);
var bq=bm?$toObject(bl):bl;
if(%_CallFunction(bq,aG,t,o,bk)){
bn[bo++]=aG;
}
}
}
return bn;
}
function ArrayFilter(bk,bl){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.filter");
var o=$toObject(this);
var v=$toUint32(o.length);
var bn=InnerArrayFilter(bk,bl,o,v);
var N=new c();
%MoveArrayContents(bn,N);
return N;
}
function InnerArrayForEach(bk,bl,o,v){
if(!(%_ClassOf(bk)==='Function'))throw MakeTypeError(12,bk);
var bm=false;
if((bl===null)){
if(%IsSloppyModeFunction(bk))bl=(void 0);
}else if(!(bl===(void 0))){
bm=(!(%_IsSpecObject(bl))&&%IsSloppyModeFunction(bk));
}
var J=(%_IsArray(o));
var bp=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bk);
for(var t=0;t<v;t++){
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(t<o.length):(t in o))){
var aG=o[t];
if(bp)%DebugPrepareStepInIfStepping(bk);
var bq=bm?$toObject(bl):bl;
%_CallFunction(bq,aG,t,o,bk);
}
}
}
function ArrayForEach(bk,bl){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.forEach");
var o=$toObject(this);
var v=(o.length>>>0);
InnerArrayForEach(bk,bl,o,v);
}
function InnerArraySome(bk,bl,o,v){
if(!(%_ClassOf(bk)==='Function'))throw MakeTypeError(12,bk);
var bm=false;
if((bl===null)){
if(%IsSloppyModeFunction(bk))bl=(void 0);
}else if(!(bl===(void 0))){
bm=(!(%_IsSpecObject(bl))&&%IsSloppyModeFunction(bk));
}
var J=(%_IsArray(o));
var bp=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bk);
for(var t=0;t<v;t++){
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(t<o.length):(t in o))){
var aG=o[t];
if(bp)%DebugPrepareStepInIfStepping(bk);
var bq=bm?$toObject(bl):bl;
if(%_CallFunction(bq,aG,t,o,bk))return true;
}
}
return false;
}
function ArraySome(bk,bl){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.some");
var o=$toObject(this);
var v=(o.length>>>0);
return InnerArraySome(bk,bl,o,v);
}
function InnerArrayEvery(bk,bl,o,v){
if(!(%_ClassOf(bk)==='Function'))throw MakeTypeError(12,bk);
var bm=false;
if((bl===null)){
if(%IsSloppyModeFunction(bk))bl=(void 0);
}else if(!(bl===(void 0))){
bm=(!(%_IsSpecObject(bl))&&%IsSloppyModeFunction(bk));
}
var J=(%_IsArray(o));
var bp=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bk);
for(var t=0;t<v;t++){
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(t<o.length):(t in o))){
var aG=o[t];
if(bp)%DebugPrepareStepInIfStepping(bk);
var bq=bm?$toObject(bl):bl;
if(!%_CallFunction(bq,aG,t,o,bk))return false;
}
}
return true;
}
function ArrayEvery(bk,bl){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.every");
var o=$toObject(this);
var v=(o.length>>>0);
return InnerArrayEvery(bk,bl,o,v);
}
function InnerArrayMap(bk,bl,o,v){
if(!(%_ClassOf(bk)==='Function'))throw MakeTypeError(12,bk);
var bm=false;
if((bl===null)){
if(%IsSloppyModeFunction(bk))bl=(void 0);
}else if(!(bl===(void 0))){
bm=(!(%_IsSpecObject(bl))&&%IsSloppyModeFunction(bk));
}
var bn=new d(v);
var J=(%_IsArray(o));
var bp=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bk);
for(var t=0;t<v;t++){
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(t<o.length):(t in o))){
var aG=o[t];
if(bp)%DebugPrepareStepInIfStepping(bk);
var bq=bm?$toObject(bl):bl;
bn[t]=%_CallFunction(bq,aG,t,o,bk);
}
}
return bn;
}
function ArrayMap(bk,bl){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.map");
var o=$toObject(this);
var v=(o.length>>>0);
var bn=InnerArrayMap(bk,bl,o,v);
var N=new c();
%MoveArrayContents(bn,N);
return N;
}
function InnerArrayIndexOf(aG,Y,v){
if(v==0)return-1;
if((Y===(void 0))){
Y=0;
}else{
Y=(%_IsSmi(%IS_VAR(Y))?Y:%NumberToInteger($toNumber(Y)));
if(Y<0){
Y=v+Y;
if(Y<0)Y=0;
}
}
var br=Y;
var ba=v;
if(UseSparseVariant(this,v,(%_IsArray(this)),ba-br)){
%NormalizeElements(this);
var p=%GetArrayKeys(this,v);
if((typeof(p)==='number')){
ba=p;
}else{
if(p.length==0)return-1;
var bs=GetSortedArrayKeys(this,p);
var ad=bs.length;
var t=0;
while(t<ad&&bs[t]<Y)t++;
while(t<ad){
var x=bs[t];
if(!(x===(void 0))&&this[x]===aG)return x;
t++;
}
return-1;
}
}
if(!(aG===(void 0))){
for(var t=br;t<ba;t++){
if(this[t]===aG)return t;
}
return-1;
}
for(var t=br;t<ba;t++){
if((this[t]===(void 0))&&t in this){
return t;
}
}
return-1;
}
function ArrayIndexOf(aG,Y){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.indexOf");
var v=(this.length>>>0);
return %_CallFunction(this,aG,Y,v,InnerArrayIndexOf);
}
function InnerArrayLastIndexOf(aG,Y,v,bt){
if(v==0)return-1;
if(bt<2){
Y=v-1;
}else{
Y=(%_IsSmi(%IS_VAR(Y))?Y:%NumberToInteger($toNumber(Y)));
if(Y<0)Y+=v;
if(Y<0)return-1;
else if(Y>=v)Y=v-1;
}
var br=0;
var ba=Y;
if(UseSparseVariant(this,v,(%_IsArray(this)),Y)){
%NormalizeElements(this);
var p=%GetArrayKeys(this,Y+1);
if((typeof(p)==='number')){
ba=p;
}else{
if(p.length==0)return-1;
var bs=GetSortedArrayKeys(this,p);
var t=bs.length-1;
while(t>=0){
var x=bs[t];
if(!(x===(void 0))&&this[x]===aG)return x;
t--;
}
return-1;
}
}
if(!(aG===(void 0))){
for(var t=ba;t>=br;t--){
if(this[t]===aG)return t;
}
return-1;
}
for(var t=ba;t>=br;t--){
if((this[t]===(void 0))&&t in this){
return t;
}
}
return-1;
}
function ArrayLastIndexOf(aG,Y){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.lastIndexOf");
var v=(this.length>>>0);
return %_CallFunction(this,aG,Y,v,
%_ArgumentsLength(),InnerArrayLastIndexOf);
}
function InnerArrayReduce(bu,T,o,v,bt){
if(!(%_ClassOf(bu)==='Function')){
throw MakeTypeError(12,bu);
}
var J=(%_IsArray(o));
var t=0;
find_initial:if(bt<2){
for(;t<v;t++){
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(t<o.length):(t in o))){
T=o[t++];
break find_initial;
}
}
throw MakeTypeError(92);
}
var bp=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bu);
for(;t<v;t++){
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(t<o.length):(t in o))){
var aG=o[t];
if(bp)%DebugPrepareStepInIfStepping(bu);
T=%_CallFunction((void 0),T,aG,t,o,bu);
}
}
return T;
}
function ArrayReduce(bu,T){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.reduce");
var o=$toObject(this);
var v=$toUint32(o.length);
return InnerArrayReduce(bu,T,o,v,
%_ArgumentsLength());
}
function InnerArrayReduceRight(bu,T,o,v,
bt){
if(!(%_ClassOf(bu)==='Function')){
throw MakeTypeError(12,bu);
}
var J=(%_IsArray(o));
var t=v-1;
find_initial:if(bt<2){
for(;t>=0;t--){
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(t<o.length):(t in o))){
T=o[t--];
break find_initial;
}
}
throw MakeTypeError(92);
}
var bp=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(bu);
for(;t>=0;t--){
if(((J&&%_HasFastPackedElements(%IS_VAR(o)))?(t<o.length):(t in o))){
var aG=o[t];
if(bp)%DebugPrepareStepInIfStepping(bu);
T=%_CallFunction((void 0),T,aG,t,o,bu);
}
}
return T;
}
function ArrayReduceRight(bu,T){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.reduceRight");
var o=$toObject(this);
var v=$toUint32(o.length);
return InnerArrayReduceRight(bu,T,o,v,
%_ArgumentsLength());
}
function ArrayIsArray(aZ){
return(%_IsArray(aZ));
}
%AddNamedProperty(c.prototype,"constructor",c,
2);
var bv={
__proto__:null,
copyWithin:true,
entries:true,
fill:true,
find:true,
findIndex:true,
keys:true,
};
%AddNamedProperty(c.prototype,symbolUnscopables,bv,
2|1);
b.InstallFunctions(c,2,[
"isArray",ArrayIsArray
]);
var bw=%SpecialArrayFunctions();
var bx=function(by,bz,A){
var bk=bz;
if(bw.hasOwnProperty(by)){
bk=bw[by];
}
if(!(A===(void 0))){
%FunctionSetLength(bk,A);
}
return bk;
};
b.InstallFunctions(c.prototype,2,[
"toString",bx("toString",ArrayToString),
"toLocaleString",bx("toLocaleString",ArrayToLocaleString),
"join",bx("join",ArrayJoin),
"pop",bx("pop",ArrayPop),
"push",bx("push",ArrayPush,1),
"concat",bx("concat",ArrayConcatJS,1),
"reverse",bx("reverse",ArrayReverse),
"shift",bx("shift",ArrayShift),
"unshift",bx("unshift",ArrayUnshift,1),
"slice",bx("slice",ArraySlice,2),
"splice",bx("splice",ArraySplice,2),
"sort",bx("sort",ArraySort),
"filter",bx("filter",ArrayFilter,1),
"forEach",bx("forEach",ArrayForEach,1),
"some",bx("some",ArraySome,1),
"every",bx("every",ArrayEvery,1),
"map",bx("map",ArrayMap,1),
"indexOf",bx("indexOf",ArrayIndexOf,1),
"lastIndexOf",bx("lastIndexOf",ArrayLastIndexOf,1),
"reduce",bx("reduce",ArrayReduce,1),
"reduceRight",bx("reduceRight",ArrayReduceRight,1)
]);
%FinishArrayPrototypeSetup(c.prototype);
b.SetUpLockedPrototype(d,c(),[
"concat",bx("concat",ArrayConcatJS),
"indexOf",bx("indexOf",ArrayIndexOf),
"join",bx("join",ArrayJoin),
"pop",bx("pop",ArrayPop),
"push",bx("push",ArrayPush),
"shift",bx("shift",ArrayShift),
"splice",bx("splice",ArraySplice)
]);
b.SetUpLockedPrototype(e,c(),[
"join",bx("join",ArrayJoin),
"pop",bx("pop",ArrayPop),
"push",bx("push",ArrayPush),
"shift",bx("shift",ArrayShift)
]);
b.Export(function(aF){
aF.ArrayJoin=ArrayJoin;
aF.ArrayToString=ArrayToString;
aF.InnerArrayEvery=InnerArrayEvery;
aF.InnerArrayFilter=InnerArrayFilter;
aF.InnerArrayForEach=InnerArrayForEach;
aF.InnerArrayIndexOf=InnerArrayIndexOf;
aF.InnerArrayJoin=InnerArrayJoin;
aF.InnerArrayLastIndexOf=InnerArrayLastIndexOf;
aF.InnerArrayMap=InnerArrayMap;
aF.InnerArrayReduce=InnerArrayReduce;
aF.InnerArrayReduceRight=InnerArrayReduceRight;
aF.InnerArrayReverse=InnerArrayReverse;
aF.InnerArraySome=InnerArraySome;
aF.InnerArraySort=InnerArraySort;
aF.InnerArrayToLocaleString=InnerArrayToLocaleString;
});
$arrayConcat=ArrayConcatJS;
$arrayPush=ArrayPush;
$arrayPop=ArrayPop;
$arrayShift=ArrayShift;
$arraySlice=ArraySlice;
$arraySplice=ArraySplice;
$arrayUnshift=ArrayUnshift;
});

stringú@
(function(a,b){
%CheckIsBootstrapping();
var c=a.RegExp;
var d=a.String;
var e=b.InternalArray;
var g=b.InternalPackedArray;
var h;
var i;
var j;
var k;
var l;
b.Import(function(m){
h=m.MathMax;
i=m.MathMin;
j=m.RegExpExec;
k=m.RegExpExecNoTests;
l=m.RegExpLastMatchInfo;
});
function StringConstructor(n){
if(%_ArgumentsLength()==0)n='';
if(%_IsConstructCall()){
%_SetValueOf(this,((typeof(%IS_VAR(n))==='string')?n:$nonStringToString(n)));
}else{
return(typeof(n)==='symbol')?
%_CallFunction(n,$symbolToString):((typeof(%IS_VAR(n))==='string')?n:$nonStringToString(n));
}
}
function StringToString(){
if(!(typeof(this)==='string')&&!(%_ClassOf(this)==='String')){
throw MakeTypeError(55,'String.prototype.toString');
}
return %_ValueOf(this);
}
function StringValueOf(){
if(!(typeof(this)==='string')&&!(%_ClassOf(this)==='String')){
throw MakeTypeError(55,'String.prototype.valueOf');
}
return %_ValueOf(this);
}
function StringCharAtJS(o){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.charAt");
var p=%_StringCharAt(this,o);
if(%_IsSmi(p)){
p=%_StringCharAt(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o))));
}
return p;
}
function StringCharCodeAtJS(o){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.charCodeAt");
var p=%_StringCharCodeAt(this,o);
if(!%_IsSmi(p)){
p=%_StringCharCodeAt(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o))));
}
return p;
}
function StringConcat(q){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.concat");
var r=%_ArgumentsLength();
var t=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if(r===1){
return t+((typeof(%IS_VAR(q))==='string')?q:$nonStringToString(q));
}
var u=new e(r+1);
u[0]=t;
for(var v=0;v<r;v++){
var w=%_Arguments(v);
u[v+1]=((typeof(%IS_VAR(w))==='string')?w:$nonStringToString(w));
}
return %StringBuilderConcat(u,r+1,"");
}
function StringIndexOfJS(x){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.indexOf");
var y=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
x=((typeof(%IS_VAR(x))==='string')?x:$nonStringToString(x));
var z=0;
if(%_ArgumentsLength()>1){
z=%_Arguments(1);
z=(%_IsSmi(%IS_VAR(z))?z:%NumberToInteger($toNumber(z)));
if(z<0)z=0;
if(z>y.length)z=y.length;
}
return %StringIndexOf(y,x,z);
}
function StringLastIndexOfJS(A){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.lastIndexOf");
var B=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var C=B.length;
var A=((typeof(%IS_VAR(A))==='string')?A:$nonStringToString(A));
var D=A.length;
var z=C-D;
if(%_ArgumentsLength()>1){
var E=$toNumber(%_Arguments(1));
if(!(!%_IsSmi(%IS_VAR(E))&&!(E==E))){
E=(%_IsSmi(%IS_VAR(E))?E:%NumberToInteger($toNumber(E)));
if(E<0){
E=0;
}
if(E+D<C){
z=E;
}
}
}
if(z<0){
return-1;
}
return %StringLastIndexOf(B,A,z);
}
function StringLocaleCompareJS(q){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.localeCompare");
return %StringLocaleCompare(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),
((typeof(%IS_VAR(q))==='string')?q:$nonStringToString(q)));
}
function StringMatchJS(F){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.match");
var y=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(F))){
var G=F.lastIndex;
(%_IsSmi(%IS_VAR(G))?G:$toNumber(G));
if(!F.global)return k(F,y,0);
var p=%StringMatch(y,F,l);
if(p!==null)$regexpLastMatchInfoOverride=null;
F.lastIndex=0;
return p;
}
F=new c(F);
return k(F,y,0);
}
function StringNormalizeJS(H){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.normalize");
var H=H?((typeof(%IS_VAR(H))==='string')?H:$nonStringToString(H)):'NFC';
var I=['NFC','NFD','NFKC','NFKD'];
var J=I.indexOf(H);
if(J===-1){
throw MakeRangeError(142,I.join(', '));
}
return %_ValueOf(this);
}
var K=[2,"","",-1,-1];
function StringReplace(L,M){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.replace");
var y=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(L))){
var G=L.lastIndex;
(%_IsSmi(%IS_VAR(G))?G:$toNumber(G));
if(!(%_ClassOf(M)==='Function')){
M=((typeof(%IS_VAR(M))==='string')?M:$nonStringToString(M));
if(!L.global){
var N=j(L,y,0);
if(N==null){
L.lastIndex=0
return y;
}
if(M.length==0){
return %_SubString(y,0,N[3])+
%_SubString(y,N[4],y.length)
}
return ExpandReplacement(M,y,l,
%_SubString(y,0,N[3]))+
%_SubString(y,N[4],y.length);
}
L.lastIndex=0;
if($regexpLastMatchInfoOverride==null){
return %StringReplaceGlobalRegExpWithString(
y,L,M,l);
}else{
var O=l[1];
l[1]=0;
var P=%StringReplaceGlobalRegExpWithString(
y,L,M,l);
if(%_IsSmi(l[1])){
l[1]=O;
}else{
$regexpLastMatchInfoOverride=null;
}
return P;
}
}
if(L.global){
return StringReplaceGlobalRegExpWithFunction(y,L,M);
}
return StringReplaceNonGlobalRegExpWithFunction(y,L,M);
}
L=((typeof(%IS_VAR(L))==='string')?L:$nonStringToString(L));
if(L.length==1&&
y.length>0xFF&&
(typeof(M)==='string')&&
%StringIndexOf(M,'$',0)<0){
return %StringReplaceOneCharWithString(y,L,M);
}
var Q=%StringIndexOf(y,L,0);
if(Q<0)return y;
var R=Q+L.length;
var p=%_SubString(y,0,Q);
if((%_ClassOf(M)==='Function')){
var S=(void 0);
p+=%_CallFunction(S,L,Q,y,M);
}else{
K[3]=Q;
K[4]=R;
p=ExpandReplacement(((typeof(%IS_VAR(M))==='string')?M:$nonStringToString(M)),
y,
K,
p);
}
return p+%_SubString(y,R,y.length);
}
function ExpandReplacement(T,y,U,p){
var V=T.length;
var W=%StringIndexOf(T,'$',0);
if(W<0){
if(V>0)p+=T;
return p;
}
if(W>0)p+=%_SubString(T,0,W);
while(true){
var X='$';
var E=W+1;
if(E<V){
var Y=%_StringCharCodeAt(T,E);
if(Y==36){
++E;
p+='$';
}else if(Y==38){
++E;
p+=
%_SubString(y,U[3],U[4]);
}else if(Y==96){
++E;
p+=%_SubString(y,0,U[3]);
}else if(Y==39){
++E;
p+=%_SubString(y,U[4],y.length);
}else if(Y>=48&&Y<=57){
var Z=(Y-48)<<1;
var aa=1;
var ab=((U)[0]);
if(E+1<T.length){
var W=%_StringCharCodeAt(T,E+1);
if(W>=48&&W<=57){
var ac=Z*10+((W-48)<<1);
if(ac<ab){
Z=ac;
aa=2;
}
}
}
if(Z!=0&&Z<ab){
var Q=U[(3+(Z))];
if(Q>=0){
p+=
%_SubString(y,Q,U[(3+(Z+1))]);
}
E+=aa;
}else{
p+='$';
}
}else{
p+='$';
}
}else{
p+='$';
}
W=%StringIndexOf(T,'$',E);
if(W<0){
if(E<V){
p+=%_SubString(T,E,V);
}
return p;
}
if(W>E){
p+=%_SubString(T,E,W);
}
}
return p;
}
function CaptureString(T,ad,z){
var ae=z<<1;
var Q=ad[(3+(ae))];
if(Q<0)return;
var R=ad[(3+(ae+1))];
return %_SubString(T,Q,R);
}
var af=new e(4);
function StringReplaceGlobalRegExpWithFunction(y,F,M){
var ag=af;
if(ag){
af=null;
}else{
ag=new e(16);
}
var ah=%RegExpExecMultiple(F,
y,
l,
ag);
F.lastIndex=0;
if((ah===null)){
af=ag;
return y;
}
var r=ah.length;
if(((l)[0])==2){
var ai=0;
var aj=new g(null,0,y);
for(var v=0;v<r;v++){
var ak=ah[v];
if(%_IsSmi(ak)){
if(ak>0){
ai=(ak>>11)+(ak&0x7ff);
}else{
ai=ah[++v]-ak;
}
}else{
aj[0]=ak;
aj[1]=ai;
$regexpLastMatchInfoOverride=aj;
var al=
%_CallFunction((void 0),ak,ai,y,M);
ah[v]=((typeof(%IS_VAR(al))==='string')?al:$nonStringToString(al));
ai+=ak.length;
}
}
}else{
for(var v=0;v<r;v++){
var ak=ah[v];
if(!%_IsSmi(ak)){
$regexpLastMatchInfoOverride=ak;
var al=%Apply(M,(void 0),ak,0,ak.length);
ah[v]=((typeof(%IS_VAR(al))==='string')?al:$nonStringToString(al));
}
}
}
var p=%StringBuilderConcat(ah,ah.length,y);
ag.length=0;
af=ag;
return p;
}
function StringReplaceNonGlobalRegExpWithFunction(y,F,M){
var U=j(F,y,0);
if((U===null)){
F.lastIndex=0;
return y;
}
var z=U[3];
var p=%_SubString(y,0,z);
var am=U[4];
var an=((U)[0])>>1;
var ao;
if(an==1){
var ap=%_SubString(y,z,am);
ao=%_CallFunction((void 0),ap,z,y,M);
}else{
var aq=new e(an+2);
for(var ar=0;ar<an;ar++){
aq[ar]=CaptureString(y,U,ar);
}
aq[ar]=z;
aq[ar+1]=y;
ao=%Apply(M,(void 0),aq,0,ar+2);
}
p+=ao;
return p+%_SubString(y,am,y.length);
}
function StringSearch(as){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.search");
var F;
if((typeof(as)==='string')){
F=%_GetFromCache(0,as);
}else if((%_IsRegExp(as))){
F=as;
}else{
F=new c(as);
}
var N=j(F,((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),0);
if(N){
return N[3];
}
return-1;
}
function StringSlice(Q,R){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.slice");
var ap=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var at=ap.length;
var au=(%_IsSmi(%IS_VAR(Q))?Q:%NumberToInteger($toNumber(Q)));
var av=at;
if(!(R===(void 0))){
av=(%_IsSmi(%IS_VAR(R))?R:%NumberToInteger($toNumber(R)));
}
if(au<0){
au+=at;
if(au<0){
au=0;
}
}else{
if(au>at){
return'';
}
}
if(av<0){
av+=at;
if(av<0){
return'';
}
}else{
if(av>at){
av=at;
}
}
if(av<=au){
return'';
}
return %_SubString(ap,au,av);
}
function StringSplitJS(aw,ax){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.split");
var y=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
ax=((ax===(void 0)))?0xffffffff:(ax>>>0);
var V=y.length;
if(!(%_IsRegExp(aw))){
var ay=((typeof(%IS_VAR(aw))==='string')?aw:$nonStringToString(aw));
if(ax===0)return[];
if((aw===(void 0)))return[y];
var az=ay.length;
if(az===0)return %StringToArray(y,ax);
var p=%StringSplit(y,ay,ax);
return p;
}
if(ax===0)return[];
return StringSplitOnRegExp(y,aw,ax,V);
}
function StringSplitOnRegExp(y,aw,ax,V){
if(V===0){
if(j(aw,y,0,0)!=null){
return[];
}
return[y];
}
var aA=0;
var aB=0;
var aC=0;
var p=new e();
outer_loop:
while(true){
if(aB===V){
p[p.length]=%_SubString(y,aA,V);
break;
}
var U=j(aw,y,aB);
if(U==null||V===(aC=U[3])){
p[p.length]=%_SubString(y,aA,V);
break;
}
var aD=U[4];
if(aB===aD&&aD===aA){
aB++;
continue;
}
p[p.length]=%_SubString(y,aA,aC);
if(p.length===ax)break;
var aE=((U)[0])+3;
for(var v=3+2;v<aE;){
var Q=U[v++];
var R=U[v++];
if(R!=-1){
p[p.length]=%_SubString(y,Q,R);
}else{
p[p.length]=(void 0);
}
if(p.length===ax)break outer_loop;
}
aB=aA=aD;
}
var aF=[];
%MoveArrayContents(p,aF);
return aF;
}
function StringSubstring(Q,R){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.subString");
var ap=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var at=ap.length;
var au=(%_IsSmi(%IS_VAR(Q))?Q:%NumberToInteger($toNumber(Q)));
if(au<0){
au=0;
}else if(au>at){
au=at;
}
var av=at;
if(!(R===(void 0))){
av=(%_IsSmi(%IS_VAR(R))?R:%NumberToInteger($toNumber(R)));
if(av>at){
av=at;
}else{
if(av<0)av=0;
if(au>av){
var aG=av;
av=au;
au=aG;
}
}
}
return %_SubString(ap,au,av);
}
function StringSubstr(Q,aH){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.substr");
var ap=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var r;
if((aH===(void 0))){
r=ap.length;
}else{
r=(%_IsSmi(%IS_VAR(aH))?aH:%NumberToInteger($toNumber(aH)));
if(r<=0)return'';
}
if((Q===(void 0))){
Q=0;
}else{
Q=(%_IsSmi(%IS_VAR(Q))?Q:%NumberToInteger($toNumber(Q)));
if(Q>=ap.length)return'';
if(Q<0){
Q+=ap.length;
if(Q<0)Q=0;
}
}
var R=Q+r;
if(R>ap.length)R=ap.length;
return %_SubString(ap,Q,R);
}
function StringToLowerCaseJS(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.toLowerCase");
return %StringToLowerCase(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)));
}
function StringToLocaleLowerCase(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.toLocaleLowerCase");
return %StringToLowerCase(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)));
}
function StringToUpperCaseJS(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.toUpperCase");
return %StringToUpperCase(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)));
}
function StringToLocaleUpperCase(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.toLocaleUpperCase");
return %StringToUpperCase(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)));
}
function StringTrimJS(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.trim");
return %StringTrim(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),true,true);
}
function StringTrimLeft(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.trimLeft");
return %StringTrim(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),true,false);
}
function StringTrimRight(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.trimRight");
return %StringTrim(((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this)),false,true);
}
function StringFromCharCode(aI){
var aH=%_ArgumentsLength();
if(aH==1){
if(!%_IsSmi(aI))aI=$toNumber(aI);
return %_StringCharFromCode(aI&0xffff);
}
var aJ=%NewString(aH,true);
var v;
for(v=0;v<aH;v++){
var aI=%_Arguments(v);
if(!%_IsSmi(aI))aI=$toNumber(aI)&0xffff;
if(aI<0)aI=aI&0xffff;
if(aI>0xff)break;
%_OneByteSeqStringSetChar(v,aI,aJ);
}
if(v==aH)return aJ;
aJ=%TruncateString(aJ,v);
var aK=%NewString(aH-v,false);
for(var ar=0;v<aH;v++,ar++){
var aI=%_Arguments(v);
if(!%_IsSmi(aI))aI=$toNumber(aI)&0xffff;
%_TwoByteSeqStringSetChar(ar,aI,aK);
}
return aJ+aK;
}
function HtmlEscape(aL){
return((typeof(%IS_VAR(aL))==='string')?aL:$nonStringToString(aL)).replace(/"/g,"&quot;");
}
function StringAnchor(aM){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.anchor");
return"<a name=\""+HtmlEscape(aM)+"\">"+this+"</a>";
}
function StringBig(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.big");
return"<big>"+this+"</big>";
}
function StringBlink(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.blink");
return"<blink>"+this+"</blink>";
}
function StringBold(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.bold");
return"<b>"+this+"</b>";
}
function StringFixed(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.fixed");
return"<tt>"+this+"</tt>";
}
function StringFontcolor(aN){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.fontcolor");
return"<font color=\""+HtmlEscape(aN)+"\">"+this+"</font>";
}
function StringFontsize(aO){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.fontsize");
return"<font size=\""+HtmlEscape(aO)+"\">"+this+"</font>";
}
function StringItalics(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.italics");
return"<i>"+this+"</i>";
}
function StringLink(ap){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.link");
return"<a href=\""+HtmlEscape(ap)+"\">"+this+"</a>";
}
function StringSmall(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.small");
return"<small>"+this+"</small>";
}
function StringStrike(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.strike");
return"<strike>"+this+"</strike>";
}
function StringSub(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.sub");
return"<sub>"+this+"</sub>";
}
function StringSup(){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.sup");
return"<sup>"+this+"</sup>";
}
function StringRepeat(aP){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.repeat");
var ap=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var aH=$toInteger(aP);
if(aH<0||aH>%_MaxSmi())throw MakeRangeError(128);
var aQ="";
while(true){
if(aH&1)aQ+=ap;
aH>>=1;
if(aH===0)return aQ;
ap+=ap;
}
}
function StringStartsWith(aR){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.startsWith");
var ap=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(aR))){
throw MakeTypeError(28,"String.prototype.startsWith");
}
var aS=((typeof(%IS_VAR(aR))==='string')?aR:$nonStringToString(aR));
var o=0;
if(%_ArgumentsLength()>1){
o=%_Arguments(1);
o=$toInteger(o);
}
var at=ap.length;
var Q=i(h(o,0),at);
var aT=aS.length;
if(aT+Q>at){
return false;
}
return %StringIndexOf(ap,aS,Q)===Q;
}
function StringEndsWith(aR){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.endsWith");
var ap=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(aR))){
throw MakeTypeError(28,"String.prototype.endsWith");
}
var aS=((typeof(%IS_VAR(aR))==='string')?aR:$nonStringToString(aR));
var at=ap.length;
var o=at;
if(%_ArgumentsLength()>1){
var aU=%_Arguments(1);
if(!(aU===(void 0))){
o=$toInteger(aU);
}
}
var R=i(h(o,0),at);
var aT=aS.length;
var Q=R-aT;
if(Q<0){
return false;
}
return %StringLastIndexOf(ap,aS,Q)===Q;
}
function StringIncludes(aR){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.includes");
var ap=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
if((%_IsRegExp(aR))){
throw MakeTypeError(28,"String.prototype.includes");
}
var aS=((typeof(%IS_VAR(aR))==='string')?aR:$nonStringToString(aR));
var o=0;
if(%_ArgumentsLength()>1){
o=%_Arguments(1);
o=$toInteger(o);
}
var at=ap.length;
var Q=i(h(o,0),at);
var aT=aS.length;
if(aT+Q>at){
return false;
}
return %StringIndexOf(ap,aS,Q)!==-1;
}
function StringCodePointAt(o){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.codePointAt");
var T=((typeof(%IS_VAR(this))==='string')?this:$nonStringToString(this));
var aO=T.length;
o=(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o)));
if(o<0||o>=aO){
return(void 0);
}
var aV=%_StringCharCodeAt(T,o);
if(aV<0xD800||aV>0xDBFF||o+1==aO){
return aV;
}
var aW=%_StringCharCodeAt(T,o+1);
if(aW<0xDC00||aW>0xDFFF){
return aV;
}
return(aV-0xD800)*0x400+aW+0x2400;
}
function StringFromCodePoint(aX){
var aI;
var V=%_ArgumentsLength();
var z;
var p="";
for(z=0;z<V;z++){
aI=%_Arguments(z);
if(!%_IsSmi(aI)){
aI=$toNumber(aI);
}
if(aI<0||aI>0x10FFFF||aI!==(%_IsSmi(%IS_VAR(aI))?aI:%NumberToInteger($toNumber(aI)))){
throw MakeRangeError(127,aI);
}
if(aI<=0xFFFF){
p+=%_StringCharFromCode(aI);
}else{
aI-=0x10000;
p+=%_StringCharFromCode((aI>>>10)&0x3FF|0xD800);
p+=%_StringCharFromCode(aI&0x3FF|0xDC00);
}
}
return p;
}
function StringRaw(aY){
var aZ=%_ArgumentsLength();
var ba=$toObject(aY);
var bb=$toObject(ba.raw);
var bc=$toLength(bb.length);
if(bc<=0)return"";
var p=$toString(bb[0]);
for(var v=1;v<bc;++v){
if(v<aZ){
p+=$toString(%_Arguments(v));
}
p+=$toString(bb[v]);
}
return p;
}
%SetCode(d,StringConstructor);
%FunctionSetPrototype(d,new d());
%AddNamedProperty(
d.prototype,"constructor",d,2);
b.InstallFunctions(d,2,[
"fromCharCode",StringFromCharCode,
"fromCodePoint",StringFromCodePoint,
"raw",StringRaw
]);
b.InstallFunctions(d.prototype,2,[
"valueOf",StringValueOf,
"toString",StringToString,
"charAt",StringCharAtJS,
"charCodeAt",StringCharCodeAtJS,
"codePointAt",StringCodePointAt,
"concat",StringConcat,
"endsWith",StringEndsWith,
"includes",StringIncludes,
"indexOf",StringIndexOfJS,
"lastIndexOf",StringLastIndexOfJS,
"localeCompare",StringLocaleCompareJS,
"match",StringMatchJS,
"normalize",StringNormalizeJS,
"repeat",StringRepeat,
"replace",StringReplace,
"search",StringSearch,
"slice",StringSlice,
"split",StringSplitJS,
"substring",StringSubstring,
"substr",StringSubstr,
"startsWith",StringStartsWith,
"toLowerCase",StringToLowerCaseJS,
"toLocaleLowerCase",StringToLocaleLowerCase,
"toUpperCase",StringToUpperCaseJS,
"toLocaleUpperCase",StringToLocaleUpperCase,
"trim",StringTrimJS,
"trimLeft",StringTrimLeft,
"trimRight",StringTrimRight,
"link",StringLink,
"anchor",StringAnchor,
"fontcolor",StringFontcolor,
"fontsize",StringFontsize,
"big",StringBig,
"blink",StringBlink,
"bold",StringBold,
"fixed",StringFixed,
"italics",StringItalics,
"small",StringSmall,
"strike",StringStrike,
"sub",StringSub,
"sup",StringSup
]);
b.Export(function(bd){
bd.StringCharAt=StringCharAtJS;
bd.StringIndexOf=StringIndexOfJS;
bd.StringSubstring=StringSubstring;
});
})

uriW
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Object;
var d=a.Array;
var e=b.InternalArray;
function HexValueOf(g){
if(g>=48&&g<=57)return g-48;
if(g>=65&&g<=70)return g-55;
if(g>=97&&g<=102)return g-87;
return-1;
}
function isAlphaNumeric(h){
if(97<=h&&h<=122)return true;
if(65<=h&&h<=90)return true;
if(48<=h&&h<=57)return true;
return false;
}
var i=0;
function URIAddEncodedOctetToBuffer(j,k,l){
k[l++]=37;
k[l++]=i[j>>4];
k[l++]=i[j&0x0F];
return l;
}
function URIEncodeOctets(m,k,l){
if(i===0){
i=[48,49,50,51,52,53,54,55,56,57,
65,66,67,68,69,70];
}
l=URIAddEncodedOctetToBuffer(m[0],k,l);
if(m[1])l=URIAddEncodedOctetToBuffer(m[1],k,l);
if(m[2])l=URIAddEncodedOctetToBuffer(m[2],k,l);
if(m[3])l=URIAddEncodedOctetToBuffer(m[3],k,l);
return l;
}
function URIEncodeSingle(h,k,l){
var n=(h>>12)&0xF;
var o=(h>>6)&63;
var p=h&63;
var m=new d(3);
if(h<=0x007F){
m[0]=h;
}else if(h<=0x07FF){
m[0]=o+192;
m[1]=p+128;
}else{
m[0]=n+224;
m[1]=o+128;
m[2]=p+128;
}
return URIEncodeOctets(m,k,l);
}
function URIEncodePair(q,r,k,l){
var t=((q>>6)&0xF)+1;
var u=(q>>2)&0xF;
var n=q&3;
var o=(r>>6)&0xF;
var p=r&63;
var m=new d(4);
m[0]=(t>>2)+240;
m[1]=(((t&3)<<4)|u)+128;
m[2]=((n<<4)|o)+128;
m[3]=p+128;
return URIEncodeOctets(m,k,l);
}
function URIHexCharsToCharCode(v,w){
var x=HexValueOf(v);
var y=HexValueOf(w);
if(x==-1||y==-1)throw MakeURIError();
return(x<<4)|y;
}
function URIDecodeOctets(m,k,l){
var z;
var A=m[0];
if(A<0x80){
z=A;
}else if(A<0xc2){
throw MakeURIError();
}else{
var B=m[1];
if(A<0xe0){
var C=A&0x1f;
if((B<0x80)||(B>0xbf))throw MakeURIError();
var D=B&0x3f;
z=(C<<6)+D;
if(z<0x80||z>0x7ff)throw MakeURIError();
}else{
var E=m[2];
if(A<0xf0){
var C=A&0x0f;
if((B<0x80)||(B>0xbf))throw MakeURIError();
var D=B&0x3f;
if((E<0x80)||(E>0xbf))throw MakeURIError();
var F=E&0x3f;
z=(C<<12)+(D<<6)+F;
if((z<0x800)||(z>0xffff))throw MakeURIError();
}else{
var G=m[3];
if(A<0xf8){
var C=(A&0x07);
if((B<0x80)||(B>0xbf))throw MakeURIError();
var D=(B&0x3f);
if((E<0x80)||(E>0xbf)){
throw MakeURIError();
}
var F=(E&0x3f);
if((G<0x80)||(G>0xbf))throw MakeURIError();
var H=(G&0x3f);
z=(C<<18)+(D<<12)+(F<<6)+H;
if((z<0x10000)||(z>0x10ffff))throw MakeURIError();
}else{
throw MakeURIError();
}
}
}
}
if(0xD800<=z&&z<=0xDFFF)throw MakeURIError();
if(z<0x10000){
%_TwoByteSeqStringSetChar(l++,z,k);
}else{
%_TwoByteSeqStringSetChar(l++,(z>>10)+0xd7c0,k);
%_TwoByteSeqStringSetChar(l++,(z&0x3ff)+0xdc00,k);
}
return l;
}
function Encode(I,J){
var K=I.length;
var L=new e(K);
var l=0;
for(var M=0;M<K;M++){
var q=I.charCodeAt(M);
if(J(q)){
L[l++]=q;
}else{
if(q>=0xDC00&&q<=0xDFFF)throw MakeURIError();
if(q<0xD800||q>0xDBFF){
l=URIEncodeSingle(q,L,l);
}else{
M++;
if(M==K)throw MakeURIError();
var r=I.charCodeAt(M);
if(r<0xDC00||r>0xDFFF)throw MakeURIError();
l=URIEncodePair(q,r,L,l);
}
}
}
var k=%NewString(L.length,true);
for(var N=0;N<L.length;N++){
%_OneByteSeqStringSetChar(N,L[N],k);
}
return k;
}
function Decode(I,O){
var K=I.length;
var P=%NewString(K,true);
var l=0;
var M=0;
for(;M<K;M++){
var g=I.charCodeAt(M);
if(g==37){
if(M+2>=K)throw MakeURIError();
var h=URIHexCharsToCharCode(I.charCodeAt(M+1),I.charCodeAt(M+2));
if(h>>7)break;
if(O(h)){
%_OneByteSeqStringSetChar(l++,37,P);
%_OneByteSeqStringSetChar(l++,I.charCodeAt(M+1),P);
%_OneByteSeqStringSetChar(l++,I.charCodeAt(M+2),P);
}else{
%_OneByteSeqStringSetChar(l++,h,P);
}
M+=2;
}else{
if(g>0x7f)break;
%_OneByteSeqStringSetChar(l++,g,P);
}
}
P=%TruncateString(P,l);
if(M==K)return P;
var Q=%NewString(K-M,false);
l=0;
for(;M<K;M++){
var g=I.charCodeAt(M);
if(g==37){
if(M+2>=K)throw MakeURIError();
var h=URIHexCharsToCharCode(I.charCodeAt(++M),I.charCodeAt(++M));
if(h>>7){
var R=0;
while(((h<<++R)&0x80)!=0){}
if(R==1||R>4)throw MakeURIError();
var m=new d(R);
m[0]=h;
if(M+3*(R-1)>=K)throw MakeURIError();
for(var N=1;N<R;N++){
if(I.charAt(++M)!='%')throw MakeURIError();
m[N]=URIHexCharsToCharCode(I.charCodeAt(++M),
I.charCodeAt(++M));
}
l=URIDecodeOctets(m,Q,l);
}else if(O(h)){
%_TwoByteSeqStringSetChar(l++,37,Q);
%_TwoByteSeqStringSetChar(l++,I.charCodeAt(M-1),Q);
%_TwoByteSeqStringSetChar(l++,I.charCodeAt(M),Q);
}else{
%_TwoByteSeqStringSetChar(l++,h,Q);
}
}else{
%_TwoByteSeqStringSetChar(l++,g,Q);
}
}
Q=%TruncateString(Q,l);
return P+Q;
}
function URIEscapeJS(S){
var T=$toString(S);
return %URIEscape(T);
}
function URIUnescapeJS(S){
var T=$toString(S);
return %URIUnescape(T);
}
function URIDecode(I){
var U=function(h){
if(35<=h&&h<=36)return true;
if(h==38)return true;
if(43<=h&&h<=44)return true;
if(h==47)return true;
if(58<=h&&h<=59)return true;
if(h==61)return true;
if(63<=h&&h<=64)return true;
return false;
};
var V=$toString(I);
return Decode(V,U);
}
function URIDecodeComponent(W){
var U=function(h){return false;};
var V=$toString(W);
return Decode(V,U);
}
function URIEncode(I){
var X=function(h){
if(isAlphaNumeric(h))return true;
if(h==33)return true;
if(35<=h&&h<=36)return true;
if(38<=h&&h<=47)return true;
if(58<=h&&h<=59)return true;
if(h==61)return true;
if(63<=h&&h<=64)return true;
if(h==95)return true;
if(h==126)return true;
return false;
};
var V=$toString(I);
return Encode(V,X);
}
function URIEncodeComponent(W){
var X=function(h){
if(isAlphaNumeric(h))return true;
if(h==33)return true;
if(39<=h&&h<=42)return true;
if(45<=h&&h<=46)return true;
if(h==95)return true;
if(h==126)return true;
return false;
};
var V=$toString(W);
return Encode(V,X);
}
b.InstallFunctions(a,2,[
"escape",URIEscapeJS,
"unescape",URIUnescapeJS,
"decodeURI",URIDecode,
"decodeURIComponent",URIDecodeComponent,
"encodeURI",URIEncode,
"encodeURIComponent",URIEncodeComponent
]);
})

math•a
var rngstate;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Object;
var d=b.InternalArray;
function MathAbs(e){
e=+e;
return(e>0)?e:0-e;
}
function MathAcosJS(e){
return %_MathAcos(+e);
}
function MathAsinJS(e){
return %_MathAsin(+e);
}
function MathAtanJS(e){
return %_MathAtan(+e);
}
function MathAtan2JS(g,e){
g=+g;
e=+e;
return %_MathAtan2(g,e);
}
function MathCeil(e){
return-%_MathFloor(-e);
}
function MathExp(e){
return %MathExpRT(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)));
}
function MathFloorJS(e){
return %_MathFloor(+e);
}
function MathLog(e){
return %_MathLogRT(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)));
}
function MathMax(h,i){
var j=%_ArgumentsLength();
if(j==2){
h=((typeof(%IS_VAR(h))==='number')?h:$nonNumberToNumber(h));
i=((typeof(%IS_VAR(i))==='number')?i:$nonNumberToNumber(i));
if(i>h)return i;
if(h>i)return h;
if(h==i){
return(h===0&&%_IsMinusZero(h))?i:h;
}
return $NaN;
}
var k=-(1/0);
for(var l=0;l<j;l++){
var m=%_Arguments(l);
m=((typeof(%IS_VAR(m))==='number')?m:$nonNumberToNumber(m));
if((!%_IsSmi(%IS_VAR(m))&&!(m==m))||m>k||(k===0&&m===0&&%_IsMinusZero(k))){
k=m;
}
}
return k;
}
function MathMin(h,i){
var j=%_ArgumentsLength();
if(j==2){
h=((typeof(%IS_VAR(h))==='number')?h:$nonNumberToNumber(h));
i=((typeof(%IS_VAR(i))==='number')?i:$nonNumberToNumber(i));
if(i>h)return h;
if(h>i)return i;
if(h==i){
return(h===0&&%_IsMinusZero(h))?h:i;
}
return $NaN;
}
var k=(1/0);
for(var l=0;l<j;l++){
var m=%_Arguments(l);
m=((typeof(%IS_VAR(m))==='number')?m:$nonNumberToNumber(m));
if((!%_IsSmi(%IS_VAR(m))&&!(m==m))||m<k||(k===0&&m===0&&%_IsMinusZero(m))){
k=m;
}
}
return k;
}
function MathPowJS(e,g){
return %_MathPow(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)),((typeof(%IS_VAR(g))==='number')?g:$nonNumberToNumber(g)));
}
function MathRandom(){
var n=(MathImul(18030,rngstate[0]&0xFFFF)+(rngstate[0]>>>16))|0;
rngstate[0]=n;
var o=(MathImul(36969,rngstate[1]&0xFFFF)+(rngstate[1]>>>16))|0;
rngstate[1]=o;
var e=((n<<16)+(o&0xFFFF))|0;
return(e<0?(e+0x100000000):e)*2.3283064365386962890625e-10;
}
function MathRandomRaw(){
var n=(MathImul(18030,rngstate[0]&0xFFFF)+(rngstate[0]>>>16))|0;
rngstate[0]=n;
var o=(MathImul(36969,rngstate[1]&0xFFFF)+(rngstate[1]>>>16))|0;
rngstate[1]=o;
var e=((n<<16)+(o&0xFFFF))|0;
return e&0x3fffffff;
}
function MathRound(e){
return %RoundNumber(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)));
}
function MathSqrtJS(e){
return %_MathSqrt(+e);
}
function MathImul(e,g){
return %NumberImul(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)),((typeof(%IS_VAR(g))==='number')?g:$nonNumberToNumber(g)));
}
function MathSign(e){
e=+e;
if(e>0)return 1;
if(e<0)return-1;
return e;
}
function MathTrunc(e){
e=+e;
if(e>0)return %_MathFloor(e);
if(e<0)return-%_MathFloor(-e);
return e;
}
function MathTanh(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e===0)return e;
if(!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return MathSign(e);
var p=MathExp(e);
var q=MathExp(-e);
return(p-q)/(p+q);
}
function MathAsinh(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e===0||!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return e;
if(e>0)return MathLog(e+%_MathSqrt(e*e+1));
return-MathLog(-e+%_MathSqrt(e*e+1));
}
function MathAcosh(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e<1)return $NaN;
if(!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return e;
return MathLog(e+%_MathSqrt(e+1)*%_MathSqrt(e-1));
}
function MathAtanh(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e===0)return e;
if(!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return $NaN;
return 0.5*MathLog((1+e)/(1-e));
}
function MathHypot(e,g){
var j=%_ArgumentsLength();
var r=new d(j);
var t=0;
for(var l=0;l<j;l++){
var m=%_Arguments(l);
m=((typeof(%IS_VAR(m))==='number')?m:$nonNumberToNumber(m));
if(m===(1/0)||m===-(1/0))return(1/0);
m=MathAbs(m);
if(m>t)t=m;
r[l]=m;
}
if(t===0)t=1;
var u=0;
var v=0;
for(var l=0;l<j;l++){
var m=r[l]/t;
var w=m*m-v;
var x=u+w;
v=(x-u)-w;
u=x;
}
return %_MathSqrt(u)*t;
}
function MathFroundJS(e){
return %MathFround(((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e)));
}
function MathClz32JS(e){
return %_MathClz32(e>>>0);
}
function MathCbrt(e){
e=((typeof(%IS_VAR(e))==='number')?e:$nonNumberToNumber(e));
if(e==0||!(%_IsSmi(%IS_VAR(e))||((e==e)&&(e!=1/0)&&(e!=-1/0))))return e;
return e>=0?CubeRoot(e):-CubeRoot(-e);
}
function CubeRoot(e){
var y=MathFloorJS(%_DoubleHi(e)/3)+0x2A9F7893;
var z=%_ConstructDouble(y,0);
z=(1.0/3.0)*(e/(z*z)+2*z);
;
z=(1.0/3.0)*(e/(z*z)+2*z);
;
z=(1.0/3.0)*(e/(z*z)+2*z);
;
return(1.0/3.0)*(e/(z*z)+2*z);
;
}
function MathConstructor(){}
var A=new MathConstructor();
%InternalSetPrototype(A,c.prototype);
%AddNamedProperty(a,"Math",A,2);
%FunctionSetInstanceClassName(MathConstructor,'Math');
%AddNamedProperty(A,symbolToStringTag,"Math",1|2);
b.InstallConstants(A,[
"E",2.7182818284590452354,
"LN10",2.302585092994046,
"LN2",0.6931471805599453,
"LOG2E",1.4426950408889634,
"LOG10E",0.4342944819032518,
"PI",3.1415926535897932,
"SQRT1_2",0.7071067811865476,
"SQRT2",1.4142135623730951
]);
b.InstallFunctions(A,2,[
"random",MathRandom,
"abs",MathAbs,
"acos",MathAcosJS,
"asin",MathAsinJS,
"atan",MathAtanJS,
"ceil",MathCeil,
"exp",MathExp,
"floor",MathFloorJS,
"log",MathLog,
"round",MathRound,
"sqrt",MathSqrtJS,
"atan2",MathAtan2JS,
"pow",MathPowJS,
"max",MathMax,
"min",MathMin,
"imul",MathImul,
"sign",MathSign,
"trunc",MathTrunc,
"tanh",MathTanh,
"asinh",MathAsinh,
"acosh",MathAcosh,
"atanh",MathAtanh,
"hypot",MathHypot,
"fround",MathFroundJS,
"clz32",MathClz32JS,
"cbrt",MathCbrt
]);
%SetForceInlineFlag(MathAbs);
%SetForceInlineFlag(MathAcosJS);
%SetForceInlineFlag(MathAsinJS);
%SetForceInlineFlag(MathAtanJS);
%SetForceInlineFlag(MathAtan2JS);
%SetForceInlineFlag(MathCeil);
%SetForceInlineFlag(MathClz32JS);
%SetForceInlineFlag(MathFloorJS);
%SetForceInlineFlag(MathRandom);
%SetForceInlineFlag(MathSign);
%SetForceInlineFlag(MathSqrtJS);
%SetForceInlineFlag(MathTrunc);
b.Export(function(B){
B.MathAbs=MathAbs;
B.MathExp=MathExp;
B.MathFloor=MathFloorJS;
B.IntRandom=MathRandomRaw;
B.MathMax=MathMax;
B.MathMin=MathMin;
});
})

fdlibme¨
var kMath;
var rempio2result;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Math;
var d;
var e;
b.Import(function(g){
d=g.MathAbs;
e=g.MathExp;
});





















function KernelTan(h,i,j){
var k;
var l;
var m=%_DoubleHi(h);
var n=m&0x7fffffff;
if(n<0x3e300000){
if(((n|%_DoubleLo(h))|(j+1))==0){
return 1/d(h);
}else{
if(j==1){
return h;
}else{
var l=h+i;
var k=%_ConstructDouble(%_DoubleHi(l),0);
var o=i-(k-h);
var p=-1/l;
var q=%_ConstructDouble(%_DoubleHi(p),0);
var r=1+q*k;
return q+p*(r+q*o);
}
}
}
if(n>=0x3fe59428){
if(h<0){
h=-h;
i=-i;
}
k=kMath[32]-h;
l=kMath[33]-i;
h=k+l;
i=0;
}
k=h*h;
l=k*k;
var t=kMath[19+1]
+l*(kMath[19+3]
+l*(kMath[19+5]
+
l*(kMath[19+7]
+l*(kMath[19+9]
+l*kMath[19+11]
))));
var o=k*(kMath[19+2]
+l*(kMath[19+4]
+l*(kMath[19+6]
+
l*(kMath[19+8]
+l*(kMath[19+10]
+l*kMath[19+12]
)))));
var r=k*h;
t=i+k*(r*(t+o)+i);
t=t+kMath[19+0]
*r;
l=h+t;
if(n>=0x3fe59428){
return(1-((m>>30)&2))*
(j-2.0*(h-(l*l/(l+j)-t)));
}
if(j==1){
return l;
}else{
k=%_ConstructDouble(%_DoubleHi(l),0);
o=t-(k-h);
var p=-1/l;
var q=%_ConstructDouble(%_DoubleHi(p),0);
r=1+q*k;
return q+p*(r+q*o);
}
}
function MathSinSlow(h){
var u,v,w;
var m=%_DoubleHi(h);
var n=m&0x7fffffff;
if(n<0x4002d97c){
if(m>0){
var k=h-kMath[1];
if(n!=0x3ff921fb){
v=k-kMath[2];
w=(k-v)-kMath[2];
}else{
k-=kMath[3];
v=k-kMath[4];
w=(k-v)-kMath[4];
}
u=1;
}else{
var k=h+kMath[1];
if(n!=0x3ff921fb){
v=k+kMath[2];
w=(k-v)+kMath[2];
}else{
k+=kMath[3];
v=k+kMath[4];
w=(k-v)+kMath[4];
}
u=-1;
}
}else if(n<=0x413921fb){
var q=d(h);
u=(q*kMath[0]+0.5)|0;
var t=q-u*kMath[1];
var l=u*kMath[2];
v=t-l;
if(n-(%_DoubleHi(v)&0x7ff00000)>0x1000000){
q=t;
l=u*kMath[3];
t=q-l;
l=u*kMath[4]-((q-t)-l);
v=t-l;
if(n-(%_DoubleHi(v)&0x7ff00000)>0x3100000){
q=t;
l=u*kMath[5];
t=q-l;
l=u*kMath[6]-((q-t)-l);
v=t-l;
}
}
w=(t-v)-l;
if(m<0){
u=-u;
v=-v;
w=-w;
}
}else{
u=%RemPiO2(h,rempio2result);
v=rempio2result[0];
w=rempio2result[1];
}
;
var x=1-(u&2);
if(u&1){
var n=%_DoubleHi(v)&0x7fffffff;
var k=v*v;
var t=k*(4.16666666666666019037e-02+k*(-1.38888888888741095749e-03+k*(2.48015872894767294178e-05+k*(-2.75573143513906633035e-07+k*(2.08757232129817482790e-09+k*-1.13596475577881948265e-11)))));
if(n<0x3fd33333){
return(1-(0.5*k-(k*t-v*w)))*x;
}else{
var y;
if(n>0x3fe90000){
y=0.28125;
}else{
y=%_ConstructDouble(%_DoubleHi(0.25*v),0);
}
var z=0.5*k-y;
return(1-y-(z-(k*t-v*w)))*x;
}
;
}else{
var k=v*v;
var o=k*v;
var t=8.33333333332248946124e-03+k*(-1.98412698298579493134e-04+k*(2.75573137070700676789e-06+k*(-2.50507602534068634195e-08+k*1.58969099521155010221e-10)));
return(v-((k*(0.5*w-o*t)-w)-o*-1.66666666666666324348e-01))*x;
;
}
}
function MathCosSlow(h){
var u,v,w;
var m=%_DoubleHi(h);
var n=m&0x7fffffff;
if(n<0x4002d97c){
if(m>0){
var k=h-kMath[1];
if(n!=0x3ff921fb){
v=k-kMath[2];
w=(k-v)-kMath[2];
}else{
k-=kMath[3];
v=k-kMath[4];
w=(k-v)-kMath[4];
}
u=1;
}else{
var k=h+kMath[1];
if(n!=0x3ff921fb){
v=k+kMath[2];
w=(k-v)+kMath[2];
}else{
k+=kMath[3];
v=k+kMath[4];
w=(k-v)+kMath[4];
}
u=-1;
}
}else if(n<=0x413921fb){
var q=d(h);
u=(q*kMath[0]+0.5)|0;
var t=q-u*kMath[1];
var l=u*kMath[2];
v=t-l;
if(n-(%_DoubleHi(v)&0x7ff00000)>0x1000000){
q=t;
l=u*kMath[3];
t=q-l;
l=u*kMath[4]-((q-t)-l);
v=t-l;
if(n-(%_DoubleHi(v)&0x7ff00000)>0x3100000){
q=t;
l=u*kMath[5];
t=q-l;
l=u*kMath[6]-((q-t)-l);
v=t-l;
}
}
w=(t-v)-l;
if(m<0){
u=-u;
v=-v;
w=-w;
}
}else{
u=%RemPiO2(h,rempio2result);
v=rempio2result[0];
w=rempio2result[1];
}
;
if(u&1){
var x=(u&2)-1;
var k=v*v;
var o=k*v;
var t=8.33333333332248946124e-03+k*(-1.98412698298579493134e-04+k*(2.75573137070700676789e-06+k*(-2.50507602534068634195e-08+k*1.58969099521155010221e-10)));
return(v-((k*(0.5*w-o*t)-w)-o*-1.66666666666666324348e-01))*x;
;
}else{
var x=1-(u&2);
var n=%_DoubleHi(v)&0x7fffffff;
var k=v*v;
var t=k*(4.16666666666666019037e-02+k*(-1.38888888888741095749e-03+k*(2.48015872894767294178e-05+k*(-2.75573143513906633035e-07+k*(2.08757232129817482790e-09+k*-1.13596475577881948265e-11)))));
if(n<0x3fd33333){
return(1-(0.5*k-(k*t-v*w)))*x;
}else{
var y;
if(n>0x3fe90000){
y=0.28125;
}else{
y=%_ConstructDouble(%_DoubleHi(0.25*v),0);
}
var z=0.5*k-y;
return(1-y-(z-(k*t-v*w)))*x;
}
;
}
}
function MathSin(h){
h=+h;
if((%_DoubleHi(h)&0x7fffffff)<=0x3fe921fb){
var k=h*h;
var o=k*h;
var t=8.33333333332248946124e-03+k*(-1.98412698298579493134e-04+k*(2.75573137070700676789e-06+k*(-2.50507602534068634195e-08+k*1.58969099521155010221e-10)));
return(h-((k*(0.5*0-o*t)-0)-o*-1.66666666666666324348e-01));
;
}
return+MathSinSlow(h);
}
function MathCos(h){
h=+h;
if((%_DoubleHi(h)&0x7fffffff)<=0x3fe921fb){
var n=%_DoubleHi(h)&0x7fffffff;
var k=h*h;
var t=k*(4.16666666666666019037e-02+k*(-1.38888888888741095749e-03+k*(2.48015872894767294178e-05+k*(-2.75573143513906633035e-07+k*(2.08757232129817482790e-09+k*-1.13596475577881948265e-11)))));
if(n<0x3fd33333){
return(1-(0.5*k-(k*t-h*0)));
}else{
var y;
if(n>0x3fe90000){
y=0.28125;
}else{
y=%_ConstructDouble(%_DoubleHi(0.25*h),0);
}
var z=0.5*k-y;
return(1-y-(z-(k*t-h*0)));
}
;
}
return+MathCosSlow(h);
}
function MathTan(h){
h=h*1;
if((%_DoubleHi(h)&0x7fffffff)<=0x3fe921fb){
return KernelTan(h,0,1);
}
var u,v,w;
var m=%_DoubleHi(h);
var n=m&0x7fffffff;
if(n<0x4002d97c){
if(m>0){
var k=h-kMath[1];
if(n!=0x3ff921fb){
v=k-kMath[2];
w=(k-v)-kMath[2];
}else{
k-=kMath[3];
v=k-kMath[4];
w=(k-v)-kMath[4];
}
u=1;
}else{
var k=h+kMath[1];
if(n!=0x3ff921fb){
v=k+kMath[2];
w=(k-v)+kMath[2];
}else{
k+=kMath[3];
v=k+kMath[4];
w=(k-v)+kMath[4];
}
u=-1;
}
}else if(n<=0x413921fb){
var q=d(h);
u=(q*kMath[0]+0.5)|0;
var t=q-u*kMath[1];
var l=u*kMath[2];
v=t-l;
if(n-(%_DoubleHi(v)&0x7ff00000)>0x1000000){
q=t;
l=u*kMath[3];
t=q-l;
l=u*kMath[4]-((q-t)-l);
v=t-l;
if(n-(%_DoubleHi(v)&0x7ff00000)>0x3100000){
q=t;
l=u*kMath[5];
t=q-l;
l=u*kMath[6]-((q-t)-l);
v=t-l;
}
}
w=(t-v)-l;
if(m<0){
u=-u;
v=-v;
w=-w;
}
}else{
u=%RemPiO2(h,rempio2result);
v=rempio2result[0];
w=rempio2result[1];
}
;
return KernelTan(v,w,(u&1)?-1:1);
}




function MathLog1p(h){
h=h*1;
var m=%_DoubleHi(h);
var A=m&0x7fffffff;
var B=1;
var C=h;
var D=1;
var E=0;
var F=h;
if(m<0x3fda827a){
if(A>=0x3ff00000){
if(h===-1){
return-(1/0);
}else{
return $NaN;
}
}else if(A<0x3c900000){
return h;
}else if(A<0x3e200000){
return h-h*h*0.5;
}
if((m>0)||(m<=-0x402D413D)){
B=0;
}
}
if(m>=0x7ff00000)return h;
if(B!==0){
if(m<0x43400000){
F=1+h;
D=%_DoubleHi(F);
B=(D>>20)-1023;
E=(B>0)?1-(F-h):h-(F-1);
E=E/F;
}else{
D=%_DoubleHi(F);
B=(D>>20)-1023;
}
D=D&0xfffff;
if(D<0x6a09e){
F=%_ConstructDouble(D|0x3ff00000,%_DoubleLo(F));
}else{
++B;
F=%_ConstructDouble(D|0x3fe00000,%_DoubleLo(F));
D=(0x00100000-D)>>2;
}
C=F-1;
}
var G=0.5*C*C;
if(D===0){
if(C===0){
if(B===0){
return 0.0;
}else{
return B*kMath[34]+(E+B*kMath[35]);
}
}
var H=G*(1-kMath[36]*C);
if(B===0){
return C-H;
}else{
return B*kMath[34]-((H-(B*kMath[35]+E))-C);
}
}
var r=C/(2+C);
var k=r*r;
var H=k*((kMath[37+0])
+k*((kMath[37+1])
+k*
((kMath[37+2])
+k*((kMath[37+3])
+k*
((kMath[37+4])
+k*((kMath[37+5])
+k*(kMath[37+6])
))))));
if(B===0){
return C-(G-r*(G+H));
}else{
return B*kMath[34]-((G-(r*(G+H)+(B*kMath[35]+E)))-C);
}
}


function MathExpm1(h){
h=h*1;
var i;
var I;
var J;
var B;
var q;
var E;
var m=%_DoubleHi(h);
var K=m&0x80000000;
var i=(K===0)?h:-h;
m&=0x7fffffff;
if(m>=0x4043687a){
if(m>=0x40862e42){
if(m>=0x7ff00000){
return(h===-(1/0))?-1:h;
}
if(h>kMath[44])return(1/0);
}
if(K!=0)return-1;
}
if(m>0x3fd62e42){
if(m<0x3ff0a2b2){
if(K===0){
I=h-kMath[34];
J=kMath[35];
B=1;
}else{
I=h+kMath[34];
J=-kMath[35];
B=-1;
}
}else{
B=(kMath[45]*h+((K===0)?0.5:-0.5))|0;
q=B;
I=h-q*kMath[34];
J=q*kMath[35];
}
h=I-J;
E=(I-h)-J;
}else if(m<0x3c900000){
return h;
}else{
B=0;
}
var L=0.5*h;
var M=h*L;
var N=1+M*((kMath[46+0])
+M*((kMath[46+1])
+M*
((kMath[46+2])
+M*((kMath[46+3])
+M*(kMath[46+4])
))));
q=3-N*L;
var O=M*((N-q)/(6-h*q));
if(B===0){
return h-(h*O-M);
}else{
O=(h*(O-E)-E);
O-=M;
if(B===-1)return 0.5*(h-O)-0.5;
if(B===1){
if(h<-0.25)return-2*(O-(h+0.5));
return 1+2*(h-O);
}
if(B<=-2||B>56){
i=1-(O-h);
i=%_ConstructDouble(%_DoubleHi(i)+(B<<20),%_DoubleLo(i));
return i-1;
}
if(B<20){
q=%_ConstructDouble(0x3ff00000-(0x200000>>B),0);
i=q-(O-h);
i=%_ConstructDouble(%_DoubleHi(i)+(B<<20),%_DoubleLo(i));
}else{
q=%_ConstructDouble((0x3ff-B)<<20,0);
i=h-(O+q);
i+=1;
i=%_ConstructDouble(%_DoubleHi(i)+(B<<20),%_DoubleLo(i));
}
}
return i;
}



function MathSinh(h){
h=h*1;
var P=(h<0)?-0.5:0.5;
var A=d(h);
if(A<22){
if(A<3.725290298461914e-9)return h;
var q=MathExpm1(A);
if(A<1)return P*(2*q-q*q/(q+1));
return P*(q+q/(q+1));
}
if(A<709.7822265625)return P*e(A);
if(A<=kMath[51]){
var l=e(0.5*A);
var q=P*l;
return q*l;
}
return h*(1/0);
}

function MathCosh(h){
h=h*1;
var n=%_DoubleHi(h)&0x7fffffff;
if(n<0x3fd62e43){
var q=MathExpm1(d(h));
var l=1+q;
if(n<0x3c800000)return l;
return 1+(q*q)/(l+l);
}
if(n<0x40360000){
var q=e(d(h));
return 0.5*q+0.5/q;
}
if(n<0x40862e42)return 0.5*e(d(h));
if(d(h)<=kMath[51]){
var l=e(0.5*d(h));
var q=0.5*l;
return q*l;
}
if((!%_IsSmi(%IS_VAR(h))&&!(h==h)))return h;
return(1/0);
}



function MathLog10(h){
h=h*1;
var m=%_DoubleHi(h);
var Q=%_DoubleLo(h);
var B=0;
if(m<0x00100000){
if(((m&0x7fffffff)|Q)===0)return-(1/0);
if(m<0)return $NaN;
B-=54;
h*=18014398509481984;
m=%_DoubleHi(h);
Q=%_DoubleLo(h);
}
if(m>=0x7ff00000)return h;
B+=(m>>20)-1023;
var R=(B&0x80000000)>>>31;
m=(m&0x000fffff)|((0x3ff-R)<<20);
var i=B+R;
h=%_ConstructDouble(m,Q);
var k=i*kMath[54]+kMath[52]*%_MathLogRT(h);
return k+i*kMath[53];
}






function MathLog2(h){
h=h*1;
var A=d(h);
var m=%_DoubleHi(h);
var Q=%_DoubleLo(h);
var n=m&0x7fffffff;
if((n|Q)==0)return-(1/0);
if(m<0)return $NaN;
if(n>=0x7ff00000)return h;
var u=0;
if(n<0x00100000){
A*=9007199254740992;
u-=53;
n=%_DoubleHi(A);
}
u+=(n>>20)-0x3ff;
var S=n&0x000fffff;
n=S|0x3ff00000;
var T=1;
var U=0;
var V=0;
if(S>0x3988e){
if(S<0xbb67a){
T=1.5;
U=kMath[64];
V=kMath[65];
}else{
u+=1;
n-=0x00100000;
}
}
A=%_ConstructDouble(n,%_DoubleLo(A));
var F=A-T;
var o=1/(A+T);
var W=F*o;
var X=%_ConstructDouble(%_DoubleHi(W),0);
var Y=%_ConstructDouble(%_DoubleHi(A+T),0)
var Z=A-(Y-T);
var aa=o*((F-X*Y)-X*Z);
var ab=W*W;
var t=ab*ab*((kMath[55+0])
+ab*((kMath[55+1])
+ab*((kMath[55+2])
+ab*(
(kMath[55+3])
+ab*((kMath[55+4])
+ab*(kMath[55+5])
)))));
t+=aa*(X+W);
ab=X*X;
Y=%_ConstructDouble(%_DoubleHi(3.0+ab+t),0);
Z=t-((Y-3.0)-ab);
F=X*Y;
o=aa*Y+Z*W;
p_h=%_ConstructDouble(%_DoubleHi(F+o),0);
p_l=o-(p_h-F);
z_h=kMath[62]*p_h;
z_l=kMath[63]*p_h+p_l*kMath[61]+V;
var q=u;
var ac=%_ConstructDouble(%_DoubleHi(((z_h+z_l)+U)+q),0);
var ad=z_l-(((ac-q)-U)-z_h);
return ac+ad;
}
b.InstallFunctions(c,2,[
"cos",MathCos,
"sin",MathSin,
"tan",MathTan,
"sinh",MathSinh,
"cosh",MathCosh,
"log10",MathLog10,
"log2",MathLog2,
"log1p",MathLog1p,
"expm1",MathExpm1
]);
%SetForceInlineFlag(MathSin);
%SetForceInlineFlag(MathCos);
})

dateÁö
var $createDate;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Date;
var d=b.InternalArray;
var e;
var g;
var h;
b.Import(function(i){
e=i.IsFinite;
g=i.MathAbs;
h=i.MathFloor;
});
var j=$NaN;
var k;
function LocalTimezone(l){
if((!%_IsSmi(%IS_VAR(l))&&!(l==l)))return"";
CheckDateCacheCurrent();
if(l==j){
return k;
}
var m=%DateLocalTimezone(l);
j=l;
k=m;
return m;
}
function UTC(n){
if((!%_IsSmi(%IS_VAR(n))&&!(n==n)))return n;
return %DateToUTC(n);
}
function MakeTime(o,p,q,r){
if(!e(o))return $NaN;
if(!e(p))return $NaN;
if(!e(q))return $NaN;
if(!e(r))return $NaN;
return(%_IsSmi(%IS_VAR(o))?o:%NumberToInteger($toNumber(o)))*3600000
+(%_IsSmi(%IS_VAR(p))?p:%NumberToInteger($toNumber(p)))*60000
+(%_IsSmi(%IS_VAR(q))?q:%NumberToInteger($toNumber(q)))*1000
+(%_IsSmi(%IS_VAR(r))?r:%NumberToInteger($toNumber(r)));
}
function TimeInYear(t){
return DaysInYear(t)*86400000;
}
function MakeDay(t,u,v){
if(!e(t)||!e(u)||!e(v))return $NaN;
t=(%_IsSmi(%IS_VAR(t))?t:%NumberToIntegerMapMinusZero($toNumber(t)));
u=(%_IsSmi(%IS_VAR(u))?u:%NumberToIntegerMapMinusZero($toNumber(u)));
v=(%_IsSmi(%IS_VAR(v))?v:%NumberToIntegerMapMinusZero($toNumber(v)));
if(t<-1000000||t>1000000||
u<-10000000||u>10000000){
return $NaN;
}
return %DateMakeDay(t|0,u|0)+v-1;
}
function MakeDate(w,n){
var n=w*86400000+n;
if(g(n)>8640002592000000)return $NaN;
return n;
}
function TimeClip(n){
if(!e(n))return $NaN;
if(g(n)>8640000000000000)return $NaN;
return(%_IsSmi(%IS_VAR(n))?n:%NumberToInteger($toNumber(n)));
}
var x={
time:0,
string:null
};
function DateConstructor(t,u,v,y,z,A,r){
if(!%_IsConstructCall()){
return(new c()).toString();
}
var B=%_ArgumentsLength();
var C;
if(B==0){
C=%DateCurrentTime();
(%DateSetValue(this,C,1));
}else if(B==1){
if((typeof(t)==='number')){
C=t;
}else if((typeof(t)==='string')){
CheckDateCacheCurrent();
var D=x;
if(D.string===t){
C=D.time;
}else{
C=DateParse(t);
if(!(!%_IsSmi(%IS_VAR(C))&&!(C==C))){
D.time=C;
D.string=t;
}
}
}else{
var n=$toPrimitive(t,1);
C=(typeof(n)==='string')?DateParse(n):$toNumber(n);
}
(%DateSetValue(this,C,1));
}else{
t=$toNumber(t);
u=$toNumber(u);
v=B>2?$toNumber(v):1;
y=B>3?$toNumber(y):0;
z=B>4?$toNumber(z):0;
A=B>5?$toNumber(A):0;
r=B>6?$toNumber(r):0;
t=(!(!%_IsSmi(%IS_VAR(t))&&!(t==t))&&
0<=(%_IsSmi(%IS_VAR(t))?t:%NumberToInteger($toNumber(t)))&&
(%_IsSmi(%IS_VAR(t))?t:%NumberToInteger($toNumber(t)))<=99)?1900+(%_IsSmi(%IS_VAR(t))?t:%NumberToInteger($toNumber(t))):t;
var w=MakeDay(t,u,v);
var n=MakeTime(y,z,A,r);
C=MakeDate(w,n);
(%DateSetValue(this,C,0));
}
}
var E=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
var F=['Jan','Feb','Mar','Apr','May','Jun',
'Jul','Aug','Sep','Oct','Nov','Dec'];
function TwoDigitString(C){
return C<10?"0"+C:""+C;
}
function DateString(v){
%_ThrowIfNotADate(v);
return E[(%_DateField(v,4))]+' '
+F[(%_DateField(v,2))]+' '
+TwoDigitString((%_DateField(v,3)))+' '
+(%_DateField(v,1));
}
var G=['Sunday','Monday','Tuesday','Wednesday',
'Thursday','Friday','Saturday'];
var H=['January','February','March','April','May','June',
'July','August','September','October','November','December'];
function LongDateString(v){
%_ThrowIfNotADate(v);
return G[(%_DateField(v,4))]+', '
+H[(%_DateField(v,2))]+' '
+TwoDigitString((%_DateField(v,3)))+', '
+(%_DateField(v,1));
}
function TimeString(v){
%_ThrowIfNotADate(v);
return TwoDigitString((%_DateField(v,5)))+':'
+TwoDigitString((%_DateField(v,6)))+':'
+TwoDigitString((%_DateField(v,7)));
}
function TimeStringUTC(v){
%_ThrowIfNotADate(v);
return TwoDigitString((%_DateField(v,15)))+':'
+TwoDigitString((%_DateField(v,16)))+':'
+TwoDigitString((%_DateField(v,17)));
}
function LocalTimezoneString(v){
%_ThrowIfNotADate(v);
var m=LocalTimezone((%_DateField(v,0)));
var I=-(%_DateField(v,21));
var J=(I>=0)?1:-1;
var y=h((J*I)/60);
var p=h((J*I)%60);
var K=' GMT'+((J==1)?'+':'-')+
TwoDigitString(y)+TwoDigitString(p);
return K+' ('+m+')';
}
function DatePrintString(v){
%_ThrowIfNotADate(v);
return DateString(v)+' '+TimeString(v);
}
var L=new d(8);
function DateParse(M){
var N=%DateParseString($toString(M),L);
if((N===null))return $NaN;
var w=MakeDay(N[0],N[1],N[2]);
var n=MakeTime(N[3],N[4],N[5],N[6]);
var v=MakeDate(w,n);
if((N[7]===null)){
return TimeClip(UTC(v));
}else{
return TimeClip(v-N[7]*1000);
}
}
function DateUTC(t,u,v,y,z,A,r){
t=$toNumber(t);
u=$toNumber(u);
var B=%_ArgumentsLength();
v=B>2?$toNumber(v):1;
y=B>3?$toNumber(y):0;
z=B>4?$toNumber(z):0;
A=B>5?$toNumber(A):0;
r=B>6?$toNumber(r):0;
t=(!(!%_IsSmi(%IS_VAR(t))&&!(t==t))&&
0<=(%_IsSmi(%IS_VAR(t))?t:%NumberToInteger($toNumber(t)))&&
(%_IsSmi(%IS_VAR(t))?t:%NumberToInteger($toNumber(t)))<=99)?1900+(%_IsSmi(%IS_VAR(t))?t:%NumberToInteger($toNumber(t))):t;
var w=MakeDay(t,u,v);
var n=MakeTime(y,z,A,r);
return TimeClip(MakeDate(w,n));
}
function DateNow(){
return %DateCurrentTime();
}
function DateToString(){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0))
if((!%_IsSmi(%IS_VAR(l))&&!(l==l)))return'Invalid Date';
var O=LocalTimezoneString(this)
return DatePrintString(this)+O;
}
function DateToDateString(){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(l))&&!(l==l)))return'Invalid Date';
return DateString(this);
}
function DateToTimeString(){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(l))&&!(l==l)))return'Invalid Date';
var O=LocalTimezoneString(this);
return TimeString(this)+O;
}
function DateToLocaleString(){
%_ThrowIfNotADate(this);
return %_CallFunction(this,DateToString);
}
function DateToLocaleDateString(){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(l))&&!(l==l)))return'Invalid Date';
return LongDateString(this);
}
function DateToLocaleTimeString(){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(l))&&!(l==l)))return'Invalid Date';
return TimeString(this);
}
function DateValueOf(){
%_ThrowIfNotADate(this);
return(%_DateField(this,0));
}
function DateGetTime(){
%_ThrowIfNotADate(this);
return(%_DateField(this,0));
}
function DateGetFullYear(){
%_ThrowIfNotADate(this);
return(%_DateField(this,1));
}
function DateGetUTCFullYear(){
%_ThrowIfNotADate(this);
return(%_DateField(this,11));
}
function DateGetMonth(){
%_ThrowIfNotADate(this);
return(%_DateField(this,2));
}
function DateGetUTCMonth(){
%_ThrowIfNotADate(this);
return(%_DateField(this,12));
}
function DateGetDate(){
%_ThrowIfNotADate(this);
return(%_DateField(this,3));
}
function DateGetUTCDate(){
%_ThrowIfNotADate(this);
return(%_DateField(this,13));
}
function DateGetDay(){
%_ThrowIfNotADate(this);
return(%_DateField(this,4));
}
function DateGetUTCDay(){
%_ThrowIfNotADate(this);
return(%_DateField(this,14));
}
function DateGetHours(){
%_ThrowIfNotADate(this);
return(%_DateField(this,5));
}
function DateGetUTCHours(){
%_ThrowIfNotADate(this);
return(%_DateField(this,15));
}
function DateGetMinutes(){
%_ThrowIfNotADate(this);
return(%_DateField(this,6));
}
function DateGetUTCMinutes(){
%_ThrowIfNotADate(this);
return(%_DateField(this,16));
}
function DateGetSeconds(){
%_ThrowIfNotADate(this);
return(%_DateField(this,7));
}
function DateGetUTCSeconds(){
%_ThrowIfNotADate(this);
return(%_DateField(this,17))
}
function DateGetMilliseconds(){
%_ThrowIfNotADate(this);
return(%_DateField(this,8));
}
function DateGetUTCMilliseconds(){
%_ThrowIfNotADate(this);
return(%_DateField(this,18));
}
function DateGetTimezoneOffset(){
%_ThrowIfNotADate(this);
return(%_DateField(this,21));
}
function DateSetTime(r){
%_ThrowIfNotADate(this);
(%DateSetValue(this,$toNumber(r),1));
return(%_DateField(this,0));
}
function DateSetMilliseconds(r){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0)+%_DateField(this,21));
r=$toNumber(r);
var n=MakeTime((%_DateField(this,5)),(%_DateField(this,6)),(%_DateField(this,7)),r);
return(%DateSetValue(this,MakeDate((%_DateField(this,9)),n),0));
}
function DateSetUTCMilliseconds(r){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
r=$toNumber(r);
var n=MakeTime((%_DateField(this,15)),
(%_DateField(this,16)),
(%_DateField(this,17)),
r);
return(%DateSetValue(this,MakeDate((%_DateField(this,19)),n),1));
}
function DateSetSeconds(q,r){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0)+%_DateField(this,21));
q=$toNumber(q);
r=%_ArgumentsLength()<2?(%_DateField(this,8)):$toNumber(r);
var n=MakeTime((%_DateField(this,5)),(%_DateField(this,6)),q,r);
return(%DateSetValue(this,MakeDate((%_DateField(this,9)),n),0));
}
function DateSetUTCSeconds(q,r){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
q=$toNumber(q);
r=%_ArgumentsLength()<2?(%_DateField(this,18)):$toNumber(r);
var n=MakeTime((%_DateField(this,15)),(%_DateField(this,16)),q,r);
return(%DateSetValue(this,MakeDate((%_DateField(this,19)),n),1));
}
function DateSetMinutes(p,q,r){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0)+%_DateField(this,21));
p=$toNumber(p);
var B=%_ArgumentsLength();
q=B<2?(%_DateField(this,7)):$toNumber(q);
r=B<3?(%_DateField(this,8)):$toNumber(r);
var n=MakeTime((%_DateField(this,5)),p,q,r);
return(%DateSetValue(this,MakeDate((%_DateField(this,9)),n),0));
}
function DateSetUTCMinutes(p,q,r){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
p=$toNumber(p);
var B=%_ArgumentsLength();
q=B<2?(%_DateField(this,17)):$toNumber(q);
r=B<3?(%_DateField(this,18)):$toNumber(r);
var n=MakeTime((%_DateField(this,15)),p,q,r);
return(%DateSetValue(this,MakeDate((%_DateField(this,19)),n),1));
}
function DateSetHours(o,p,q,r){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0)+%_DateField(this,21));
o=$toNumber(o);
var B=%_ArgumentsLength();
p=B<2?(%_DateField(this,6)):$toNumber(p);
q=B<3?(%_DateField(this,7)):$toNumber(q);
r=B<4?(%_DateField(this,8)):$toNumber(r);
var n=MakeTime(o,p,q,r);
return(%DateSetValue(this,MakeDate((%_DateField(this,9)),n),0));
}
function DateSetUTCHours(o,p,q,r){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
o=$toNumber(o);
var B=%_ArgumentsLength();
p=B<2?(%_DateField(this,16)):$toNumber(p);
q=B<3?(%_DateField(this,17)):$toNumber(q);
r=B<4?(%_DateField(this,18)):$toNumber(r);
var n=MakeTime(o,p,q,r);
return(%DateSetValue(this,MakeDate((%_DateField(this,19)),n),1));
}
function DateSetDate(v){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0)+%_DateField(this,21));
v=$toNumber(v);
var w=MakeDay((%_DateField(this,1)),(%_DateField(this,2)),v);
return(%DateSetValue(this,MakeDate(w,(%_DateField(this,10))),0));
}
function DateSetUTCDate(v){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
v=$toNumber(v);
var w=MakeDay((%_DateField(this,11)),(%_DateField(this,12)),v);
return(%DateSetValue(this,MakeDate(w,(%_DateField(this,20))),1));
}
function DateSetMonth(u,v){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0)+%_DateField(this,21));
u=$toNumber(u);
v=%_ArgumentsLength()<2?(%_DateField(this,3)):$toNumber(v);
var w=MakeDay((%_DateField(this,1)),u,v);
return(%DateSetValue(this,MakeDate(w,(%_DateField(this,10))),0));
}
function DateSetUTCMonth(u,v){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
u=$toNumber(u);
v=%_ArgumentsLength()<2?(%_DateField(this,13)):$toNumber(v);
var w=MakeDay((%_DateField(this,11)),u,v);
return(%DateSetValue(this,MakeDate(w,(%_DateField(this,20))),1));
}
function DateSetFullYear(t,u,v){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0)+%_DateField(this,21));
t=$toNumber(t);
var B=%_ArgumentsLength();
var n;
if((!%_IsSmi(%IS_VAR(l))&&!(l==l))){
u=B<2?0:$toNumber(u);
v=B<3?1:$toNumber(v);
n=0;
}else{
u=B<2?(%_DateField(this,2)):$toNumber(u);
v=B<3?(%_DateField(this,3)):$toNumber(v);
n=(%_DateField(this,10));
}
var w=MakeDay(t,u,v);
return(%DateSetValue(this,MakeDate(w,n),0));
}
function DateSetUTCFullYear(t,u,v){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
t=$toNumber(t);
var B=%_ArgumentsLength();
var n;
if((!%_IsSmi(%IS_VAR(l))&&!(l==l))){
u=B<2?0:$toNumber(u);
v=B<3?1:$toNumber(v);
n=0;
}else{
u=B<2?(%_DateField(this,12)):$toNumber(u);
v=B<3?(%_DateField(this,13)):$toNumber(v);
n=(%_DateField(this,20));
}
var w=MakeDay(t,u,v);
return(%DateSetValue(this,MakeDate(w,n),1));
}
function DateToUTCString(){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(l))&&!(l==l)))return'Invalid Date';
return E[(%_DateField(this,14))]+', '
+TwoDigitString((%_DateField(this,13)))+' '
+F[(%_DateField(this,12))]+' '
+(%_DateField(this,11))+' '
+TimeStringUTC(this)+' GMT';
}
function DateGetYear(){
%_ThrowIfNotADate(this);
return(%_DateField(this,1))-1900;
}
function DateSetYear(t){
%_ThrowIfNotADate(this);
t=$toNumber(t);
if((!%_IsSmi(%IS_VAR(t))&&!(t==t)))return(%DateSetValue(this,$NaN,1));
t=(0<=(%_IsSmi(%IS_VAR(t))?t:%NumberToInteger($toNumber(t)))&&(%_IsSmi(%IS_VAR(t))?t:%NumberToInteger($toNumber(t)))<=99)
?1900+(%_IsSmi(%IS_VAR(t))?t:%NumberToInteger($toNumber(t))):t;
var l=(%_DateField(this,0)+%_DateField(this,21));
var u,v,n;
if((!%_IsSmi(%IS_VAR(l))&&!(l==l))){
u=0;
v=1;
n=0;
}else{
u=(%_DateField(this,2));
v=(%_DateField(this,3));
n=(%_DateField(this,10));
}
var w=MakeDay(t,u,v);
return(%DateSetValue(this,MakeDate(w,n),0));
}
function DateToGMTString(){
return %_CallFunction(this,DateToUTCString);
}
function PadInt(P,Q){
if(Q==1)return P;
return P<%_MathPow(10,Q-1)?'0'+PadInt(P,Q-1):P;
}
function DateToISOString(){
%_ThrowIfNotADate(this);
var l=(%_DateField(this,0));
if((!%_IsSmi(%IS_VAR(l))&&!(l==l)))throw MakeRangeError(137);
var t=this.getUTCFullYear();
var R;
if(t>=0&&t<=9999){
R=PadInt(t,4);
}else{
if(t<0){
R="-"+PadInt(-t,6);
}else{
R="+"+PadInt(t,6);
}
}
return R+
'-'+PadInt(this.getUTCMonth()+1,2)+
'-'+PadInt(this.getUTCDate(),2)+
'T'+PadInt(this.getUTCHours(),2)+
':'+PadInt(this.getUTCMinutes(),2)+
':'+PadInt(this.getUTCSeconds(),2)+
'.'+PadInt(this.getUTCMilliseconds(),3)+
'Z';
}
function DateToJSON(S){
var T=$toObject(this);
var U=$defaultNumber(T);
if((typeof(U)==='number')&&!(%_IsSmi(%IS_VAR(U))||((U==U)&&(U!=1/0)&&(U!=-1/0)))){
return null;
}
return T.toISOString();
}
var V;
var W=$NaN;
function CheckDateCacheCurrent(){
if(!V){
V=%DateCacheVersion();
if(!V)return;
}
if(V[0]==W){
return;
}
W=V[0];
j=$NaN;
k=(void 0);
x.time=$NaN;
x.string=null;
}
function CreateDate(n){
var v=new c();
v.setTime(n);
return v;
}
%SetCode(c,DateConstructor);
%FunctionSetPrototype(c,new c($NaN));
b.InstallFunctions(c,2,[
"UTC",DateUTC,
"parse",DateParse,
"now",DateNow
]);
%AddNamedProperty(c.prototype,"constructor",c,2);
b.InstallFunctions(c.prototype,2,[
"toString",DateToString,
"toDateString",DateToDateString,
"toTimeString",DateToTimeString,
"toLocaleString",DateToLocaleString,
"toLocaleDateString",DateToLocaleDateString,
"toLocaleTimeString",DateToLocaleTimeString,
"valueOf",DateValueOf,
"getTime",DateGetTime,
"getFullYear",DateGetFullYear,
"getUTCFullYear",DateGetUTCFullYear,
"getMonth",DateGetMonth,
"getUTCMonth",DateGetUTCMonth,
"getDate",DateGetDate,
"getUTCDate",DateGetUTCDate,
"getDay",DateGetDay,
"getUTCDay",DateGetUTCDay,
"getHours",DateGetHours,
"getUTCHours",DateGetUTCHours,
"getMinutes",DateGetMinutes,
"getUTCMinutes",DateGetUTCMinutes,
"getSeconds",DateGetSeconds,
"getUTCSeconds",DateGetUTCSeconds,
"getMilliseconds",DateGetMilliseconds,
"getUTCMilliseconds",DateGetUTCMilliseconds,
"getTimezoneOffset",DateGetTimezoneOffset,
"setTime",DateSetTime,
"setMilliseconds",DateSetMilliseconds,
"setUTCMilliseconds",DateSetUTCMilliseconds,
"setSeconds",DateSetSeconds,
"setUTCSeconds",DateSetUTCSeconds,
"setMinutes",DateSetMinutes,
"setUTCMinutes",DateSetUTCMinutes,
"setHours",DateSetHours,
"setUTCHours",DateSetUTCHours,
"setDate",DateSetDate,
"setUTCDate",DateSetUTCDate,
"setMonth",DateSetMonth,
"setUTCMonth",DateSetUTCMonth,
"setFullYear",DateSetFullYear,
"setUTCFullYear",DateSetUTCFullYear,
"toGMTString",DateToGMTString,
"toUTCString",DateToUTCString,
"getYear",DateGetYear,
"setYear",DateSetYear,
"toISOString",DateToISOString,
"toJSON",DateToJSON
]);
$createDate=CreateDate;
})

regexp¥e
var $regexpLastMatchInfoOverride;
var harmony_regexps=false;
var harmony_unicode_regexps=false;
(function(a,b){
%CheckIsBootstrapping();
var c=a.RegExp;
var d=b.InternalPackedArray;
var e=new d(
2,
"",
(void 0),
0,
0
);
$regexpLastMatchInfoOverride=null;
function DoConstructRegExp(g,h,i){
if((%_IsRegExp(h))){
if(!(i===(void 0)))throw MakeTypeError(93);
i=(h.global?'g':'')
+(h.ignoreCase?'i':'')
+(h.multiline?'m':'');
if(harmony_unicode_regexps)
i+=(h.unicode?'u':'');
if(harmony_regexps)
i+=(h.sticky?'y':'');
h=h.source;
}
h=(h===(void 0))?'':$toString(h);
i=(i===(void 0))?'':$toString(i);
%RegExpInitializeAndCompile(g,h,i);
}
function RegExpConstructor(h,i){
if(%_IsConstructCall()){
DoConstructRegExp(this,h,i);
}else{
if((%_IsRegExp(h))&&(i===(void 0))){
return h;
}
return new c(h,i);
}
}
function RegExpCompileJS(h,i){
if(this==c.prototype){
throw MakeTypeError(33,
'RegExp.prototype.compile',this);
}
if((h===(void 0))&&%_ArgumentsLength()!=0){
DoConstructRegExp(this,'undefined',i);
}else{
DoConstructRegExp(this,h,i);
}
}
function DoRegExpExec(j,k,l){
var m=%_RegExpExec(j,k,l,e);
if(m!==null)$regexpLastMatchInfoOverride=null;
return m;
}
function RegExpExecNoTests(j,k,n){
var o=%_RegExpExec(j,k,n,e);
if(o!==null){
$regexpLastMatchInfoOverride=null;
var p=((o)[0])>>1;
var n=o[3];
var q=o[4];
var r=%_SubString(k,n,q);
var m=%_RegExpConstructResult(p,n,k);
m[0]=r;
if(p==1)return m;
var t=3+2;
for(var u=1;u<p;u++){
n=o[t++];
if(n!=-1){
q=o[t];
m[u]=%_SubString(k,n,q);
}
t++;
}
return m;
;
}
j.lastIndex=0;
return null;
}
function RegExpExecJS(k){
if(!(%_IsRegExp(this))){
throw MakeTypeError(33,
'RegExp.prototype.exec',this);
}
k=((typeof(%IS_VAR(k))==='string')?k:$nonStringToString(k));
var v=this.lastIndex;
var u=(%_IsSmi(%IS_VAR(v))?v:%NumberToInteger($toNumber(v)));
var w=this.global||(harmony_regexps&&this.sticky);
if(w){
if(u<0||u>k.length){
this.lastIndex=0;
return null;
}
}else{
u=0;
}
var x=%_RegExpExec(this,k,u,e);
if((x===null)){
this.lastIndex=0;
return null;
}
$regexpLastMatchInfoOverride=null;
if(w){
this.lastIndex=e[4];
}
var p=((x)[0])>>1;
var n=x[3];
var q=x[4];
var r=%_SubString(k,n,q);
var m=%_RegExpConstructResult(p,n,k);
m[0]=r;
if(p==1)return m;
var t=3+2;
for(var u=1;u<p;u++){
n=x[t++];
if(n!=-1){
q=x[t];
m[u]=%_SubString(k,n,q);
}
t++;
}
return m;
;
}
var y;
var z;
function RegExpTest(k){
if(!(%_IsRegExp(this))){
throw MakeTypeError(33,
'RegExp.prototype.test',this);
}
k=((typeof(%IS_VAR(k))==='string')?k:$nonStringToString(k));
var v=this.lastIndex;
var u=(%_IsSmi(%IS_VAR(v))?v:%NumberToInteger($toNumber(v)));
if(this.global||(harmony_regexps&&this.sticky)){
if(u<0||u>k.length){
this.lastIndex=0;
return false;
}
var x=%_RegExpExec(this,k,u,e);
if((x===null)){
this.lastIndex=0;
return false;
}
$regexpLastMatchInfoOverride=null;
this.lastIndex=e[4];
return true;
}else{
var j=this;
if(j.source.length>=3&&
%_StringCharCodeAt(j.source,0)==46&&
%_StringCharCodeAt(j.source,1)==42&&
%_StringCharCodeAt(j.source,2)!=63){
j=TrimRegExp(j);
}
var x=%_RegExpExec(j,k,0,e);
if((x===null)){
this.lastIndex=0;
return false;
}
$regexpLastMatchInfoOverride=null;
return true;
}
}
function TrimRegExp(j){
if(!%_ObjectEquals(y,j)){
y=j;
z=
new c(%_SubString(j.source,2,j.source.length),
(j.ignoreCase?j.multiline?"im":"i"
:j.multiline?"m":""));
}
return z;
}
function RegExpToString(){
if(!(%_IsRegExp(this))){
throw MakeTypeError(33,
'RegExp.prototype.toString',this);
}
var m='/'+this.source+'/';
if(this.global)m+='g';
if(this.ignoreCase)m+='i';
if(this.multiline)m+='m';
if(harmony_unicode_regexps&&this.unicode)m+='u';
if(harmony_regexps&&this.sticky)m+='y';
return m;
}
function RegExpGetLastMatch(){
if($regexpLastMatchInfoOverride!==null){
return(($regexpLastMatchInfoOverride)[0]);
}
var A=((e)[1]);
return %_SubString(A,
e[3],
e[4]);
}
function RegExpGetLastParen(){
if($regexpLastMatchInfoOverride){
var B=$regexpLastMatchInfoOverride;
if(B.length<=3)return'';
return B[B.length-3];
}
var C=((e)[0]);
if(C<=2)return'';
var A=((e)[1]);
var n=e[(3+(C-2))];
var q=e[(3+(C-1))];
if(n!=-1&&q!=-1){
return %_SubString(A,n,q);
}
return"";
}
function RegExpGetLeftContext(){
var D;
var E;
if(!$regexpLastMatchInfoOverride){
D=e[3];
E=((e)[1]);
}else{
var B=$regexpLastMatchInfoOverride;
D=((B)[(B).length-2]);
E=((B)[(B).length-1]);
}
return %_SubString(E,0,D);
}
function RegExpGetRightContext(){
var D;
var E;
if(!$regexpLastMatchInfoOverride){
D=e[4];
E=((e)[1]);
}else{
var B=$regexpLastMatchInfoOverride;
E=((B)[(B).length-1]);
var F=((B)[0]);
D=((B)[(B).length-2])+F.length;
}
return %_SubString(E,D,E.length);
}
function RegExpMakeCaptureGetter(G){
return function foo(){
if($regexpLastMatchInfoOverride){
if(G<$regexpLastMatchInfoOverride.length-2){
return(($regexpLastMatchInfoOverride)[(G)]);
}
return'';
}
var l=G*2;
if(l>=((e)[0]))return'';
var H=e[(3+(l))];
var I=e[(3+(l+1))];
if(H==-1||I==-1)return'';
return %_SubString(((e)[1]),H,I);
};
}
%FunctionSetInstanceClassName(c,'RegExp');
%AddNamedProperty(
c.prototype,'constructor',c,2);
%SetCode(c,RegExpConstructor);
b.InstallFunctions(c.prototype,2,[
"exec",RegExpExecJS,
"test",RegExpTest,
"toString",RegExpToString,
"compile",RegExpCompileJS
]);
%FunctionSetLength(c.prototype.compile,1);
var J=function(){
var K=((e)[2]);
return(K===(void 0))?"":K;
};
var L=function(k){
((e)[2])=$toString(k);
};
%OptimizeObjectForAddingMultipleProperties(c,22);
%DefineAccessorPropertyUnchecked(c,'input',J,
L,4);
%DefineAccessorPropertyUnchecked(c,'$_',J,
L,2|4);
var M=false;
var N=function(){return M;};
var O=function(P){M=P?true:false;};
%DefineAccessorPropertyUnchecked(c,'multiline',N,
O,4);
%DefineAccessorPropertyUnchecked(c,'$*',N,
O,
2|4);
var Q=function(R){};
%DefineAccessorPropertyUnchecked(c,'lastMatch',RegExpGetLastMatch,
Q,4);
%DefineAccessorPropertyUnchecked(c,'$&',RegExpGetLastMatch,
Q,2|4);
%DefineAccessorPropertyUnchecked(c,'lastParen',RegExpGetLastParen,
Q,4);
%DefineAccessorPropertyUnchecked(c,'$+',RegExpGetLastParen,
Q,2|4);
%DefineAccessorPropertyUnchecked(c,'leftContext',
RegExpGetLeftContext,Q,
4);
%DefineAccessorPropertyUnchecked(c,'$`',RegExpGetLeftContext,
Q,2|4);
%DefineAccessorPropertyUnchecked(c,'rightContext',
RegExpGetRightContext,Q,
4);
%DefineAccessorPropertyUnchecked(c,"$'",RegExpGetRightContext,
Q,2|4);
for(var u=1;u<10;++u){
%DefineAccessorPropertyUnchecked(c,'$'+u,
RegExpMakeCaptureGetter(u),Q,
4);
}
%ToFastProperties(c);
b.Export(function(S){
S.RegExpExec=DoRegExpExec;
S.RegExpExecNoTests=RegExpExecNoTests;
S.RegExpLastMatchInfo=e;
});
})

,arraybufferi
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.ArrayBuffer;
var d=a.Object;
var e;
var g;
b.Import(function(h){
e=h.MathMax;
g=h.MathMin;
});
function ArrayBufferConstructor(i){
if(%_IsConstructCall()){
var j=$toPositiveInteger(i,125);
%ArrayBufferInitialize(this,j,false);
}else{
throw MakeTypeError(20,"ArrayBuffer");
}
}
function ArrayBufferGetByteLen(){
if(!(%_ClassOf(this)==='ArrayBuffer')){
throw MakeTypeError(33,
'ArrayBuffer.prototype.byteLength',this);
}
return %_ArrayBufferGetByteLength(this);
}
function ArrayBufferSlice(k,l){
if(!(%_ClassOf(this)==='ArrayBuffer')){
throw MakeTypeError(33,
'ArrayBuffer.prototype.slice',this);
}
var m=(%_IsSmi(%IS_VAR(k))?k:%NumberToInteger($toNumber(k)));
if(!(l===(void 0))){
l=(%_IsSmi(%IS_VAR(l))?l:%NumberToInteger($toNumber(l)));
}
var n;
var o=%_ArrayBufferGetByteLength(this);
if(m<0){
n=e(o+m,0);
}else{
n=g(m,o);
}
var p=(l===(void 0))?o:l;
var q;
if(p<0){
q=e(o+p,0);
}else{
q=g(p,o);
}
if(q<n){
q=n;
}
var r=q-n;
var t=new c(r);
%ArrayBufferSliceImpl(this,t,n);
return t;
}
function ArrayBufferIsViewJS(u){
return %ArrayBufferIsView(u);
}
%SetCode(c,ArrayBufferConstructor);
%FunctionSetPrototype(c,new d());
%AddNamedProperty(
c.prototype,"constructor",c,2);
%AddNamedProperty(c.prototype,
symbolToStringTag,"ArrayBuffer",2|1);
b.InstallGetter(c.prototype,"byteLength",ArrayBufferGetByteLen);
b.InstallFunctions(c,2,[
"isView",ArrayBufferIsViewJS
]);
b.InstallFunctions(c.prototype,2,[
"slice",ArrayBufferSlice
]);
})

(typedarray{
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Array;
var d=a.ArrayBuffer;
var e=a.DataView;
var g=a.Object;
var h=a.Uint8Array;

var i=a.Int8Array;

var j=a.Uint16Array;

var k=a.Int16Array;

var l=a.Uint32Array;

var m=a.Int32Array;

var n=a.Float32Array;

var o=a.Float64Array;

var p=a.Uint8ClampedArray;


var q;
var r;
b.Import(function(t){
q=t.MathMax;
r=t.MathMin;
});
function Uint8ArrayConstructByArrayBuffer(u,v,w,x){
if(!(w===(void 0))){
w=
$toPositiveInteger(w,139);
}
if(!(x===(void 0))){
x=$toPositiveInteger(x,139);
}
var y=%_ArrayBufferGetByteLength(v);
var z;
if((w===(void 0))){
z=0;
}else{
z=w;
if(z % 1!==0){
throw MakeRangeError(138,
"start offset","Uint8Array",1);
}
if(z>y){
throw MakeRangeError(140);
}
}
var A;
var B;
if((x===(void 0))){
if(y % 1!==0){
throw MakeRangeError(138,
"byte length","Uint8Array",1);
}
A=y-z;
B=A/1;
}else{
var B=x;
A=B*1;
}
if((z+A>y)
||(B>%_MaxSmi())){
throw MakeRangeError(139);
}
%_TypedArrayInitialize(u,1,v,z,A,true);
}
function Uint8ArrayConstructByLength(u,x){
var C=(x===(void 0))?
0:$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var D=C*1;
if(D>%_TypedArrayMaxSizeInHeap()){
var v=new d(D);
%_TypedArrayInitialize(u,1,v,0,D,true);
}else{
%_TypedArrayInitialize(u,1,null,0,D,true);
}
}
function Uint8ArrayConstructByArrayLike(u,E){
var x=E.length;
var C=$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var F=false;
var D=C*1;
if(D<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(u,1,null,0,D,false);
}else{
F=
%TypedArrayInitializeFromArrayLike(u,1,E,C);
}
if(!F){
for(var G=0;G<C;G++){
u[G]=E[G];
}
}
}
function Uint8ArrayConstructor(H,I,J){
if(%_IsConstructCall()){
if((%_ClassOf(H)==='ArrayBuffer')||(%_ClassOf(H)==='SharedArrayBuffer')){
Uint8ArrayConstructByArrayBuffer(this,H,I,J);
}else if((typeof(H)==='number')||(typeof(H)==='string')||
(typeof(H)==='boolean')||(H===(void 0))){
Uint8ArrayConstructByLength(this,H);
}else{
Uint8ArrayConstructByArrayLike(this,H);
}
}else{
throw MakeTypeError(20,"Uint8Array")
}
}
function Uint8Array_GetBuffer(){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(33,"Uint8Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Uint8Array_GetByteLength(){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(33,"Uint8Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Uint8Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(33,"Uint8Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Uint8Array_GetLength(){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(33,"Uint8Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Uint8ArraySubArray(K,L){
if(!(%_ClassOf(this)==='Uint8Array')){
throw MakeTypeError(33,"Uint8Array.subarray",this);
}
var M=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(!(L===(void 0))){
L=(%_IsSmi(%IS_VAR(L))?L:%NumberToInteger($toNumber(L)));
}
var N=%_TypedArrayGetLength(this);
if(M<0){
M=q(0,N+M);
}else{
M=r(N,M);
}
var O=(L===(void 0))?N:L;
if(O<0){
O=q(0,N+O);
}else{
O=r(O,N);
}
if(O<M){
O=M;
}
var B=O-M;
var P=
%_ArrayBufferViewGetByteOffset(this)+M*1;
return new h(%TypedArrayGetBuffer(this),
P,B);
}

function Int8ArrayConstructByArrayBuffer(u,v,w,x){
if(!(w===(void 0))){
w=
$toPositiveInteger(w,139);
}
if(!(x===(void 0))){
x=$toPositiveInteger(x,139);
}
var y=%_ArrayBufferGetByteLength(v);
var z;
if((w===(void 0))){
z=0;
}else{
z=w;
if(z % 1!==0){
throw MakeRangeError(138,
"start offset","Int8Array",1);
}
if(z>y){
throw MakeRangeError(140);
}
}
var A;
var B;
if((x===(void 0))){
if(y % 1!==0){
throw MakeRangeError(138,
"byte length","Int8Array",1);
}
A=y-z;
B=A/1;
}else{
var B=x;
A=B*1;
}
if((z+A>y)
||(B>%_MaxSmi())){
throw MakeRangeError(139);
}
%_TypedArrayInitialize(u,2,v,z,A,true);
}
function Int8ArrayConstructByLength(u,x){
var C=(x===(void 0))?
0:$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var D=C*1;
if(D>%_TypedArrayMaxSizeInHeap()){
var v=new d(D);
%_TypedArrayInitialize(u,2,v,0,D,true);
}else{
%_TypedArrayInitialize(u,2,null,0,D,true);
}
}
function Int8ArrayConstructByArrayLike(u,E){
var x=E.length;
var C=$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var F=false;
var D=C*1;
if(D<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(u,2,null,0,D,false);
}else{
F=
%TypedArrayInitializeFromArrayLike(u,2,E,C);
}
if(!F){
for(var G=0;G<C;G++){
u[G]=E[G];
}
}
}
function Int8ArrayConstructor(H,I,J){
if(%_IsConstructCall()){
if((%_ClassOf(H)==='ArrayBuffer')||(%_ClassOf(H)==='SharedArrayBuffer')){
Int8ArrayConstructByArrayBuffer(this,H,I,J);
}else if((typeof(H)==='number')||(typeof(H)==='string')||
(typeof(H)==='boolean')||(H===(void 0))){
Int8ArrayConstructByLength(this,H);
}else{
Int8ArrayConstructByArrayLike(this,H);
}
}else{
throw MakeTypeError(20,"Int8Array")
}
}
function Int8Array_GetBuffer(){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(33,"Int8Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Int8Array_GetByteLength(){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(33,"Int8Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Int8Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(33,"Int8Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Int8Array_GetLength(){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(33,"Int8Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Int8ArraySubArray(K,L){
if(!(%_ClassOf(this)==='Int8Array')){
throw MakeTypeError(33,"Int8Array.subarray",this);
}
var M=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(!(L===(void 0))){
L=(%_IsSmi(%IS_VAR(L))?L:%NumberToInteger($toNumber(L)));
}
var N=%_TypedArrayGetLength(this);
if(M<0){
M=q(0,N+M);
}else{
M=r(N,M);
}
var O=(L===(void 0))?N:L;
if(O<0){
O=q(0,N+O);
}else{
O=r(O,N);
}
if(O<M){
O=M;
}
var B=O-M;
var P=
%_ArrayBufferViewGetByteOffset(this)+M*1;
return new i(%TypedArrayGetBuffer(this),
P,B);
}

function Uint16ArrayConstructByArrayBuffer(u,v,w,x){
if(!(w===(void 0))){
w=
$toPositiveInteger(w,139);
}
if(!(x===(void 0))){
x=$toPositiveInteger(x,139);
}
var y=%_ArrayBufferGetByteLength(v);
var z;
if((w===(void 0))){
z=0;
}else{
z=w;
if(z % 2!==0){
throw MakeRangeError(138,
"start offset","Uint16Array",2);
}
if(z>y){
throw MakeRangeError(140);
}
}
var A;
var B;
if((x===(void 0))){
if(y % 2!==0){
throw MakeRangeError(138,
"byte length","Uint16Array",2);
}
A=y-z;
B=A/2;
}else{
var B=x;
A=B*2;
}
if((z+A>y)
||(B>%_MaxSmi())){
throw MakeRangeError(139);
}
%_TypedArrayInitialize(u,3,v,z,A,true);
}
function Uint16ArrayConstructByLength(u,x){
var C=(x===(void 0))?
0:$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var D=C*2;
if(D>%_TypedArrayMaxSizeInHeap()){
var v=new d(D);
%_TypedArrayInitialize(u,3,v,0,D,true);
}else{
%_TypedArrayInitialize(u,3,null,0,D,true);
}
}
function Uint16ArrayConstructByArrayLike(u,E){
var x=E.length;
var C=$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var F=false;
var D=C*2;
if(D<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(u,3,null,0,D,false);
}else{
F=
%TypedArrayInitializeFromArrayLike(u,3,E,C);
}
if(!F){
for(var G=0;G<C;G++){
u[G]=E[G];
}
}
}
function Uint16ArrayConstructor(H,I,J){
if(%_IsConstructCall()){
if((%_ClassOf(H)==='ArrayBuffer')||(%_ClassOf(H)==='SharedArrayBuffer')){
Uint16ArrayConstructByArrayBuffer(this,H,I,J);
}else if((typeof(H)==='number')||(typeof(H)==='string')||
(typeof(H)==='boolean')||(H===(void 0))){
Uint16ArrayConstructByLength(this,H);
}else{
Uint16ArrayConstructByArrayLike(this,H);
}
}else{
throw MakeTypeError(20,"Uint16Array")
}
}
function Uint16Array_GetBuffer(){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(33,"Uint16Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Uint16Array_GetByteLength(){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(33,"Uint16Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Uint16Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(33,"Uint16Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Uint16Array_GetLength(){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(33,"Uint16Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Uint16ArraySubArray(K,L){
if(!(%_ClassOf(this)==='Uint16Array')){
throw MakeTypeError(33,"Uint16Array.subarray",this);
}
var M=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(!(L===(void 0))){
L=(%_IsSmi(%IS_VAR(L))?L:%NumberToInteger($toNumber(L)));
}
var N=%_TypedArrayGetLength(this);
if(M<0){
M=q(0,N+M);
}else{
M=r(N,M);
}
var O=(L===(void 0))?N:L;
if(O<0){
O=q(0,N+O);
}else{
O=r(O,N);
}
if(O<M){
O=M;
}
var B=O-M;
var P=
%_ArrayBufferViewGetByteOffset(this)+M*2;
return new j(%TypedArrayGetBuffer(this),
P,B);
}

function Int16ArrayConstructByArrayBuffer(u,v,w,x){
if(!(w===(void 0))){
w=
$toPositiveInteger(w,139);
}
if(!(x===(void 0))){
x=$toPositiveInteger(x,139);
}
var y=%_ArrayBufferGetByteLength(v);
var z;
if((w===(void 0))){
z=0;
}else{
z=w;
if(z % 2!==0){
throw MakeRangeError(138,
"start offset","Int16Array",2);
}
if(z>y){
throw MakeRangeError(140);
}
}
var A;
var B;
if((x===(void 0))){
if(y % 2!==0){
throw MakeRangeError(138,
"byte length","Int16Array",2);
}
A=y-z;
B=A/2;
}else{
var B=x;
A=B*2;
}
if((z+A>y)
||(B>%_MaxSmi())){
throw MakeRangeError(139);
}
%_TypedArrayInitialize(u,4,v,z,A,true);
}
function Int16ArrayConstructByLength(u,x){
var C=(x===(void 0))?
0:$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var D=C*2;
if(D>%_TypedArrayMaxSizeInHeap()){
var v=new d(D);
%_TypedArrayInitialize(u,4,v,0,D,true);
}else{
%_TypedArrayInitialize(u,4,null,0,D,true);
}
}
function Int16ArrayConstructByArrayLike(u,E){
var x=E.length;
var C=$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var F=false;
var D=C*2;
if(D<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(u,4,null,0,D,false);
}else{
F=
%TypedArrayInitializeFromArrayLike(u,4,E,C);
}
if(!F){
for(var G=0;G<C;G++){
u[G]=E[G];
}
}
}
function Int16ArrayConstructor(H,I,J){
if(%_IsConstructCall()){
if((%_ClassOf(H)==='ArrayBuffer')||(%_ClassOf(H)==='SharedArrayBuffer')){
Int16ArrayConstructByArrayBuffer(this,H,I,J);
}else if((typeof(H)==='number')||(typeof(H)==='string')||
(typeof(H)==='boolean')||(H===(void 0))){
Int16ArrayConstructByLength(this,H);
}else{
Int16ArrayConstructByArrayLike(this,H);
}
}else{
throw MakeTypeError(20,"Int16Array")
}
}
function Int16Array_GetBuffer(){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(33,"Int16Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Int16Array_GetByteLength(){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(33,"Int16Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Int16Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(33,"Int16Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Int16Array_GetLength(){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(33,"Int16Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Int16ArraySubArray(K,L){
if(!(%_ClassOf(this)==='Int16Array')){
throw MakeTypeError(33,"Int16Array.subarray",this);
}
var M=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(!(L===(void 0))){
L=(%_IsSmi(%IS_VAR(L))?L:%NumberToInteger($toNumber(L)));
}
var N=%_TypedArrayGetLength(this);
if(M<0){
M=q(0,N+M);
}else{
M=r(N,M);
}
var O=(L===(void 0))?N:L;
if(O<0){
O=q(0,N+O);
}else{
O=r(O,N);
}
if(O<M){
O=M;
}
var B=O-M;
var P=
%_ArrayBufferViewGetByteOffset(this)+M*2;
return new k(%TypedArrayGetBuffer(this),
P,B);
}

function Uint32ArrayConstructByArrayBuffer(u,v,w,x){
if(!(w===(void 0))){
w=
$toPositiveInteger(w,139);
}
if(!(x===(void 0))){
x=$toPositiveInteger(x,139);
}
var y=%_ArrayBufferGetByteLength(v);
var z;
if((w===(void 0))){
z=0;
}else{
z=w;
if(z % 4!==0){
throw MakeRangeError(138,
"start offset","Uint32Array",4);
}
if(z>y){
throw MakeRangeError(140);
}
}
var A;
var B;
if((x===(void 0))){
if(y % 4!==0){
throw MakeRangeError(138,
"byte length","Uint32Array",4);
}
A=y-z;
B=A/4;
}else{
var B=x;
A=B*4;
}
if((z+A>y)
||(B>%_MaxSmi())){
throw MakeRangeError(139);
}
%_TypedArrayInitialize(u,5,v,z,A,true);
}
function Uint32ArrayConstructByLength(u,x){
var C=(x===(void 0))?
0:$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var D=C*4;
if(D>%_TypedArrayMaxSizeInHeap()){
var v=new d(D);
%_TypedArrayInitialize(u,5,v,0,D,true);
}else{
%_TypedArrayInitialize(u,5,null,0,D,true);
}
}
function Uint32ArrayConstructByArrayLike(u,E){
var x=E.length;
var C=$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var F=false;
var D=C*4;
if(D<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(u,5,null,0,D,false);
}else{
F=
%TypedArrayInitializeFromArrayLike(u,5,E,C);
}
if(!F){
for(var G=0;G<C;G++){
u[G]=E[G];
}
}
}
function Uint32ArrayConstructor(H,I,J){
if(%_IsConstructCall()){
if((%_ClassOf(H)==='ArrayBuffer')||(%_ClassOf(H)==='SharedArrayBuffer')){
Uint32ArrayConstructByArrayBuffer(this,H,I,J);
}else if((typeof(H)==='number')||(typeof(H)==='string')||
(typeof(H)==='boolean')||(H===(void 0))){
Uint32ArrayConstructByLength(this,H);
}else{
Uint32ArrayConstructByArrayLike(this,H);
}
}else{
throw MakeTypeError(20,"Uint32Array")
}
}
function Uint32Array_GetBuffer(){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(33,"Uint32Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Uint32Array_GetByteLength(){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(33,"Uint32Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Uint32Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(33,"Uint32Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Uint32Array_GetLength(){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(33,"Uint32Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Uint32ArraySubArray(K,L){
if(!(%_ClassOf(this)==='Uint32Array')){
throw MakeTypeError(33,"Uint32Array.subarray",this);
}
var M=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(!(L===(void 0))){
L=(%_IsSmi(%IS_VAR(L))?L:%NumberToInteger($toNumber(L)));
}
var N=%_TypedArrayGetLength(this);
if(M<0){
M=q(0,N+M);
}else{
M=r(N,M);
}
var O=(L===(void 0))?N:L;
if(O<0){
O=q(0,N+O);
}else{
O=r(O,N);
}
if(O<M){
O=M;
}
var B=O-M;
var P=
%_ArrayBufferViewGetByteOffset(this)+M*4;
return new l(%TypedArrayGetBuffer(this),
P,B);
}

function Int32ArrayConstructByArrayBuffer(u,v,w,x){
if(!(w===(void 0))){
w=
$toPositiveInteger(w,139);
}
if(!(x===(void 0))){
x=$toPositiveInteger(x,139);
}
var y=%_ArrayBufferGetByteLength(v);
var z;
if((w===(void 0))){
z=0;
}else{
z=w;
if(z % 4!==0){
throw MakeRangeError(138,
"start offset","Int32Array",4);
}
if(z>y){
throw MakeRangeError(140);
}
}
var A;
var B;
if((x===(void 0))){
if(y % 4!==0){
throw MakeRangeError(138,
"byte length","Int32Array",4);
}
A=y-z;
B=A/4;
}else{
var B=x;
A=B*4;
}
if((z+A>y)
||(B>%_MaxSmi())){
throw MakeRangeError(139);
}
%_TypedArrayInitialize(u,6,v,z,A,true);
}
function Int32ArrayConstructByLength(u,x){
var C=(x===(void 0))?
0:$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var D=C*4;
if(D>%_TypedArrayMaxSizeInHeap()){
var v=new d(D);
%_TypedArrayInitialize(u,6,v,0,D,true);
}else{
%_TypedArrayInitialize(u,6,null,0,D,true);
}
}
function Int32ArrayConstructByArrayLike(u,E){
var x=E.length;
var C=$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var F=false;
var D=C*4;
if(D<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(u,6,null,0,D,false);
}else{
F=
%TypedArrayInitializeFromArrayLike(u,6,E,C);
}
if(!F){
for(var G=0;G<C;G++){
u[G]=E[G];
}
}
}
function Int32ArrayConstructor(H,I,J){
if(%_IsConstructCall()){
if((%_ClassOf(H)==='ArrayBuffer')||(%_ClassOf(H)==='SharedArrayBuffer')){
Int32ArrayConstructByArrayBuffer(this,H,I,J);
}else if((typeof(H)==='number')||(typeof(H)==='string')||
(typeof(H)==='boolean')||(H===(void 0))){
Int32ArrayConstructByLength(this,H);
}else{
Int32ArrayConstructByArrayLike(this,H);
}
}else{
throw MakeTypeError(20,"Int32Array")
}
}
function Int32Array_GetBuffer(){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(33,"Int32Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Int32Array_GetByteLength(){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(33,"Int32Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Int32Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(33,"Int32Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Int32Array_GetLength(){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(33,"Int32Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Int32ArraySubArray(K,L){
if(!(%_ClassOf(this)==='Int32Array')){
throw MakeTypeError(33,"Int32Array.subarray",this);
}
var M=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(!(L===(void 0))){
L=(%_IsSmi(%IS_VAR(L))?L:%NumberToInteger($toNumber(L)));
}
var N=%_TypedArrayGetLength(this);
if(M<0){
M=q(0,N+M);
}else{
M=r(N,M);
}
var O=(L===(void 0))?N:L;
if(O<0){
O=q(0,N+O);
}else{
O=r(O,N);
}
if(O<M){
O=M;
}
var B=O-M;
var P=
%_ArrayBufferViewGetByteOffset(this)+M*4;
return new m(%TypedArrayGetBuffer(this),
P,B);
}

function Float32ArrayConstructByArrayBuffer(u,v,w,x){
if(!(w===(void 0))){
w=
$toPositiveInteger(w,139);
}
if(!(x===(void 0))){
x=$toPositiveInteger(x,139);
}
var y=%_ArrayBufferGetByteLength(v);
var z;
if((w===(void 0))){
z=0;
}else{
z=w;
if(z % 4!==0){
throw MakeRangeError(138,
"start offset","Float32Array",4);
}
if(z>y){
throw MakeRangeError(140);
}
}
var A;
var B;
if((x===(void 0))){
if(y % 4!==0){
throw MakeRangeError(138,
"byte length","Float32Array",4);
}
A=y-z;
B=A/4;
}else{
var B=x;
A=B*4;
}
if((z+A>y)
||(B>%_MaxSmi())){
throw MakeRangeError(139);
}
%_TypedArrayInitialize(u,7,v,z,A,true);
}
function Float32ArrayConstructByLength(u,x){
var C=(x===(void 0))?
0:$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var D=C*4;
if(D>%_TypedArrayMaxSizeInHeap()){
var v=new d(D);
%_TypedArrayInitialize(u,7,v,0,D,true);
}else{
%_TypedArrayInitialize(u,7,null,0,D,true);
}
}
function Float32ArrayConstructByArrayLike(u,E){
var x=E.length;
var C=$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var F=false;
var D=C*4;
if(D<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(u,7,null,0,D,false);
}else{
F=
%TypedArrayInitializeFromArrayLike(u,7,E,C);
}
if(!F){
for(var G=0;G<C;G++){
u[G]=E[G];
}
}
}
function Float32ArrayConstructor(H,I,J){
if(%_IsConstructCall()){
if((%_ClassOf(H)==='ArrayBuffer')||(%_ClassOf(H)==='SharedArrayBuffer')){
Float32ArrayConstructByArrayBuffer(this,H,I,J);
}else if((typeof(H)==='number')||(typeof(H)==='string')||
(typeof(H)==='boolean')||(H===(void 0))){
Float32ArrayConstructByLength(this,H);
}else{
Float32ArrayConstructByArrayLike(this,H);
}
}else{
throw MakeTypeError(20,"Float32Array")
}
}
function Float32Array_GetBuffer(){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(33,"Float32Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Float32Array_GetByteLength(){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(33,"Float32Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Float32Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(33,"Float32Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Float32Array_GetLength(){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(33,"Float32Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Float32ArraySubArray(K,L){
if(!(%_ClassOf(this)==='Float32Array')){
throw MakeTypeError(33,"Float32Array.subarray",this);
}
var M=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(!(L===(void 0))){
L=(%_IsSmi(%IS_VAR(L))?L:%NumberToInteger($toNumber(L)));
}
var N=%_TypedArrayGetLength(this);
if(M<0){
M=q(0,N+M);
}else{
M=r(N,M);
}
var O=(L===(void 0))?N:L;
if(O<0){
O=q(0,N+O);
}else{
O=r(O,N);
}
if(O<M){
O=M;
}
var B=O-M;
var P=
%_ArrayBufferViewGetByteOffset(this)+M*4;
return new n(%TypedArrayGetBuffer(this),
P,B);
}

function Float64ArrayConstructByArrayBuffer(u,v,w,x){
if(!(w===(void 0))){
w=
$toPositiveInteger(w,139);
}
if(!(x===(void 0))){
x=$toPositiveInteger(x,139);
}
var y=%_ArrayBufferGetByteLength(v);
var z;
if((w===(void 0))){
z=0;
}else{
z=w;
if(z % 8!==0){
throw MakeRangeError(138,
"start offset","Float64Array",8);
}
if(z>y){
throw MakeRangeError(140);
}
}
var A;
var B;
if((x===(void 0))){
if(y % 8!==0){
throw MakeRangeError(138,
"byte length","Float64Array",8);
}
A=y-z;
B=A/8;
}else{
var B=x;
A=B*8;
}
if((z+A>y)
||(B>%_MaxSmi())){
throw MakeRangeError(139);
}
%_TypedArrayInitialize(u,8,v,z,A,true);
}
function Float64ArrayConstructByLength(u,x){
var C=(x===(void 0))?
0:$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var D=C*8;
if(D>%_TypedArrayMaxSizeInHeap()){
var v=new d(D);
%_TypedArrayInitialize(u,8,v,0,D,true);
}else{
%_TypedArrayInitialize(u,8,null,0,D,true);
}
}
function Float64ArrayConstructByArrayLike(u,E){
var x=E.length;
var C=$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var F=false;
var D=C*8;
if(D<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(u,8,null,0,D,false);
}else{
F=
%TypedArrayInitializeFromArrayLike(u,8,E,C);
}
if(!F){
for(var G=0;G<C;G++){
u[G]=E[G];
}
}
}
function Float64ArrayConstructor(H,I,J){
if(%_IsConstructCall()){
if((%_ClassOf(H)==='ArrayBuffer')||(%_ClassOf(H)==='SharedArrayBuffer')){
Float64ArrayConstructByArrayBuffer(this,H,I,J);
}else if((typeof(H)==='number')||(typeof(H)==='string')||
(typeof(H)==='boolean')||(H===(void 0))){
Float64ArrayConstructByLength(this,H);
}else{
Float64ArrayConstructByArrayLike(this,H);
}
}else{
throw MakeTypeError(20,"Float64Array")
}
}
function Float64Array_GetBuffer(){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(33,"Float64Array.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Float64Array_GetByteLength(){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(33,"Float64Array.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Float64Array_GetByteOffset(){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(33,"Float64Array.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Float64Array_GetLength(){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(33,"Float64Array.length",this);
}
return %_TypedArrayGetLength(this);
}
function Float64ArraySubArray(K,L){
if(!(%_ClassOf(this)==='Float64Array')){
throw MakeTypeError(33,"Float64Array.subarray",this);
}
var M=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(!(L===(void 0))){
L=(%_IsSmi(%IS_VAR(L))?L:%NumberToInteger($toNumber(L)));
}
var N=%_TypedArrayGetLength(this);
if(M<0){
M=q(0,N+M);
}else{
M=r(N,M);
}
var O=(L===(void 0))?N:L;
if(O<0){
O=q(0,N+O);
}else{
O=r(O,N);
}
if(O<M){
O=M;
}
var B=O-M;
var P=
%_ArrayBufferViewGetByteOffset(this)+M*8;
return new o(%TypedArrayGetBuffer(this),
P,B);
}

function Uint8ClampedArrayConstructByArrayBuffer(u,v,w,x){
if(!(w===(void 0))){
w=
$toPositiveInteger(w,139);
}
if(!(x===(void 0))){
x=$toPositiveInteger(x,139);
}
var y=%_ArrayBufferGetByteLength(v);
var z;
if((w===(void 0))){
z=0;
}else{
z=w;
if(z % 1!==0){
throw MakeRangeError(138,
"start offset","Uint8ClampedArray",1);
}
if(z>y){
throw MakeRangeError(140);
}
}
var A;
var B;
if((x===(void 0))){
if(y % 1!==0){
throw MakeRangeError(138,
"byte length","Uint8ClampedArray",1);
}
A=y-z;
B=A/1;
}else{
var B=x;
A=B*1;
}
if((z+A>y)
||(B>%_MaxSmi())){
throw MakeRangeError(139);
}
%_TypedArrayInitialize(u,9,v,z,A,true);
}
function Uint8ClampedArrayConstructByLength(u,x){
var C=(x===(void 0))?
0:$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var D=C*1;
if(D>%_TypedArrayMaxSizeInHeap()){
var v=new d(D);
%_TypedArrayInitialize(u,9,v,0,D,true);
}else{
%_TypedArrayInitialize(u,9,null,0,D,true);
}
}
function Uint8ClampedArrayConstructByArrayLike(u,E){
var x=E.length;
var C=$toPositiveInteger(x,139);
if(C>%_MaxSmi()){
throw MakeRangeError(139);
}
var F=false;
var D=C*1;
if(D<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(u,9,null,0,D,false);
}else{
F=
%TypedArrayInitializeFromArrayLike(u,9,E,C);
}
if(!F){
for(var G=0;G<C;G++){
u[G]=E[G];
}
}
}
function Uint8ClampedArrayConstructor(H,I,J){
if(%_IsConstructCall()){
if((%_ClassOf(H)==='ArrayBuffer')||(%_ClassOf(H)==='SharedArrayBuffer')){
Uint8ClampedArrayConstructByArrayBuffer(this,H,I,J);
}else if((typeof(H)==='number')||(typeof(H)==='string')||
(typeof(H)==='boolean')||(H===(void 0))){
Uint8ClampedArrayConstructByLength(this,H);
}else{
Uint8ClampedArrayConstructByArrayLike(this,H);
}
}else{
throw MakeTypeError(20,"Uint8ClampedArray")
}
}
function Uint8ClampedArray_GetBuffer(){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(33,"Uint8ClampedArray.buffer",this);
}
return %TypedArrayGetBuffer(this);
}
function Uint8ClampedArray_GetByteLength(){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(33,"Uint8ClampedArray.byteLength",this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function Uint8ClampedArray_GetByteOffset(){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(33,"Uint8ClampedArray.byteOffset",this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function Uint8ClampedArray_GetLength(){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(33,"Uint8ClampedArray.length",this);
}
return %_TypedArrayGetLength(this);
}
function Uint8ClampedArraySubArray(K,L){
if(!(%_ClassOf(this)==='Uint8ClampedArray')){
throw MakeTypeError(33,"Uint8ClampedArray.subarray",this);
}
var M=(%_IsSmi(%IS_VAR(K))?K:%NumberToInteger($toNumber(K)));
if(!(L===(void 0))){
L=(%_IsSmi(%IS_VAR(L))?L:%NumberToInteger($toNumber(L)));
}
var N=%_TypedArrayGetLength(this);
if(M<0){
M=q(0,N+M);
}else{
M=r(N,M);
}
var O=(L===(void 0))?N:L;
if(O<0){
O=q(0,N+O);
}else{
O=r(O,N);
}
if(O<M){
O=M;
}
var B=O-M;
var P=
%_ArrayBufferViewGetByteOffset(this)+M*1;
return new p(%TypedArrayGetBuffer(this),
P,B);
}


function TypedArraySetFromArrayLike(Q,R,S,z){
if(z>0){
for(var G=0;G<S;G++){
Q[z+G]=R[G];
}
}
else{
for(var G=0;G<S;G++){
Q[G]=R[G];
}
}
}
function TypedArraySetFromOverlappingTypedArray(Q,R,z){
var T=R.BYTES_PER_ELEMENT;
var U=Q.BYTES_PER_ELEMENT;
var S=R.length;
function CopyLeftPart(){
var V=Q.byteOffset+(z+1)*U;
var W=R.byteOffset;
for(var X=0;
X<S&&V<=W;
X++){
Q[z+X]=R[X];
V+=U;
W+=T;
}
return X;
}
var X=CopyLeftPart();
function CopyRightPart(){
var V=
Q.byteOffset+(z+S-1)*U;
var W=
R.byteOffset+S*T;
for(var Y=S-1;
Y>=X&&V>=W;
Y--){
Q[z+Y]=R[Y];
V-=U;
W-=T;
}
return Y;
}
var Y=CopyRightPart();
var Z=new c(Y+1-X);
for(var G=X;G<=Y;G++){
Z[G-X]=R[G];
}
for(G=X;G<=Y;G++){
Q[z+G]=Z[G-X];
}
}
function TypedArraySet(u,z){
var aa=(z===(void 0))?0:(%_IsSmi(%IS_VAR(z))?z:%NumberToInteger($toNumber(z)));
if(aa<0)throw MakeTypeError(148);
if(aa>%_MaxSmi()){
throw MakeRangeError(149);
}
switch(%TypedArraySetFastCases(this,u,aa)){
case 0:
return;
case 1:
TypedArraySetFromOverlappingTypedArray(this,u,aa);
return;
case 2:
TypedArraySetFromArrayLike(this,u,u.length,aa);
return;
case 3:
var C=u.length;
if((C===(void 0))){
if((typeof(u)==='number')){
throw MakeTypeError(36);
}
return;
}
if(aa+C>this.length){
throw MakeRangeError(149);
}
TypedArraySetFromArrayLike(this,u,C,aa);
return;
}
}
function TypedArrayGetToStringTag(){
if(!%IsTypedArray(this))return;
var ab=%_ClassOf(this);
if((ab===(void 0)))return;
return ab;
}
%SetCode(h,Uint8ArrayConstructor);
%FunctionSetPrototype(h,new g());
%AddNamedProperty(h,"BYTES_PER_ELEMENT",1,
1|2|4);
%AddNamedProperty(h.prototype,
"constructor",a.Uint8Array,2);
%AddNamedProperty(h.prototype,
"BYTES_PER_ELEMENT",1,
1|2|4);
b.InstallGetter(h.prototype,"buffer",Uint8Array_GetBuffer);
b.InstallGetter(h.prototype,"byteOffset",Uint8Array_GetByteOffset,
2|4);
b.InstallGetter(h.prototype,"byteLength",Uint8Array_GetByteLength,
2|4);
b.InstallGetter(h.prototype,"length",Uint8Array_GetLength,
2|4);
b.InstallGetter(h.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
b.InstallFunctions(h.prototype,2,[
"subarray",Uint8ArraySubArray,
"set",TypedArraySet
]);

%SetCode(i,Int8ArrayConstructor);
%FunctionSetPrototype(i,new g());
%AddNamedProperty(i,"BYTES_PER_ELEMENT",1,
1|2|4);
%AddNamedProperty(i.prototype,
"constructor",a.Int8Array,2);
%AddNamedProperty(i.prototype,
"BYTES_PER_ELEMENT",1,
1|2|4);
b.InstallGetter(i.prototype,"buffer",Int8Array_GetBuffer);
b.InstallGetter(i.prototype,"byteOffset",Int8Array_GetByteOffset,
2|4);
b.InstallGetter(i.prototype,"byteLength",Int8Array_GetByteLength,
2|4);
b.InstallGetter(i.prototype,"length",Int8Array_GetLength,
2|4);
b.InstallGetter(i.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
b.InstallFunctions(i.prototype,2,[
"subarray",Int8ArraySubArray,
"set",TypedArraySet
]);

%SetCode(j,Uint16ArrayConstructor);
%FunctionSetPrototype(j,new g());
%AddNamedProperty(j,"BYTES_PER_ELEMENT",2,
1|2|4);
%AddNamedProperty(j.prototype,
"constructor",a.Uint16Array,2);
%AddNamedProperty(j.prototype,
"BYTES_PER_ELEMENT",2,
1|2|4);
b.InstallGetter(j.prototype,"buffer",Uint16Array_GetBuffer);
b.InstallGetter(j.prototype,"byteOffset",Uint16Array_GetByteOffset,
2|4);
b.InstallGetter(j.prototype,"byteLength",Uint16Array_GetByteLength,
2|4);
b.InstallGetter(j.prototype,"length",Uint16Array_GetLength,
2|4);
b.InstallGetter(j.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
b.InstallFunctions(j.prototype,2,[
"subarray",Uint16ArraySubArray,
"set",TypedArraySet
]);

%SetCode(k,Int16ArrayConstructor);
%FunctionSetPrototype(k,new g());
%AddNamedProperty(k,"BYTES_PER_ELEMENT",2,
1|2|4);
%AddNamedProperty(k.prototype,
"constructor",a.Int16Array,2);
%AddNamedProperty(k.prototype,
"BYTES_PER_ELEMENT",2,
1|2|4);
b.InstallGetter(k.prototype,"buffer",Int16Array_GetBuffer);
b.InstallGetter(k.prototype,"byteOffset",Int16Array_GetByteOffset,
2|4);
b.InstallGetter(k.prototype,"byteLength",Int16Array_GetByteLength,
2|4);
b.InstallGetter(k.prototype,"length",Int16Array_GetLength,
2|4);
b.InstallGetter(k.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
b.InstallFunctions(k.prototype,2,[
"subarray",Int16ArraySubArray,
"set",TypedArraySet
]);

%SetCode(l,Uint32ArrayConstructor);
%FunctionSetPrototype(l,new g());
%AddNamedProperty(l,"BYTES_PER_ELEMENT",4,
1|2|4);
%AddNamedProperty(l.prototype,
"constructor",a.Uint32Array,2);
%AddNamedProperty(l.prototype,
"BYTES_PER_ELEMENT",4,
1|2|4);
b.InstallGetter(l.prototype,"buffer",Uint32Array_GetBuffer);
b.InstallGetter(l.prototype,"byteOffset",Uint32Array_GetByteOffset,
2|4);
b.InstallGetter(l.prototype,"byteLength",Uint32Array_GetByteLength,
2|4);
b.InstallGetter(l.prototype,"length",Uint32Array_GetLength,
2|4);
b.InstallGetter(l.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
b.InstallFunctions(l.prototype,2,[
"subarray",Uint32ArraySubArray,
"set",TypedArraySet
]);

%SetCode(m,Int32ArrayConstructor);
%FunctionSetPrototype(m,new g());
%AddNamedProperty(m,"BYTES_PER_ELEMENT",4,
1|2|4);
%AddNamedProperty(m.prototype,
"constructor",a.Int32Array,2);
%AddNamedProperty(m.prototype,
"BYTES_PER_ELEMENT",4,
1|2|4);
b.InstallGetter(m.prototype,"buffer",Int32Array_GetBuffer);
b.InstallGetter(m.prototype,"byteOffset",Int32Array_GetByteOffset,
2|4);
b.InstallGetter(m.prototype,"byteLength",Int32Array_GetByteLength,
2|4);
b.InstallGetter(m.prototype,"length",Int32Array_GetLength,
2|4);
b.InstallGetter(m.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
b.InstallFunctions(m.prototype,2,[
"subarray",Int32ArraySubArray,
"set",TypedArraySet
]);

%SetCode(n,Float32ArrayConstructor);
%FunctionSetPrototype(n,new g());
%AddNamedProperty(n,"BYTES_PER_ELEMENT",4,
1|2|4);
%AddNamedProperty(n.prototype,
"constructor",a.Float32Array,2);
%AddNamedProperty(n.prototype,
"BYTES_PER_ELEMENT",4,
1|2|4);
b.InstallGetter(n.prototype,"buffer",Float32Array_GetBuffer);
b.InstallGetter(n.prototype,"byteOffset",Float32Array_GetByteOffset,
2|4);
b.InstallGetter(n.prototype,"byteLength",Float32Array_GetByteLength,
2|4);
b.InstallGetter(n.prototype,"length",Float32Array_GetLength,
2|4);
b.InstallGetter(n.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
b.InstallFunctions(n.prototype,2,[
"subarray",Float32ArraySubArray,
"set",TypedArraySet
]);

%SetCode(o,Float64ArrayConstructor);
%FunctionSetPrototype(o,new g());
%AddNamedProperty(o,"BYTES_PER_ELEMENT",8,
1|2|4);
%AddNamedProperty(o.prototype,
"constructor",a.Float64Array,2);
%AddNamedProperty(o.prototype,
"BYTES_PER_ELEMENT",8,
1|2|4);
b.InstallGetter(o.prototype,"buffer",Float64Array_GetBuffer);
b.InstallGetter(o.prototype,"byteOffset",Float64Array_GetByteOffset,
2|4);
b.InstallGetter(o.prototype,"byteLength",Float64Array_GetByteLength,
2|4);
b.InstallGetter(o.prototype,"length",Float64Array_GetLength,
2|4);
b.InstallGetter(o.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
b.InstallFunctions(o.prototype,2,[
"subarray",Float64ArraySubArray,
"set",TypedArraySet
]);

%SetCode(p,Uint8ClampedArrayConstructor);
%FunctionSetPrototype(p,new g());
%AddNamedProperty(p,"BYTES_PER_ELEMENT",1,
1|2|4);
%AddNamedProperty(p.prototype,
"constructor",a.Uint8ClampedArray,2);
%AddNamedProperty(p.prototype,
"BYTES_PER_ELEMENT",1,
1|2|4);
b.InstallGetter(p.prototype,"buffer",Uint8ClampedArray_GetBuffer);
b.InstallGetter(p.prototype,"byteOffset",Uint8ClampedArray_GetByteOffset,
2|4);
b.InstallGetter(p.prototype,"byteLength",Uint8ClampedArray_GetByteLength,
2|4);
b.InstallGetter(p.prototype,"length",Uint8ClampedArray_GetLength,
2|4);
b.InstallGetter(p.prototype,symbolToStringTag,
TypedArrayGetToStringTag);
b.InstallFunctions(p.prototype,2,[
"subarray",Uint8ClampedArraySubArray,
"set",TypedArraySet
]);


function DataViewConstructor(v,w,D){
if(%_IsConstructCall()){
if(!(%_ClassOf(v)==='ArrayBuffer'))throw MakeTypeError(22);
if(!(w===(void 0))){
w=$toPositiveInteger(w,132);
}
if(!(D===(void 0))){
D=(%_IsSmi(%IS_VAR(D))?D:%NumberToInteger($toNumber(D)));
}
var y=%_ArrayBufferGetByteLength(v);
var z=(w===(void 0))?0:w;
if(z>y)throw MakeRangeError(132);
var x=(D===(void 0))
?y-z
:D;
if(x<0||z+x>y){
throw new MakeRangeError(131);
}
%_DataViewInitialize(this,v,z,x);
}else{
throw MakeTypeError(20,"DataView");
}
}
function DataViewGetBufferJS(){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,'DataView.buffer',this);
}
return %DataViewGetBuffer(this);
}
function DataViewGetByteOffset(){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.byteOffset',this);
}
return %_ArrayBufferViewGetByteOffset(this);
}
function DataViewGetByteLength(){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.byteLength',this);
}
return %_ArrayBufferViewGetByteLength(this);
}
function DataViewGetInt8JS(z,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.getInt8',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
return %DataViewGetInt8(this,z,!!ac);
}
function DataViewSetInt8JS(z,ad,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.setInt8',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
%DataViewSetInt8(this,z,((typeof(%IS_VAR(ad))==='number')?ad:$nonNumberToNumber(ad)),!!ac);
}

function DataViewGetUint8JS(z,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.getUint8',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
return %DataViewGetUint8(this,z,!!ac);
}
function DataViewSetUint8JS(z,ad,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.setUint8',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
%DataViewSetUint8(this,z,((typeof(%IS_VAR(ad))==='number')?ad:$nonNumberToNumber(ad)),!!ac);
}

function DataViewGetInt16JS(z,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.getInt16',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
return %DataViewGetInt16(this,z,!!ac);
}
function DataViewSetInt16JS(z,ad,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.setInt16',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
%DataViewSetInt16(this,z,((typeof(%IS_VAR(ad))==='number')?ad:$nonNumberToNumber(ad)),!!ac);
}

function DataViewGetUint16JS(z,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.getUint16',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
return %DataViewGetUint16(this,z,!!ac);
}
function DataViewSetUint16JS(z,ad,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.setUint16',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
%DataViewSetUint16(this,z,((typeof(%IS_VAR(ad))==='number')?ad:$nonNumberToNumber(ad)),!!ac);
}

function DataViewGetInt32JS(z,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.getInt32',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
return %DataViewGetInt32(this,z,!!ac);
}
function DataViewSetInt32JS(z,ad,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.setInt32',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
%DataViewSetInt32(this,z,((typeof(%IS_VAR(ad))==='number')?ad:$nonNumberToNumber(ad)),!!ac);
}

function DataViewGetUint32JS(z,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.getUint32',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
return %DataViewGetUint32(this,z,!!ac);
}
function DataViewSetUint32JS(z,ad,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.setUint32',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
%DataViewSetUint32(this,z,((typeof(%IS_VAR(ad))==='number')?ad:$nonNumberToNumber(ad)),!!ac);
}

function DataViewGetFloat32JS(z,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.getFloat32',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
return %DataViewGetFloat32(this,z,!!ac);
}
function DataViewSetFloat32JS(z,ad,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.setFloat32',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
%DataViewSetFloat32(this,z,((typeof(%IS_VAR(ad))==='number')?ad:$nonNumberToNumber(ad)),!!ac);
}

function DataViewGetFloat64JS(z,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.getFloat64',this);
}
if(%_ArgumentsLength()<1)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
return %DataViewGetFloat64(this,z,!!ac);
}
function DataViewSetFloat64JS(z,ad,ac){
if(!(%_ClassOf(this)==='DataView')){
throw MakeTypeError(33,
'DataView.setFloat64',this);
}
if(%_ArgumentsLength()<2)throw MakeTypeError(36);
z=$toPositiveInteger(z,130);
%DataViewSetFloat64(this,z,((typeof(%IS_VAR(ad))==='number')?ad:$nonNumberToNumber(ad)),!!ac);
}


%SetCode(e,DataViewConstructor);
%FunctionSetPrototype(e,new g);
%AddNamedProperty(e.prototype,"constructor",e,
2);
%AddNamedProperty(e.prototype,symbolToStringTag,"DataView",
1|2);
b.InstallGetter(e.prototype,"buffer",DataViewGetBufferJS);
b.InstallGetter(e.prototype,"byteOffset",
DataViewGetByteOffset);
b.InstallGetter(e.prototype,"byteLength",
DataViewGetByteLength);
b.InstallFunctions(e.prototype,2,[
"getInt8",DataViewGetInt8JS,
"setInt8",DataViewSetInt8JS,
"getUint8",DataViewGetUint8JS,
"setUint8",DataViewSetUint8JS,
"getInt16",DataViewGetInt16JS,
"setInt16",DataViewSetInt16JS,
"getUint16",DataViewGetUint16JS,
"setUint16",DataViewSetUint16JS,
"getInt32",DataViewGetInt32JS,
"setInt32",DataViewSetInt32JS,
"getUint32",DataViewGetUint32JS,
"setUint32",DataViewSetUint32JS,
"getFloat32",DataViewGetFloat32JS,
"setFloat32",DataViewSetFloat32JS,
"getFloat64",DataViewGetFloat64JS,
"setFloat64",DataViewSetFloat64JS
]);
})

Hiterator-prototype¥
var $iteratorPrototype;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Object;
function IteratorPrototypeIterator(){
return this;
}
b.SetFunctionName(IteratorPrototypeIterator,symbolIterator);
%AddNamedProperty($iteratorPrototype,symbolIterator,
IteratorPrototypeIterator,2);
})

$generatorá
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Function;
var d;
b.Import(function(e){
d=e.NewFunctionString;
});
function GeneratorObjectNext(g){
if(!(%_ClassOf(this)==='Generator')){
throw MakeTypeError(33,
'[Generator].prototype.next',this);
}
var h=%GeneratorGetContinuation(this);
if(h>0){
if((%_DebugIsActive()!=0))%DebugPrepareStepInIfStepping(this);
try{
return %_GeneratorNext(this,g);
}catch(e){
%GeneratorClose(this);
throw e;
}
}else if(h==0){
return{value:void 0,done:true};
}else{
throw MakeTypeError(31);
}
}
function GeneratorObjectThrow(i){
if(!(%_ClassOf(this)==='Generator')){
throw MakeTypeError(33,
'[Generator].prototype.throw',this);
}
var h=%GeneratorGetContinuation(this);
if(h>0){
try{
return %_GeneratorThrow(this,i);
}catch(e){
%GeneratorClose(this);
throw e;
}
}else if(h==0){
throw i;
}else{
throw MakeTypeError(31);
}
}
function GeneratorFunctionConstructor(j){
var k=d(arguments,'function*');
var l=%GlobalProxy(GeneratorFunctionConstructor);
var m=%_CallFunction(l,%CompileString(k,true));
%FunctionMarkNameShouldPrintAsAnonymous(m);
return m;
}
%NeverOptimizeFunction(GeneratorObjectNext);
%NeverOptimizeFunction(GeneratorObjectThrow);
var n=GeneratorFunctionPrototype.prototype;
b.InstallFunctions(n,
2,
["next",GeneratorObjectNext,
"throw",GeneratorObjectThrow]);
%AddNamedProperty(n,"constructor",
GeneratorFunctionPrototype,2|1);
%AddNamedProperty(n,
symbolToStringTag,"Generator",2|1);
%InternalSetPrototype(GeneratorFunctionPrototype,c.prototype);
%AddNamedProperty(GeneratorFunctionPrototype,
symbolToStringTag,"GeneratorFunction",2|1);
%AddNamedProperty(GeneratorFunctionPrototype,"constructor",
GeneratorFunction,2|1);
%InternalSetPrototype(GeneratorFunction,c);
%SetCode(GeneratorFunction,GeneratorFunctionConstructor);
})

8object-observei®
var $observeNotifyChange;
var $observeEnqueueSpliceRecord;
var $observeBeginPerformSplice;
var $observeEndPerformSplice;
var $observeNativeObjectObserve;
var $observeNativeObjectGetNotifier;
var $observeNativeObjectNotifierPerformChange;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Array;
var d=a.Object;
var e=b.InternalArray;
var g;
var h;
b.Import(function(i){
g=i.ObjectFreeze;
h=i.ObjectIsFrozen;
});
var j;
var k={};
function GetObservationStateJS(){
if((j===(void 0))){
j=%GetObservationState();
}
if((j.callbackInfoMap===(void 0))){
j.callbackInfoMap=%ObservationWeakMapCreate();
j.objectInfoMap=%ObservationWeakMapCreate();
j.notifierObjectInfoMap=%ObservationWeakMapCreate();
j.pendingObservers=null;
j.nextCallbackPriority=0;
j.lastMicrotaskId=0;
}
return j;
}
function GetPendingObservers(){
return GetObservationStateJS().pendingObservers;
}
function SetPendingObservers(l){
GetObservationStateJS().pendingObservers=l;
}
function GetNextCallbackPriority(){
return GetObservationStateJS().nextCallbackPriority++;
}
function nullProtoObject(){
return{__proto__:null};
}
function TypeMapCreate(){
return nullProtoObject();
}
function TypeMapAddType(m,n,o){
m[n]=o?1:(m[n]||0)+1;
}
function TypeMapRemoveType(m,n){
m[n]--;
}
function TypeMapCreateFromList(p,q){
var m=TypeMapCreate();
for(var r=0;r<q;r++){
TypeMapAddType(m,p[r],true);
}
return m;
}
function TypeMapHasType(m,n){
return!!m[n];
}
function TypeMapIsDisjointFrom(t,u){
if(!t||!u)
return true;
for(var n in t){
if(TypeMapHasType(t,n)&&TypeMapHasType(u,n))
return false;
}
return true;
}
var v=(function(){
var w=[
'add',
'update',
'delete',
'setPrototype',
'reconfigure',
'preventExtensions'
];
return TypeMapCreateFromList(w,w.length);
})();
function ObserverCreate(x,y){
if((y===(void 0)))
return x;
var z=nullProtoObject();
z.callback=x;
z.accept=y;
return z;
}
function ObserverGetCallback(z){
return(%_ClassOf(z)==='Function')?z:z.callback;
}
function ObserverGetAcceptTypes(z){
return(%_ClassOf(z)==='Function')?v:z.accept;
}
function ObserverIsActive(z,A){
return TypeMapIsDisjointFrom(ObjectInfoGetPerformingTypes(A),
ObserverGetAcceptTypes(z));
}
function ObjectInfoGetOrCreate(B){
var A=ObjectInfoGet(B);
if((A===(void 0))){
if(!%_IsJSProxy(B)){
%SetIsObserved(B);
}
A={
object:B,
changeObservers:null,
notifier:null,
performing:null,
performingCount:0,
};
%WeakCollectionSet(GetObservationStateJS().objectInfoMap,
B,A,$getHash(B));
}
return A;
}
function ObjectInfoGet(B){
return %WeakCollectionGet(GetObservationStateJS().objectInfoMap,B,
$getHash(B));
}
function ObjectInfoGetFromNotifier(C){
return %WeakCollectionGet(GetObservationStateJS().notifierObjectInfoMap,
C,$getHash(C));
}
function ObjectInfoGetNotifier(A){
if((A.notifier===null)){
var C={__proto__:k};
A.notifier=C;
%WeakCollectionSet(GetObservationStateJS().notifierObjectInfoMap,
C,A,$getHash(C));
}
return A.notifier;
}
function ChangeObserversIsOptimized(D){
return(%_ClassOf(D)==='Function')||
(%_ClassOf(D.callback)==='Function');
}
function ObjectInfoNormalizeChangeObservers(A){
if(ChangeObserversIsOptimized(A.changeObservers)){
var z=A.changeObservers;
var x=ObserverGetCallback(z);
var E=CallbackInfoGet(x);
var F=CallbackInfoGetPriority(E);
A.changeObservers=nullProtoObject();
A.changeObservers[F]=z;
}
}
function ObjectInfoAddObserver(A,x,y){
var E=CallbackInfoGetOrCreate(x);
var z=ObserverCreate(x,y);
if(!A.changeObservers){
A.changeObservers=z;
return;
}
ObjectInfoNormalizeChangeObservers(A);
var F=CallbackInfoGetPriority(E);
A.changeObservers[F]=z;
}
function ObjectInfoRemoveObserver(A,x){
if(!A.changeObservers)
return;
if(ChangeObserversIsOptimized(A.changeObservers)){
if(x===ObserverGetCallback(A.changeObservers))
A.changeObservers=null;
return;
}
var E=CallbackInfoGet(x);
var F=CallbackInfoGetPriority(E);
A.changeObservers[F]=null;
}
function ObjectInfoHasActiveObservers(A){
if((A===(void 0))||!A.changeObservers)
return false;
if(ChangeObserversIsOptimized(A.changeObservers))
return ObserverIsActive(A.changeObservers,A);
for(var F in A.changeObservers){
var z=A.changeObservers[F];
if(!(z===null)&&ObserverIsActive(z,A))
return true;
}
return false;
}
function ObjectInfoAddPerformingType(A,n){
A.performing=A.performing||TypeMapCreate();
TypeMapAddType(A.performing,n);
A.performingCount++;
}
function ObjectInfoRemovePerformingType(A,n){
A.performingCount--;
TypeMapRemoveType(A.performing,n);
}
function ObjectInfoGetPerformingTypes(A){
return A.performingCount>0?A.performing:null;
}
function ConvertAcceptListToTypeMap(G){
if((G===(void 0)))
return G;
if(!(%_IsSpecObject(G)))throw MakeTypeError(67);
var H=$toInteger(G.length);
if(H<0)H=0;
return TypeMapCreateFromList(G,H);
}
function CallbackInfoGet(x){
return %WeakCollectionGet(GetObservationStateJS().callbackInfoMap,x,
$getHash(x));
}
function CallbackInfoSet(x,E){
%WeakCollectionSet(GetObservationStateJS().callbackInfoMap,
x,E,$getHash(x));
}
function CallbackInfoGetOrCreate(x){
var E=CallbackInfoGet(x);
if(!(E===(void 0)))
return E;
var F=GetNextCallbackPriority();
CallbackInfoSet(x,F);
return F;
}
function CallbackInfoGetPriority(E){
if((typeof(E)==='number'))
return E;
else
return E.priority;
}
function CallbackInfoNormalize(x){
var E=CallbackInfoGet(x);
if((typeof(E)==='number')){
var F=E;
E=new e;
E.priority=F;
CallbackInfoSet(x,E);
}
return E;
}
function ObjectObserve(B,x,y){
if(!(%_IsSpecObject(B)))
throw MakeTypeError(69,"observe","observe");
if(%IsJSGlobalProxy(B))
throw MakeTypeError(66,"observe");
if(!(%_ClassOf(x)==='Function'))
throw MakeTypeError(68,"observe");
if(h(x))
throw MakeTypeError(65);
var I=%GetObjectContextObjectObserve(B);
return I(B,x,y);
}
function NativeObjectObserve(B,x,y){
var A=ObjectInfoGetOrCreate(B);
var p=ConvertAcceptListToTypeMap(y);
ObjectInfoAddObserver(A,x,p);
return B;
}
function ObjectUnobserve(B,x){
if(!(%_IsSpecObject(B)))
throw MakeTypeError(69,"unobserve","unobserve");
if(%IsJSGlobalProxy(B))
throw MakeTypeError(66,"unobserve");
if(!(%_ClassOf(x)==='Function'))
throw MakeTypeError(68,"unobserve");
var A=ObjectInfoGet(B);
if((A===(void 0)))
return B;
ObjectInfoRemoveObserver(A,x);
return B;
}
function ArrayObserve(B,x){
return ObjectObserve(B,x,['add',
'update',
'delete',
'splice']);
}
function ArrayUnobserve(B,x){
return ObjectUnobserve(B,x);
}
function ObserverEnqueueIfActive(z,A,J){
if(!ObserverIsActive(z,A)||
!TypeMapHasType(ObserverGetAcceptTypes(z),J.type)){
return;
}
var x=ObserverGetCallback(z);
if(!%ObserverObjectAndRecordHaveSameOrigin(x,J.object,
J)){
return;
}
var E=CallbackInfoNormalize(x);
if((GetPendingObservers()===null)){
SetPendingObservers(nullProtoObject());
if((%_DebugIsActive()!=0)){
var K=++GetObservationStateJS().lastMicrotaskId;
var L="Object.observe";
%EnqueueMicrotask(function(){
%DebugAsyncTaskEvent({type:"willHandle",id:K,name:L});
ObserveMicrotaskRunner();
%DebugAsyncTaskEvent({type:"didHandle",id:K,name:L});
});
%DebugAsyncTaskEvent({type:"enqueue",id:K,name:L});
}else{
%EnqueueMicrotask(ObserveMicrotaskRunner);
}
}
GetPendingObservers()[E.priority]=x;
E.push(J);
}
function ObjectInfoEnqueueExternalChangeRecord(A,J,n){
if(!ObjectInfoHasActiveObservers(A))
return;
var M=!(n===(void 0));
var N=M?
{object:A.object,type:n}:
{object:A.object};
for(var O in J){
if(O==='object'||(M&&O==='type'))continue;
%DefineDataPropertyUnchecked(
N,O,J[O],1+4);
}
g(N);
ObjectInfoEnqueueInternalChangeRecord(A,N);
}
function ObjectInfoEnqueueInternalChangeRecord(A,J){
if((typeof(J.name)==='symbol'))return;
if(ChangeObserversIsOptimized(A.changeObservers)){
var z=A.changeObservers;
ObserverEnqueueIfActive(z,A,J);
return;
}
for(var F in A.changeObservers){
var z=A.changeObservers[F];
if((z===null))
continue;
ObserverEnqueueIfActive(z,A,J);
}
}
function BeginPerformSplice(P){
var A=ObjectInfoGet(P);
if(!(A===(void 0)))
ObjectInfoAddPerformingType(A,'splice');
}
function EndPerformSplice(P){
var A=ObjectInfoGet(P);
if(!(A===(void 0)))
ObjectInfoRemovePerformingType(A,'splice');
}
function EnqueueSpliceRecord(P,Q,R,S){
var A=ObjectInfoGet(P);
if(!ObjectInfoHasActiveObservers(A))
return;
var J={
type:'splice',
object:P,
index:Q,
removed:R,
addedCount:S
};
g(J);
g(J.removed);
ObjectInfoEnqueueInternalChangeRecord(A,J);
}
function NotifyChange(n,B,L,T){
var A=ObjectInfoGet(B);
if(!ObjectInfoHasActiveObservers(A))
return;
var J;
if(arguments.length==2){
J={type:n,object:B};
}else if(arguments.length==3){
J={type:n,object:B,name:L};
}else{
J={
type:n,
object:B,
name:L,
oldValue:T
};
}
g(J);
ObjectInfoEnqueueInternalChangeRecord(A,J);
}
function ObjectNotifierNotify(J){
if(!(%_IsSpecObject(this)))
throw MakeTypeError(13,"notify");
var A=ObjectInfoGetFromNotifier(this);
if((A===(void 0)))
throw MakeTypeError(70);
if(!(typeof(J.type)==='string'))
throw MakeTypeError(73);
ObjectInfoEnqueueExternalChangeRecord(A,J);
}
function ObjectNotifierPerformChange(U,V){
if(!(%_IsSpecObject(this)))
throw MakeTypeError(13,"performChange");
var A=ObjectInfoGetFromNotifier(this);
if((A===(void 0)))
throw MakeTypeError(70);
if(!(typeof(U)==='string'))
throw MakeTypeError(72);
if(!(%_ClassOf(V)==='Function'))
throw MakeTypeError(71);
var W=%GetObjectContextNotifierPerformChange(A);
W(A,U,V);
}
function NativeObjectNotifierPerformChange(A,U,V){
ObjectInfoAddPerformingType(A,U);
var J;
try{
J=%_CallFunction((void 0),V);
}finally{
ObjectInfoRemovePerformingType(A,U);
}
if((%_IsSpecObject(J)))
ObjectInfoEnqueueExternalChangeRecord(A,J,U);
}
function ObjectGetNotifier(B){
if(!(%_IsSpecObject(B)))
throw MakeTypeError(69,"getNotifier","getNotifier");
if(%IsJSGlobalProxy(B))
throw MakeTypeError(66,"getNotifier");
if(h(B))return null;
if(!%ObjectWasCreatedInCurrentOrigin(B))return null;
var X=%GetObjectContextObjectGetNotifier(B);
return X(B);
}
function NativeObjectGetNotifier(B){
var A=ObjectInfoGetOrCreate(B);
return ObjectInfoGetNotifier(A);
}
function CallbackDeliverPending(x){
var E=CallbackInfoGet(x);
if((E===(void 0))||(typeof(E)==='number'))
return false;
var F=E.priority;
CallbackInfoSet(x,F);
var l=GetPendingObservers();
if(!(l===null))
delete l[F];
var Y=[];
%MoveArrayContents(E,Y);
%DeliverObservationChangeRecords(x,Y);
return true;
}
function ObjectDeliverChangeRecords(x){
if(!(%_ClassOf(x)==='Function'))
throw MakeTypeError(68,"deliverChangeRecords");
while(CallbackDeliverPending(x)){}
}
function ObserveMicrotaskRunner(){
var l=GetPendingObservers();
if(!(l===null)){
SetPendingObservers(null);
for(var r in l){
CallbackDeliverPending(l[r]);
}
}
}
b.InstallFunctions(d,2,[
"deliverChangeRecords",ObjectDeliverChangeRecords,
"getNotifier",ObjectGetNotifier,
"observe",ObjectObserve,
"unobserve",ObjectUnobserve
]);
b.InstallFunctions(c,2,[
"observe",ArrayObserve,
"unobserve",ArrayUnobserve
]);
b.InstallFunctions(k,2,[
"notify",ObjectNotifierNotify,
"performChange",ObjectNotifierPerformChange
]);
$observeNotifyChange=NotifyChange;
$observeEnqueueSpliceRecord=EnqueueSpliceRecord;
$observeBeginPerformSplice=BeginPerformSplice;
$observeEndPerformSplice=EndPerformSplice;
$observeNativeObjectObserve=NativeObjectObserve;
$observeNativeObjectGetNotifier=NativeObjectGetNotifier;
$observeNativeObjectNotifierPerformChange=NativeObjectNotifierPerformChange;
})

(collectionaŒ
var $getHash;
var $getExistingHash;
var $mapFromArray;
var $setFromArray;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Map;
var d=a.Object;
var e=a.Set;
var g;
b.Import(function(h){
g=h.IntRandom;
});
var i;
b.Import(function(h){
i=h.NumberIsNaN;
});
function HashToEntry(j,k,l){
var m=(k&((l)-1));
return((%_FixedArrayGet(j,(3+(m))|0)));
}
%SetForceInlineFlag(HashToEntry);
function SetFindEntry(j,l,n,k){
var o=HashToEntry(j,k,l);
if(o===-1)return o;
var p=((%_FixedArrayGet(j,((3+(l)+((o)<<1)))|0)));
if(n===p)return o;
var q=i(n);
while(true){
if(q&&i(p)){
return o;
}
o=((%_FixedArrayGet(j,((3+(l)+((o)<<1))+1)|0)));
if(o===-1)return o;
p=((%_FixedArrayGet(j,((3+(l)+((o)<<1)))|0)));
if(n===p)return o;
}
return-1;
}
%SetForceInlineFlag(SetFindEntry);
function MapFindEntry(j,l,n,k){
var o=HashToEntry(j,k,l);
if(o===-1)return o;
var p=((%_FixedArrayGet(j,((3+(l)+((o)*3)))|0)));
if(n===p)return o;
var q=i(n);
while(true){
if(q&&i(p)){
return o;
}
o=((%_FixedArrayGet(j,((3+(l)+((o)*3))+2)|0)));
if(o===-1)return o;
p=((%_FixedArrayGet(j,((3+(l)+((o)*3)))|0)));
if(n===p)return o;
}
return-1;
}
%SetForceInlineFlag(MapFindEntry);
function ComputeIntegerHash(n,r){
var k=n;
k=k^r;
k=~k+(k<<15);
k=k^(k>>>12);
k=k+(k<<2);
k=k^(k>>>4);
k=(k*2057)|0;
k=k^(k>>>16);
return k&0x3fffffff;
}
%SetForceInlineFlag(ComputeIntegerHash);
var t=(%CreateGlobalPrivateOwnSymbol("hash_code_symbol"));
function GetExistingHash(n){
if(%_IsSmi(n)){
return ComputeIntegerHash(n,0);
}
if((typeof(n)==='string')){
var u=%_StringGetRawHashField(n);
if((u&1)===0){
return u>>>2;
}
}else if((%_IsSpecObject(n))&&!%_IsJSProxy(n)&&!(%_ClassOf(n)==='global')){
var k=(n[t]);
return k;
}
return %GenericHash(n);
}
%SetForceInlineFlag(GetExistingHash);
function GetHash(n){
var k=GetExistingHash(n);
if((k===(void 0))){
k=g()|0;
if(k===0)k=1;
(n[t]=k);
}
return k;
}
%SetForceInlineFlag(GetHash);
function SetConstructor(v){
if(!%_IsConstructCall()){
throw MakeTypeError(20,"Set");
}
%_SetInitialize(this);
if(!(v==null)){
var w=this.add;
if(!(%_ClassOf(w)==='Function')){
throw MakeTypeError(77,'add',this);
}
for(var x of v){
%_CallFunction(this,x,w);
}
}
}
function SetAdd(n){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(33,'Set.prototype.add',this);
}
if(n===0){
n=0;
}
var j=%_JSCollectionGetTable(this);
var l=((%_FixedArrayGet(j,(0)|0)));
var k=GetHash(n);
if(SetFindEntry(j,l,n,k)!==-1)return this;
var y=((%_FixedArrayGet(j,(1)|0)));
var z=((%_FixedArrayGet(j,(2)|0)));
var A=l<<1;
if((y+z)>=A){
%SetGrow(this);
j=%_JSCollectionGetTable(this);
l=((%_FixedArrayGet(j,(0)|0)));
y=((%_FixedArrayGet(j,(1)|0)));
z=((%_FixedArrayGet(j,(2)|0)));
}
var o=y+z;
var B=(3+(l)+((o)<<1));
var m=(k&((l)-1));
var C=((%_FixedArrayGet(j,(3+(m))|0)));
((%_FixedArraySet(j,(3+(m))|0,o)));
(((%_FixedArraySet(j,(1)|0,(y+1)|0))));
(%_FixedArraySet(j,(B)|0,n));
((%_FixedArraySet(j,(B+1)|0,(C)|0)));
return this;
}
function SetHas(n){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(33,'Set.prototype.has',this);
}
var j=%_JSCollectionGetTable(this);
var l=((%_FixedArrayGet(j,(0)|0)));
var k=GetExistingHash(n);
if((k===(void 0)))return false;
return SetFindEntry(j,l,n,k)!==-1;
}
function SetDelete(n){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(33,
'Set.prototype.delete',this);
}
var j=%_JSCollectionGetTable(this);
var l=((%_FixedArrayGet(j,(0)|0)));
var k=GetExistingHash(n);
if((k===(void 0)))return false;
var o=SetFindEntry(j,l,n,k);
if(o===-1)return false;
var y=((%_FixedArrayGet(j,(1)|0)))-1;
var z=((%_FixedArrayGet(j,(2)|0)))+1;
var B=(3+(l)+((o)<<1));
(%_FixedArraySet(j,(B)|0,%_TheHole()));
(((%_FixedArraySet(j,(1)|0,(y)|0))));
(((%_FixedArraySet(j,(2)|0,(z)|0))));
if(y<(l>>>1))%SetShrink(this);
return true;
}
function SetGetSize(){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(33,
'Set.prototype.size',this);
}
var j=%_JSCollectionGetTable(this);
return((%_FixedArrayGet(j,(1)|0)));
}
function SetClearJS(){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(33,
'Set.prototype.clear',this);
}
%_SetClear(this);
}
function SetForEach(D,E){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(33,
'Set.prototype.forEach',this);
}
if(!(%_ClassOf(D)==='Function'))throw MakeTypeError(12,D);
var F=false;
if((E===null)){
if(%IsSloppyModeFunction(D))E=(void 0);
}else if(!(E===(void 0))){
F=(!(%_IsSpecObject(E))&&%IsSloppyModeFunction(D));
}
var G=new SetIterator(this,2);
var n;
var H=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(D);
var I=[(void 0)];
while(%SetIteratorNext(G,I)){
if(H)%DebugPrepareStepInIfStepping(D);
n=I[0];
var J=F?$toObject(E):E;
%_CallFunction(J,n,n,this,D);
}
}
%SetCode(e,SetConstructor);
%FunctionSetLength(e,0);
%FunctionSetPrototype(e,new d());
%AddNamedProperty(e.prototype,"constructor",e,2);
%AddNamedProperty(e.prototype,symbolToStringTag,"Set",
2|1);
%FunctionSetLength(SetForEach,1);
b.InstallGetter(e.prototype,"size",SetGetSize);
b.InstallFunctions(e.prototype,2,[
"add",SetAdd,
"has",SetHas,
"delete",SetDelete,
"clear",SetClearJS,
"forEach",SetForEach
]);
function MapConstructor(v){
if(!%_IsConstructCall()){
throw MakeTypeError(20,"Map");
}
%_MapInitialize(this);
if(!(v==null)){
var w=this.set;
if(!(%_ClassOf(w)==='Function')){
throw MakeTypeError(77,'set',this);
}
for(var K of v){
if(!(%_IsSpecObject(K))){
throw MakeTypeError(39,K);
}
%_CallFunction(this,K[0],K[1],w);
}
}
}
function MapGet(n){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.get',this);
}
var j=%_JSCollectionGetTable(this);
var l=((%_FixedArrayGet(j,(0)|0)));
var k=GetExistingHash(n);
if((k===(void 0)))return(void 0);
var o=MapFindEntry(j,l,n,k);
if(o===-1)return(void 0);
return((%_FixedArrayGet(j,((3+(l)+((o)*3))+1)|0)));
}
function MapSet(n,x){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.set',this);
}
if(n===0){
n=0;
}
var j=%_JSCollectionGetTable(this);
var l=((%_FixedArrayGet(j,(0)|0)));
var k=GetHash(n);
var o=MapFindEntry(j,l,n,k);
if(o!==-1){
var L=(3+(l)+((o)*3));
(%_FixedArraySet(j,(L+1)|0,x));
return this;
}
var y=((%_FixedArrayGet(j,(1)|0)));
var z=((%_FixedArrayGet(j,(2)|0)));
var A=l<<1;
if((y+z)>=A){
%MapGrow(this);
j=%_JSCollectionGetTable(this);
l=((%_FixedArrayGet(j,(0)|0)));
y=((%_FixedArrayGet(j,(1)|0)));
z=((%_FixedArrayGet(j,(2)|0)));
}
o=y+z;
var B=(3+(l)+((o)*3));
var m=(k&((l)-1));
var C=((%_FixedArrayGet(j,(3+(m))|0)));
((%_FixedArraySet(j,(3+(m))|0,o)));
(((%_FixedArraySet(j,(1)|0,(y+1)|0))));
(%_FixedArraySet(j,(B)|0,n));
(%_FixedArraySet(j,(B+1)|0,x));
(%_FixedArraySet(j,(B+2)|0,C));
return this;
}
function MapHas(n){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.has',this);
}
var j=%_JSCollectionGetTable(this);
var l=((%_FixedArrayGet(j,(0)|0)));
var k=GetHash(n);
return MapFindEntry(j,l,n,k)!==-1;
}
function MapDelete(n){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.delete',this);
}
var j=%_JSCollectionGetTable(this);
var l=((%_FixedArrayGet(j,(0)|0)));
var k=GetHash(n);
var o=MapFindEntry(j,l,n,k);
if(o===-1)return false;
var y=((%_FixedArrayGet(j,(1)|0)))-1;
var z=((%_FixedArrayGet(j,(2)|0)))+1;
var B=(3+(l)+((o)*3));
(%_FixedArraySet(j,(B)|0,%_TheHole()));
(%_FixedArraySet(j,(B+1)|0,%_TheHole()));
(((%_FixedArraySet(j,(1)|0,(y)|0))));
(((%_FixedArraySet(j,(2)|0,(z)|0))));
if(y<(l>>>1))%MapShrink(this);
return true;
}
function MapGetSize(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.size',this);
}
var j=%_JSCollectionGetTable(this);
return((%_FixedArrayGet(j,(1)|0)));
}
function MapClearJS(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.clear',this);
}
%_MapClear(this);
}
function MapForEach(D,E){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.forEach',this);
}
if(!(%_ClassOf(D)==='Function'))throw MakeTypeError(12,D);
var F=false;
if((E===null)){
if(%IsSloppyModeFunction(D))E=(void 0);
}else if(!(E===(void 0))){
F=(!(%_IsSpecObject(E))&&%IsSloppyModeFunction(D));
}
var G=new MapIterator(this,3);
var H=(%_DebugIsActive()!=0)&&%DebugCallbackSupportsStepping(D);
var I=[(void 0),(void 0)];
while(%MapIteratorNext(G,I)){
if(H)%DebugPrepareStepInIfStepping(D);
var J=F?$toObject(E):E;
%_CallFunction(J,I[1],I[0],this,D);
}
}
%SetCode(c,MapConstructor);
%FunctionSetLength(c,0);
%FunctionSetPrototype(c,new d());
%AddNamedProperty(c.prototype,"constructor",c,2);
%AddNamedProperty(
c.prototype,symbolToStringTag,"Map",2|1);
%FunctionSetLength(MapForEach,1);
b.InstallGetter(c.prototype,"size",MapGetSize);
b.InstallFunctions(c.prototype,2,[
"get",MapGet,
"set",MapSet,
"has",MapHas,
"delete",MapDelete,
"clear",MapClearJS,
"forEach",MapForEach
]);
$getHash=GetHash;
$getExistingHash=GetExistingHash;
$mapFromArray=function(M){
var N=new c;
var O=M.length;
for(var P=0;P<O;P+=2){
var n=M[P];
var x=M[P+1];
%_CallFunction(N,n,x,MapSet);
}
return N;
};
$setFromArray=function(M){
var Q=new e;
var O=M.length;
for(var P=0;P<O;++P){
%_CallFunction(Q,M[P],SetAdd);
}
return Q;
};
})

<weak-collectionM0
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Object;
var d=a.WeakMap;
var e=a.WeakSet;
function WeakMapConstructor(g){
if(!%_IsConstructCall()){
throw MakeTypeError(20,"WeakMap");
}
%WeakCollectionInitialize(this);
if(!(g==null)){
var h=this.set;
if(!(%_ClassOf(h)==='Function')){
throw MakeTypeError(77,'set',this);
}
for(var i of g){
if(!(%_IsSpecObject(i))){
throw MakeTypeError(39,i);
}
%_CallFunction(this,i[0],i[1],h);
}
}
}
function WeakMapGet(j){
if(!(%_ClassOf(this)==='WeakMap')){
throw MakeTypeError(33,
'WeakMap.prototype.get',this);
}
if(!(%_IsSpecObject(j)))return(void 0);
var k=$getExistingHash(j);
if((k===(void 0)))return(void 0);
return %WeakCollectionGet(this,j,k);
}
function WeakMapSet(j,l){
if(!(%_ClassOf(this)==='WeakMap')){
throw MakeTypeError(33,
'WeakMap.prototype.set',this);
}
if(!(%_IsSpecObject(j)))throw MakeTypeError(134);
return %WeakCollectionSet(this,j,l,$getHash(j));
}
function WeakMapHas(j){
if(!(%_ClassOf(this)==='WeakMap')){
throw MakeTypeError(33,
'WeakMap.prototype.has',this);
}
if(!(%_IsSpecObject(j)))return false;
var k=$getExistingHash(j);
if((k===(void 0)))return false;
return %WeakCollectionHas(this,j,k);
}
function WeakMapDelete(j){
if(!(%_ClassOf(this)==='WeakMap')){
throw MakeTypeError(33,
'WeakMap.prototype.delete',this);
}
if(!(%_IsSpecObject(j)))return false;
var k=$getExistingHash(j);
if((k===(void 0)))return false;
return %WeakCollectionDelete(this,j,k);
}
%SetCode(d,WeakMapConstructor);
%FunctionSetLength(d,0);
%FunctionSetPrototype(d,new c());
%AddNamedProperty(d.prototype,"constructor",d,
2);
%AddNamedProperty(d.prototype,symbolToStringTag,"WeakMap",
2|1);
b.InstallFunctions(d.prototype,2,[
"get",WeakMapGet,
"set",WeakMapSet,
"has",WeakMapHas,
"delete",WeakMapDelete
]);
function WeakSetConstructor(g){
if(!%_IsConstructCall()){
throw MakeTypeError(20,"WeakSet");
}
%WeakCollectionInitialize(this);
if(!(g==null)){
var h=this.add;
if(!(%_ClassOf(h)==='Function')){
throw MakeTypeError(77,'add',this);
}
for(var l of g){
%_CallFunction(this,l,h);
}
}
}
function WeakSetAdd(l){
if(!(%_ClassOf(this)==='WeakSet')){
throw MakeTypeError(33,
'WeakSet.prototype.add',this);
}
if(!(%_IsSpecObject(l)))throw MakeTypeError(135);
return %WeakCollectionSet(this,l,true,$getHash(l));
}
function WeakSetHas(l){
if(!(%_ClassOf(this)==='WeakSet')){
throw MakeTypeError(33,
'WeakSet.prototype.has',this);
}
if(!(%_IsSpecObject(l)))return false;
var k=$getExistingHash(l);
if((k===(void 0)))return false;
return %WeakCollectionHas(this,l,k);
}
function WeakSetDelete(l){
if(!(%_ClassOf(this)==='WeakSet')){
throw MakeTypeError(33,
'WeakSet.prototype.delete',this);
}
if(!(%_IsSpecObject(l)))return false;
var k=$getExistingHash(l);
if((k===(void 0)))return false;
return %WeakCollectionDelete(this,l,k);
}
%SetCode(e,WeakSetConstructor);
%FunctionSetLength(e,0);
%FunctionSetPrototype(e,new c());
%AddNamedProperty(e.prototype,"constructor",e,
2);
%AddNamedProperty(e.prototype,symbolToStringTag,"WeakSet",
2|1);
b.InstallFunctions(e.prototype,2,[
"add",WeakSetAdd,
"has",WeakSetHas,
"delete",WeakSetDelete
]);
})

Lcollection-iterator¥+
var $mapEntries;
var $mapIteratorNext;
var $setIteratorNext;
var $setValues;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Map;
var d=a.Set;
function SetIteratorConstructor(e,g){
%SetIteratorInitialize(this,e,g);
}
function SetIteratorNextJS(){
if(!(%_ClassOf(this)==='Set Iterator')){
throw MakeTypeError(33,
'Set Iterator.prototype.next',this);
}
var h=[(void 0),(void 0)];
var i={value:h,done:false};
switch(%SetIteratorNext(this,h)){
case 0:
i.value=(void 0);
i.done=true;
break;
case 2:
i.value=h[0];
break;
case 3:
h[1]=h[0];
break;
}
return i;
}
function SetEntries(){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(33,
'Set.prototype.entries',this);
}
return new SetIterator(this,3);
}
function SetValues(){
if(!(%_ClassOf(this)==='Set')){
throw MakeTypeError(33,
'Set.prototype.values',this);
}
return new SetIterator(this,2);
}
%SetCode(SetIterator,SetIteratorConstructor);
%FunctionSetPrototype(SetIterator,{__proto__:$iteratorPrototype});
%FunctionSetInstanceClassName(SetIterator,'Set Iterator');
b.InstallFunctions(SetIterator.prototype,2,[
'next',SetIteratorNextJS
]);
%AddNamedProperty(SetIterator.prototype,symbolToStringTag,
"Set Iterator",1|2);
b.InstallFunctions(d.prototype,2,[
'entries',SetEntries,
'keys',SetValues,
'values',SetValues
]);
%AddNamedProperty(d.prototype,symbolIterator,SetValues,2);
$setIteratorNext=SetIteratorNextJS;
$setValues=SetValues;
function MapIteratorConstructor(j,g){
%MapIteratorInitialize(this,j,g);
}
function MapIteratorNextJS(){
if(!(%_ClassOf(this)==='Map Iterator')){
throw MakeTypeError(33,
'Map Iterator.prototype.next',this);
}
var h=[(void 0),(void 0)];
var i={value:h,done:false};
switch(%MapIteratorNext(this,h)){
case 0:
i.value=(void 0);
i.done=true;
break;
case 1:
i.value=h[0];
break;
case 2:
i.value=h[1];
break;
}
return i;
}
function MapEntries(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.entries',this);
}
return new MapIterator(this,3);
}
function MapKeys(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.keys',this);
}
return new MapIterator(this,1);
}
function MapValues(){
if(!(%_ClassOf(this)==='Map')){
throw MakeTypeError(33,
'Map.prototype.values',this);
}
return new MapIterator(this,2);
}
%SetCode(MapIterator,MapIteratorConstructor);
%FunctionSetPrototype(MapIterator,{__proto__:$iteratorPrototype});
%FunctionSetInstanceClassName(MapIterator,'Map Iterator');
b.InstallFunctions(MapIterator.prototype,2,[
'next',MapIteratorNextJS
]);
%AddNamedProperty(MapIterator.prototype,symbolToStringTag,
"Map Iterator",1|2);
b.InstallFunctions(c.prototype,2,[
'entries',MapEntries,
'keys',MapKeys,
'values',MapValues
]);
%AddNamedProperty(c.prototype,symbolIterator,MapEntries,2);
$mapEntries=MapEntries;
$mapIteratorNext=MapIteratorNextJS;
})

promise9e
var $promiseCreate;
var $promiseResolve;
var $promiseReject;
var $promiseChain;
var $promiseCatch;
var $promiseThen;
var $promiseHasUserDefinedRejectHandler;
var $promiseStatus;
var $promiseValue;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=b.InternalArray;
var d=(%CreateGlobalPrivateOwnSymbol("Promise#status"));
var e=(%CreateGlobalPrivateOwnSymbol("Promise#value"));
var g=(%CreateGlobalPrivateOwnSymbol("Promise#onResolve"));
var h=(%CreateGlobalPrivateOwnSymbol("Promise#onReject"));
var i=(%CreateGlobalPrivateOwnSymbol("Promise#raw"));
var j=%PromiseHasHandlerSymbol();
var k=0;
var l=function Promise(m){
if(m===i)return;
if(!%_IsConstructCall())throw MakeTypeError(51,this);
if(!(%_ClassOf(m)==='Function'))
throw MakeTypeError(96,m);
var n=PromiseInit(this);
try{
%DebugPushPromise(n,Promise);
m(function(o){PromiseResolve(n,o)},
function(p){PromiseReject(n,p)});
}catch(e){
PromiseReject(n,e);
}finally{
%DebugPopPromise();
}
}
function PromiseSet(n,q,r,t,u){
(n[d]=q);
(n[e]=r);
(n[g]=t);
(n[h]=u);
if((%_DebugIsActive()!=0)){
%DebugPromiseEvent({promise:n,status:q,value:r});
}
return n;
}
function PromiseCreateAndSet(q,r){
var n=new l(i);
if((%_DebugIsActive()!=0))PromiseSet(n,0,(void 0));
return PromiseSet(n,q,r);
}
function PromiseInit(n){
return PromiseSet(
n,0,(void 0),new c,new c)
}
function PromiseDone(n,q,r,v){
if((n[d])===0){
var w=(n[v]);
if(w.length)PromiseEnqueue(r,w,q);
PromiseSet(n,q,r);
}
}
function PromiseCoerce(x,o){
if(!IsPromise(o)&&(%_IsSpecObject(o))){
var y;
try{
y=o.then;
}catch(p){
return %_CallFunction(x,p,PromiseRejected);
}
if((%_ClassOf(y)==='Function')){
var z=%_CallFunction(x,PromiseDeferred);
try{
%_CallFunction(o,z.resolve,z.reject,y);
}catch(p){
z.reject(p);
}
return z.promise;
}
}
return o;
}
function PromiseHandle(r,A,z){
try{
%DebugPushPromise(z.promise,PromiseHandle);
if((%_DebugIsActive()!=0&&%DebugCallbackSupportsStepping(A)))%DebugPrepareStepInIfStepping(A);
var B=A(r);
if(B===z.promise)
throw MakeTypeError(75,B);
else if(IsPromise(B))
%_CallFunction(B,z.resolve,z.reject,PromiseChain);
else
z.resolve(B);
}catch(exception){
try{z.reject(exception);}catch(e){}
}finally{
%DebugPopPromise();
}
}
function PromiseEnqueue(r,w,q){
var C,D,E=(%_DebugIsActive()!=0);
%EnqueueMicrotask(function(){
if(E){
%DebugAsyncTaskEvent({type:"willHandle",id:C,name:D});
}
for(var F=0;F<w.length;F+=2){
PromiseHandle(r,w[F],w[F+1])
}
if(E){
%DebugAsyncTaskEvent({type:"didHandle",id:C,name:D});
}
});
if(E){
C=++k;
D=q>0?"Promise.resolve":"Promise.reject";
%DebugAsyncTaskEvent({type:"enqueue",id:C,name:D});
}
}
function PromiseIdResolveHandler(o){return o}
function PromiseIdRejectHandler(p){throw p}
function PromiseNopResolver(){}
function IsPromise(o){
return(%_IsSpecObject(o))&&(!(o[d]===(void 0)));
}
function PromiseCreate(){
return new l(PromiseNopResolver)
}
function PromiseResolve(n,o){
PromiseDone(n,+1,o,g)
}
function PromiseReject(n,p){
if((n[d])==0){
var G=(%_DebugIsActive()!=0);
if(G||!(!(n[j]===(void 0)))){
%PromiseRejectEvent(n,p,G);
}
}
PromiseDone(n,-1,p,h)
}
function PromiseDeferred(){
if(this===l){
var n=PromiseInit(new l(i));
return{
promise:n,
resolve:function(o){PromiseResolve(n,o)},
reject:function(p){PromiseReject(n,p)}
};
}else{
var B={};
B.promise=new this(function(H,I){
B.resolve=H;
B.reject=I;
})
return B;
}
}
function PromiseResolved(o){
if(this===l){
return PromiseCreateAndSet(+1,o);
}else{
return new this(function(H,I){H(o)});
}
}
function PromiseRejected(p){
var n;
if(this===l){
n=PromiseCreateAndSet(-1,p);
%PromiseRejectEvent(n,p,false);
}else{
n=new this(function(H,I){I(p)});
}
return n;
}
function PromiseChain(t,u){
t=(t===(void 0))?PromiseIdResolveHandler:t;
u=(u===(void 0))?PromiseIdRejectHandler:u;
var z=%_CallFunction(this.constructor,PromiseDeferred);
switch((this[d])){
case(void 0):
throw MakeTypeError(51,this);
case 0:
(this[g]).push(t,z);
(this[h]).push(u,z);
break;
case+1:
PromiseEnqueue((this[e]),
[t,z],
+1);
break;
case-1:
if(!(!(this[j]===(void 0)))){
%PromiseRevokeReject(this);
}
PromiseEnqueue((this[e]),
[u,z],
-1);
break;
}
(this[j]=true);
if((%_DebugIsActive()!=0)){
%DebugPromiseEvent({promise:z.promise,parentPromise:this});
}
return z.promise;
}
function PromiseCatch(u){
return this.then((void 0),u);
}
function PromiseThen(t,u){
t=(%_ClassOf(t)==='Function')?t
:PromiseIdResolveHandler;
u=(%_ClassOf(u)==='Function')?u
:PromiseIdRejectHandler;
var J=this;
var x=this.constructor;
return %_CallFunction(
this,
function(o){
o=PromiseCoerce(x,o);
if(o===J){
if((%_DebugIsActive()!=0&&%DebugCallbackSupportsStepping(u)))%DebugPrepareStepInIfStepping(u);
return u(MakeTypeError(75,o));
}else if(IsPromise(o)){
return o.then(t,u);
}else{
if((%_DebugIsActive()!=0&&%DebugCallbackSupportsStepping(t)))%DebugPrepareStepInIfStepping(t);
return t(o);
}
},
u,
PromiseChain
);
}
function PromiseCast(o){
return IsPromise(o)?o:new this(function(H){H(o)});
}
function PromiseAll(K){
var z=%_CallFunction(this,PromiseDeferred);
var L=[];
try{
var M=0;
var F=0;
for(var r of K){
this.resolve(r).then(
(function(F){
return function(o){
L[F]=o;
if(--M===0)z.resolve(L);
}
})(F),
function(p){z.reject(p);});
++F;
++M;
}
if(M===0){
z.resolve(L);
}
}catch(e){
z.reject(e)
}
return z.promise;
}
function PromiseRace(K){
var z=%_CallFunction(this,PromiseDeferred);
try{
for(var r of K){
this.resolve(r).then(
function(o){z.resolve(o)},
function(p){z.reject(p)});
}
}catch(e){
z.reject(e)
}
return z.promise;
}
function PromiseHasUserDefinedRejectHandlerRecursive(n){
var N=(n[h]);
if((N===(void 0)))return false;
for(var F=0;F<N.length;F+=2){
if(N[F]!=PromiseIdRejectHandler)return true;
if(PromiseHasUserDefinedRejectHandlerRecursive(N[F+1].promise)){
return true;
}
}
return false;
}
function PromiseHasUserDefinedRejectHandler(){
return PromiseHasUserDefinedRejectHandlerRecursive(this);
};
%AddNamedProperty(a,'Promise',l,2);
%AddNamedProperty(l.prototype,symbolToStringTag,"Promise",
2|1);
b.InstallFunctions(l,2,[
"defer",PromiseDeferred,
"accept",PromiseResolved,
"reject",PromiseRejected,
"all",PromiseAll,
"race",PromiseRace,
"resolve",PromiseCast
]);
b.InstallFunctions(l.prototype,2,[
"chain",PromiseChain,
"then",PromiseThen,
"catch",PromiseCatch
]);
$promiseCreate=PromiseCreate;
$promiseResolve=PromiseResolve;
$promiseReject=PromiseReject;
$promiseChain=PromiseChain;
$promiseCatch=PromiseCatch;
$promiseThen=PromiseThen;
$promiseHasUserDefinedRejectHandler=PromiseHasUserDefinedRejectHandler;
$promiseStatus=d;
$promiseValue=e;
})

 messagesíõ
var $errorToString;
var $getStackTraceLine;
var $messageGetPositionInLine;
var $messageGetLineNumber;
var $messageGetSourceLine;
var $noSideEffectToString;
var $stackOverflowBoilerplate;
var $stackTraceSymbol;
var $toDetailString;
var $Error;
var $EvalError;
var $RangeError;
var $ReferenceError;
var $SyntaxError;
var $TypeError;
var $URIError;
var MakeError;
var MakeEvalError;
var MakeRangeError;
var MakeReferenceError;
var MakeSyntaxError;
var MakeTypeError;
var MakeURIError;
(function(a,b){
%CheckIsBootstrapping();
var c=a.Object;
var d=b.InternalArray;
var e=b.ObjectDefineProperty;
var g;
var h;
var i;
var j;
var k;
b.Import(function(l){
g=l.ArrayJoin;
h=l.ObjectToString;
i=l.StringCharAt;
j=l.StringIndexOf;
k=l.StringSubstring;
});
var m;
var n;
var o;
var p;
var q;
var r;
var t;
function NoSideEffectsObjectToString(){
if((this===(void 0))&&!(%_IsUndetectableObject(this)))return"[object Undefined]";
if((this===null))return"[object Null]";
return"[object "+%_ClassOf(((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this)))+"]";
}
function NoSideEffectToString(u){
if((typeof(u)==='string'))return u;
if((typeof(u)==='number'))return %_NumberToString(u);
if((typeof(u)==='boolean'))return u?'true':'false';
if((u===(void 0)))return'undefined';
if((u===null))return'null';
if((%_IsFunction(u))){
var v=%_CallFunction(u,u,$functionSourceString);
if(v.length>128){
v=%_SubString(v,0,111)+"...<omitted>..."+
%_SubString(v,v.length-2,v.length);
}
return v;
}
if((typeof(u)==='symbol'))return %_CallFunction(u,$symbolToString);
if((%_IsObject(u))
&&%GetDataProperty(u,"toString")===h){
var w=%GetDataProperty(u,"constructor");
if(typeof w=="function"){
var x=w.name;
if((typeof(x)==='string')&&x!==""){
return"#<"+x+">";
}
}
}
if(CanBeSafelyTreatedAsAnErrorObject(u)){
return %_CallFunction(u,ErrorToString);
}
return %_CallFunction(u,NoSideEffectsObjectToString);
}
function CanBeSafelyTreatedAsAnErrorObject(u){
switch(%_ClassOf(u)){
case'Error':
case'EvalError':
case'RangeError':
case'ReferenceError':
case'SyntaxError':
case'TypeError':
case'URIError':
return true;
}
var y=%GetDataProperty(u,"toString");
return u instanceof m&&y===ErrorToString;
}
function ToStringCheckErrorObject(u){
if(CanBeSafelyTreatedAsAnErrorObject(u)){
return %_CallFunction(u,ErrorToString);
}else{
return $toString(u);
}
}
function ToDetailString(u){
if(u!=null&&(%_IsObject(u))&&u.toString===h){
var w=u.constructor;
if(typeof w=="function"){
var x=w.name;
if((typeof(x)==='string')&&x!==""){
return"#<"+x+">";
}
}
}
return ToStringCheckErrorObject(u);
}
function MakeGenericError(w,z,A,B,C){
if((A===(void 0))&&(typeof(z)==='string'))A=[];
return new w(FormatMessage(z,A,B,C));
}
%FunctionSetInstanceClassName(Script,'Script');
%AddNamedProperty(Script.prototype,'constructor',Script,
2|4|1);
%SetCode(Script,function(D){
throw MakeError(5);
});
function FormatMessage(z,A,B,C){
var A=NoSideEffectToString(A);
var B=NoSideEffectToString(B);
var C=NoSideEffectToString(C);
try{
return %FormatMessageString(z,A,B,C);
}catch(e){
return"<error>";
}
}
function GetLineNumber(E){
var F=%MessageGetStartPosition(E);
if(F==-1)return 0;
var G=%MessageGetScript(E);
var H=G.locationFromPosition(F,true);
if(H==null)return 0;
return H.line+1;
}
function GetSourceLine(E){
var G=%MessageGetScript(E);
var F=%MessageGetStartPosition(E);
var H=G.locationFromPosition(F,true);
if(H==null)return"";
return H.sourceText();
}
function ScriptLineFromPosition(I){
var J=0;
var K=this.lineCount()-1;
var L=this.line_ends;
if(I>L[K]){
return-1;
}
if(I<=L[0]){
return 0;
}
while(K>=1){
var M=(J+K)>>1;
if(I>L[M]){
J=M+1;
}else if(I<=L[M-1]){
K=M-1;
}else{
return M;
}
}
return-1;
}
function ScriptLocationFromPosition(I,
include_resource_offset){
var N=this.lineFromPosition(I);
if(N==-1)return null;
var L=this.line_ends;
var O=N==0?0:L[N-1]+1;
var P=L[N];
if(P>0&&%_CallFunction(this.source,P-1,i)=='\r'){
P--;
}
var Q=I-O;
if(include_resource_offset){
N+=this.line_offset;
if(N==this.line_offset){
Q+=this.column_offset;
}
}
return new SourceLocation(this,I,N,Q,O,P);
}
function ScriptLocationFromLine(R,S,T){
var N=0;
if(!(R===(void 0))){
N=R-this.line_offset;
}
var Q=S||0;
if(N==0){
Q-=this.column_offset;
}
var U=T||0;
if(N<0||Q<0||U<0)return null;
if(N==0){
return this.locationFromPosition(U+Q,false);
}else{
var V=this.lineFromPosition(U);
if(V==-1||V+N>=this.lineCount()){
return null;
}
return this.locationFromPosition(
this.line_ends[V+N-1]+1+Q);
}
}
function ScriptSourceSlice(W,X){
var Y=(W===(void 0))?this.line_offset
:W;
var Z=(X===(void 0))?this.line_offset+this.lineCount()
:X;
Y-=this.line_offset;
Z-=this.line_offset;
if(Y<0)Y=0;
if(Z>this.lineCount())Z=this.lineCount();
if(Y>=this.lineCount()||
Z<0||
Y>Z){
return null;
}
var L=this.line_ends;
var aa=Y==0?0:L[Y-1]+1;
var ab=Z==0?0:L[Z-1]+1;
return new SourceSlice(this,
Y+this.line_offset,
Z+this.line_offset,
aa,ab);
}
function ScriptSourceLine(R){
var N=0;
if(!(R===(void 0))){
N=R-this.line_offset;
}
if(N<0||this.lineCount()<=N){
return null;
}
var L=this.line_ends;
var O=N==0?0:L[N-1]+1;
var P=L[N];
return %_CallFunction(this.source,O,P,k);
}
function ScriptLineCount(){
return this.line_ends.length;
}
function ScriptNameOrSourceURL(){
if(this.source_url)return this.source_url;
return this.name;
}
b.SetUpLockedPrototype(Script,[
"source",
"name",
"source_url",
"source_mapping_url",
"line_ends",
"line_offset",
"column_offset"
],[
"lineFromPosition",ScriptLineFromPosition,
"locationFromPosition",ScriptLocationFromPosition,
"locationFromLine",ScriptLocationFromLine,
"sourceSlice",ScriptSourceSlice,
"sourceLine",ScriptSourceLine,
"lineCount",ScriptLineCount,
"nameOrSourceURL",ScriptNameOrSourceURL
]
);
function SourceLocation(G,I,N,Q,O,P){
this.script=G;
this.position=I;
this.line=N;
this.column=Q;
this.start=O;
this.end=P;
}
function SourceLocationSourceText(){
return %_CallFunction(this.script.source,
this.start,
this.end,
k);
}
b.SetUpLockedPrototype(SourceLocation,
["script","position","line","column","start","end"],
["sourceText",SourceLocationSourceText]
);
function SourceSlice(G,Y,Z,aa,ab){
this.script=G;
this.from_line=Y;
this.to_line=Z;
this.from_position=aa;
this.to_position=ab;
}
function SourceSliceSourceText(){
return %_CallFunction(this.script.source,
this.from_position,
this.to_position,
k);
}
b.SetUpLockedPrototype(SourceSlice,
["script","from_line","to_line","from_position","to_position"],
["sourceText",SourceSliceSourceText]
);
function GetPositionInLine(E){
var G=%MessageGetScript(E);
var F=%MessageGetStartPosition(E);
var H=G.locationFromPosition(F,false);
if(H==null)return-1;
return F-H.start;
}
function GetStackTraceLine(ac,ad,ae,af){
return new CallSite(ac,ad,ae,false).toString();
}
var ag=(%CreatePrivateOwnSymbol("CallSite#receiver"));
var ah=(%CreatePrivateOwnSymbol("CallSite#function"));
var ai=(%CreatePrivateOwnSymbol("CallSite#position"));
var aj=(%CreatePrivateOwnSymbol("CallSite#strict_mode"));
function CallSite(ak,ad,ae,al){
(this[ag]=ak);
(this[ah]=ad);
(this[ai]=ae);
(this[aj]=al);
}
function CallSiteGetThis(){
return(this[aj])
?(void 0):(this[ag]);
}
function CallSiteGetFunction(){
return(this[aj])
?(void 0):(this[ah]);
}
function CallSiteGetPosition(){
return(this[ai]);
}
function CallSiteGetTypeName(){
return GetTypeName((this[ag]),false);
}
function CallSiteIsToplevel(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteIsToplevelRT(ak,ad,ae);
}
function CallSiteIsEval(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteIsEvalRT(ak,ad,ae);
}
function CallSiteGetEvalOrigin(){
var G=%FunctionGetScript((this[ah]));
return FormatEvalOrigin(G);
}
function CallSiteGetScriptNameOrSourceURL(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteGetScriptNameOrSourceUrlRT(ak,ad,ae);
}
function CallSiteGetFunctionName(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteGetFunctionNameRT(ak,ad,ae);
}
function CallSiteGetMethodName(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteGetMethodNameRT(ak,ad,ae);
}
function CallSiteGetFileName(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteGetFileNameRT(ak,ad,ae);
}
function CallSiteGetLineNumber(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteGetLineNumberRT(ak,ad,ae);
}
function CallSiteGetColumnNumber(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteGetColumnNumberRT(ak,ad,ae);
}
function CallSiteIsNative(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteIsNativeRT(ak,ad,ae);
}
function CallSiteIsConstructor(){
var ak=(this[ag]);
var ad=(this[ah]);
var ae=(this[ai]);
return %CallSiteIsConstructorRT(ak,ad,ae);
}
function CallSiteToString(){
var am;
var an="";
if(this.isNative()){
an="native";
}else{
am=this.getScriptNameOrSourceURL();
if(!am&&this.isEval()){
an=this.getEvalOrigin();
an+=", ";
}
if(am){
an+=am;
}else{
an+="<anonymous>";
}
var ao=this.getLineNumber();
if(ao!=null){
an+=":"+ao;
var ap=this.getColumnNumber();
if(ap){
an+=":"+ap;
}
}
}
var N="";
var aq=this.getFunctionName();
var ar=true;
var as=this.isConstructor();
var at=!(this.isToplevel()||as);
if(at){
var au=GetTypeName((this[ag]),true);
var av=this.getMethodName();
if(aq){
if(au&&
%_CallFunction(aq,au,j)!=0){
N+=au+".";
}
N+=aq;
if(av&&
(%_CallFunction(aq,"."+av,j)!=
aq.length-av.length-1)){
N+=" [as "+av+"]";
}
}else{
N+=au+"."+(av||"<anonymous>");
}
}else if(as){
N+="new "+(aq||"<anonymous>");
}else if(aq){
N+=aq;
}else{
N+=an;
ar=false;
}
if(ar){
N+=" ("+an+")";
}
return N;
}
b.SetUpLockedPrototype(CallSite,["receiver","fun","pos"],[
"getThis",CallSiteGetThis,
"getTypeName",CallSiteGetTypeName,
"isToplevel",CallSiteIsToplevel,
"isEval",CallSiteIsEval,
"getEvalOrigin",CallSiteGetEvalOrigin,
"getScriptNameOrSourceURL",CallSiteGetScriptNameOrSourceURL,
"getFunction",CallSiteGetFunction,
"getFunctionName",CallSiteGetFunctionName,
"getMethodName",CallSiteGetMethodName,
"getFileName",CallSiteGetFileName,
"getLineNumber",CallSiteGetLineNumber,
"getColumnNumber",CallSiteGetColumnNumber,
"isNative",CallSiteIsNative,
"getPosition",CallSiteGetPosition,
"isConstructor",CallSiteIsConstructor,
"toString",CallSiteToString
]);
function FormatEvalOrigin(G){
var aw=G.nameOrSourceURL();
if(aw){
return aw;
}
var ax="eval at ";
if(G.eval_from_function_name){
ax+=G.eval_from_function_name;
}else{
ax+="<anonymous>";
}
var ay=G.eval_from_script;
if(ay){
if(ay.compilation_type==1){
ax+=" ("+FormatEvalOrigin(ay)+")";
}else{
if(ay.name){
ax+=" ("+ay.name;
var H=ay.locationFromPosition(
G.eval_from_script_position,true);
if(H){
ax+=":"+(H.line+1);
ax+=":"+(H.column+1);
}
ax+=")";
}else{
ax+=" (unknown source)";
}
}
}
return ax;
}
function FormatErrorString(az){
try{
return %_CallFunction(az,ErrorToString);
}catch(e){
try{
return"<error: "+e+">";
}catch(ee){
return"<error>";
}
}
}
function GetStackFrames(aA){
var aB=new d();
var aC=aA[0];
for(var M=1;M<aA.length;M+=4){
var ac=aA[M];
var ad=aA[M+1];
var aD=aA[M+2];
var aE=aA[M+3];
var ae=%_IsSmi(aD)?aD:%FunctionGetPositionForOffset(aD,aE);
aC--;
aB.push(new CallSite(ac,ad,ae,(aC<0)));
}
return aB;
}
var aF=false;
function FormatStackTrace(u,aA){
var aB=GetStackFrames(aA);
if((%_IsFunction(m.prepareStackTrace))&&
!aF){
var aG=[];
%MoveArrayContents(aB,aG);
aF=true;
var aH=(void 0);
try{
aH=m.prepareStackTrace(u,aG);
}catch(e){
throw e;
}finally{
aF=false;
}
return aH;
}
var aI=new d();
aI.push(FormatErrorString(u));
for(var M=0;M<aB.length;M++){
var aJ=aB[M];
var N;
try{
N=aJ.toString();
}catch(e){
try{
N="<error: "+e+">";
}catch(ee){
N="<error>";
}
}
aI.push("    at "+N);
}
return %_CallFunction(aI,"\n",g);
}
function GetTypeName(ak,aK){
var w=ak.constructor;
if(!w){
return aK?null:
%_CallFunction(ak,NoSideEffectsObjectToString);
}
var x=w.name;
if(!x){
return aK?null:
%_CallFunction(ak,NoSideEffectsObjectToString);
}
return x;
}
var aL=(%CreatePrivateOwnSymbol("formatted stack trace"));
var aM=function(){
var aN=(void 0);
var aO=this;
while(aO){
var aN=
(aO[aL]);
if((aN===(void 0))){
var aH=(aO[$stackTraceSymbol]);
if((aH===(void 0))){
aO=%_GetPrototype(aO);
continue;
}
aN=FormatStackTrace(aO,aH);
(aO[$stackTraceSymbol]=(void 0));
(aO[aL]=aN);
}
return aN;
}
return(void 0);
};
var aP=function(aQ){
if((%HasOwnProperty(this,$stackTraceSymbol))){
(this[$stackTraceSymbol]=(void 0));
(this[aL]=aQ);
}
};
var aR=function(){};
function DefineError(a,aS){
var aT=aS.name;
%AddNamedProperty(a,aT,aS,2);
if(aT=='Error'){
var aU=function(){};
%FunctionSetPrototype(aU,c.prototype);
%FunctionSetInstanceClassName(aU,'Error');
%FunctionSetPrototype(aS,new aU());
}else{
%FunctionSetPrototype(aS,new m());
%InternalSetPrototype(aS,m);
}
%FunctionSetInstanceClassName(aS,'Error');
%AddNamedProperty(aS.prototype,'constructor',aS,2);
%AddNamedProperty(aS.prototype,'name',aT,2);
%SetCode(aS,function(aV){
if(%_IsConstructCall()){
try{aR(this,aS);}catch(e){}
if(!(aV===(void 0))){
%AddNamedProperty(this,'message',$toString(aV),2);
}
}else{
return new aS(aV);
}
});
%SetNativeFlag(aS);
return aS;
};
m=DefineError(a,function Error(){});
t=DefineError(a,function EvalError(){});
o=DefineError(a,function RangeError(){});
r=DefineError(a,function ReferenceError(){});
q=DefineError(a,function SyntaxError(){});
n=DefineError(a,function TypeError(){});
p=DefineError(a,function URIError(){});
%AddNamedProperty(m.prototype,'message','',2);
var aW=new d();
var aX=new c();
function GetPropertyWithoutInvokingMonkeyGetters(az,aT){
var aY=az;
while(aY&&!%HasOwnProperty(aY,aT)){
aY=%_GetPrototype(aY);
}
if((aY===null))return(void 0);
if(!(%_IsObject(aY)))return az[aT];
var aZ=%GetOwnProperty(aY,aT);
if(aZ&&aZ[0]){
var ba=aT==="name";
if(aY===r.prototype)
return ba?"ReferenceError":(void 0);
if(aY===q.prototype)
return ba?"SyntaxError":(void 0);
if(aY===n.prototype)
return ba?"TypeError":(void 0);
}
return az[aT];
}
function ErrorToStringDetectCycle(az){
if(!%PushIfAbsent(aW,az))throw aX;
try{
var aT=GetPropertyWithoutInvokingMonkeyGetters(az,"name");
aT=(aT===(void 0))?"Error":((typeof(%IS_VAR(aT))==='string')?aT:$nonStringToString(aT));
var E=GetPropertyWithoutInvokingMonkeyGetters(az,"message");
E=(E===(void 0))?"":((typeof(%IS_VAR(E))==='string')?E:$nonStringToString(E));
if(aT==="")return E;
if(E==="")return aT;
return aT+": "+E;
}finally{
aW.length=aW.length-1;
}
}
function ErrorToString(){
if(!(%_IsSpecObject(this))){
throw MakeTypeError(13,"Error.prototype.toString");
}
try{
return ErrorToStringDetectCycle(this);
}catch(e){
if(e===aX){
return'';
}
throw e;
}
}
b.InstallFunctions(m.prototype,2,
['toString',ErrorToString]);
$errorToString=ErrorToString;
$getStackTraceLine=GetStackTraceLine;
$messageGetPositionInLine=GetPositionInLine;
$messageGetLineNumber=GetLineNumber;
$messageGetSourceLine=GetSourceLine;
$noSideEffectToString=NoSideEffectToString;
$toDetailString=ToDetailString;
$Error=m;
$EvalError=t;
$RangeError=o;
$ReferenceError=r;
$SyntaxError=q;
$TypeError=n;
$URIError=p;
MakeError=function(z,A,B,C){
return MakeGenericError(m,z,A,B,C);
}
MakeEvalError=function(z,A,B,C){
return MakeGenericError(t,z,A,B,C);
}
MakeRangeError=function(z,A,B,C){
return MakeGenericError(o,z,A,B,C);
}
MakeReferenceError=function(z,A,B,C){
return MakeGenericError(r,z,A,B,C);
}
MakeSyntaxError=function(z,A,B,C){
return MakeGenericError(q,z,A,B,C);
}
MakeTypeError=function(z,A,B,C){
return MakeGenericError(n,z,A,B,C);
}
MakeURIError=function(){
return MakeGenericError(p,230);
}
$stackOverflowBoilerplate=MakeRangeError(145);
%DefineAccessorPropertyUnchecked($stackOverflowBoilerplate,'stack',
aM,aP,
2);
aR=function captureStackTrace(u,bb){
e(u,'stack',{get:aM,
set:aP,
configurable:true});
%CollectStackTrace(u,bb?bb:aR);
};
m.captureStackTrace=aR;
});

json•:
var $jsonSerializeAdapter;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.JSON;
var d=b.InternalArray;
var e;
var g;
var h;
b.Import(function(i){
e=i.MathMax;
g=i.MathMin;
h=i.ObjectHasOwnProperty;
});
function Revive(j,k,l){
var m=j[k];
if((%_IsObject(m))){
if((%_IsArray(m))){
var n=m.length;
for(var o=0;o<n;o++){
var p=Revive(m,%_NumberToString(o),l);
m[o]=p;
}
}else{
for(var q in m){
if((%_CallFunction(m,q,h))){
var p=Revive(m,q,l);
if((p===(void 0))){
delete m[q];
}else{
m[q]=p;
}
}
}
}
}
return %_CallFunction(j,k,m,l);
}
function JSONParse(r,l){
var t=%ParseJson(((typeof(%IS_VAR(r))==='string')?r:$nonStringToString(r)));
if((%_ClassOf(l)==='Function')){
return Revive({'':t},'',l);
}else{
return t;
}
}
function SerializeArray(u,v,w,x,y){
if(!%PushIfAbsent(w,u))throw MakeTypeError(17);
var z=x;
x+=y;
var A=new d();
var B=u.length;
for(var o=0;o<B;o++){
var C=JSONSerialize(%_NumberToString(o),u,v,w,
x,y);
if((C===(void 0))){
C="null";
}
A.push(C);
}
var D;
if(y==""){
D="["+A.join(",")+"]";
}else if(A.length>0){
var E=",\n"+x;
D="[\n"+x+A.join(E)+"\n"+
z+"]";
}else{
D="[]";
}
w.pop();
return D;
}
function SerializeObject(u,v,w,x,y){
if(!%PushIfAbsent(w,u))throw MakeTypeError(17);
var z=x;
x+=y;
var A=new d();
if((%_IsArray(v))){
var n=v.length;
for(var o=0;o<n;o++){
if((%_CallFunction(v,o,h))){
var q=v[o];
var C=JSONSerialize(q,u,v,w,x,y);
if(!(C===(void 0))){
var F=%QuoteJSONString(q)+":";
if(y!="")F+=" ";
F+=C;
A.push(F);
}
}
}
}else{
for(var q in u){
if((%_CallFunction(u,q,h))){
var C=JSONSerialize(q,u,v,w,x,y);
if(!(C===(void 0))){
var F=%QuoteJSONString(q)+":";
if(y!="")F+=" ";
F+=C;
A.push(F);
}
}
}
}
var D;
if(y==""){
D="{"+A.join(",")+"}";
}else if(A.length>0){
var E=",\n"+x;
D="{\n"+x+A.join(E)+"\n"+
z+"}";
}else{
D="{}";
}
w.pop();
return D;
}
function JSONSerialize(G,j,v,w,x,y){
var u=j[G];
if((%_IsSpecObject(u))){
var H=u.toJSON;
if((%_ClassOf(H)==='Function')){
u=%_CallFunction(u,G,H);
}
}
if((%_ClassOf(v)==='Function')){
u=%_CallFunction(j,G,u,v);
}
if((typeof(u)==='string')){
return %QuoteJSONString(u);
}else if((typeof(u)==='number')){
return((%_IsSmi(%IS_VAR(u))||u-u==0)?%_NumberToString(u):"null");
}else if((typeof(u)==='boolean')){
return u?"true":"false";
}else if((u===null)){
return"null";
}else if((%_IsSpecObject(u))&&!(typeof u=="function")){
if((%_IsArray(u))){
return SerializeArray(u,v,w,x,y);
}else if((%_ClassOf(u)==='Number')){
u=$toNumber(u);
return((%_IsSmi(%IS_VAR(u))||u-u==0)?%_NumberToString(u):"null");
}else if((%_ClassOf(u)==='String')){
return %QuoteJSONString($toString(u));
}else if((%_ClassOf(u)==='Boolean')){
return %_ValueOf(u)?"true":"false";
}else{
return SerializeObject(u,v,w,x,y);
}
}
return(void 0);
}
function JSONStringify(u,v,I){
if(%_ArgumentsLength()==1){
return %BasicJSONStringify(u);
}
if((%_IsObject(I))){
if((%_ClassOf(I)==='Number')){
I=$toNumber(I);
}else if((%_ClassOf(I)==='String')){
I=$toString(I);
}
}
var y;
if((typeof(I)==='number')){
I=e(0,g($toInteger(I),10));
y=%_SubString("          ",0,I);
}else if((typeof(I)==='string')){
if(I.length>10){
y=%_SubString(I,0,10);
}else{
y=I;
}
}else{
y="";
}
if((%_IsArray(v))){
var J=new d();
var K={__proto__:null};
var L={};
var n=v.length;
for(var o=0;o<n;o++){
var M=v[o];
if((%_ClassOf(M)==='String')){
M=$toString(M);
}else{
if((%_ClassOf(M)==='Number'))M=$toNumber(M);
if((typeof(M)==='number'))M=%_NumberToString(M);
}
if((typeof(M)==='string')&&K[M]!=L){
J.push(M);
K[M]=L;
}
}
v=J;
}
return JSONSerialize('',{'':u},v,new d(),"",y);
}
%AddNamedProperty(c,symbolToStringTag,"JSON",1|2);
b.InstallFunctions(c,2,[
"parse",JSONParse,
"stringify",JSONStringify
]);
$jsonSerializeAdapter=function(G,N){
var j={};
j[G]=N;
return JSONSerialize(G,j,(void 0),new d(),"","");
}
})

8array-iteratorA
var $arrayValues;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Array;
var d=a.Uint8Array;

var e=a.Int8Array;

var g=a.Uint16Array;

var h=a.Int16Array;

var i=a.Uint32Array;

var j=a.Int32Array;

var k=a.Float32Array;

var l=a.Float64Array;

var m=a.Uint8ClampedArray;


var n=(%CreateGlobalPrivateOwnSymbol("ArrayIterator#object"));
var o=(%CreateGlobalPrivateOwnSymbol("ArrayIterator#next"));
var p=(%CreateGlobalPrivateOwnSymbol("ArrayIterator#kind"));
function ArrayIterator(){}
function CreateArrayIterator(q,r){
var t=$toObject(q);
var u=new ArrayIterator;
(u[n]=t);
(u[o]=0);
(u[p]=r);
return u;
}
function CreateIteratorResultObject(v,w){
return{value:v,done:w};
}
function ArrayIteratorIterator(){
return this;
}
function ArrayIteratorNext(){
var u=$toObject(this);
if(!(!(u[o]===(void 0)))){
throw MakeTypeError(33,
'Array Iterator.prototype.next',this);
}
var q=(u[n]);
if((q===(void 0))){
return CreateIteratorResultObject((void 0),true);
}
var x=(u[o]);
var y=(u[p]);
var z=(q.length>>>0);
if(x>=z){
(u[n]=(void 0));
return CreateIteratorResultObject((void 0),true);
}
(u[o]=x+1);
if(y==2){
return CreateIteratorResultObject(q[x],false);
}
if(y==3){
return CreateIteratorResultObject([x,q[x]],false);
}
return CreateIteratorResultObject(x,false);
}
function ArrayEntries(){
return CreateArrayIterator(this,3);
}
function ArrayValues(){
return CreateArrayIterator(this,2);
}
function ArrayKeys(){
return CreateArrayIterator(this,1);
}
%FunctionSetPrototype(ArrayIterator,{__proto__:$iteratorPrototype});
%FunctionSetInstanceClassName(ArrayIterator,'Array Iterator');
b.InstallFunctions(ArrayIterator.prototype,2,[
'next',ArrayIteratorNext
]);
b.SetFunctionName(ArrayIteratorIterator,symbolIterator);
%AddNamedProperty(ArrayIterator.prototype,symbolIterator,
ArrayIteratorIterator,2);
%AddNamedProperty(ArrayIterator.prototype,symbolToStringTag,
"Array Iterator",1|2);
b.InstallFunctions(c.prototype,2,[
'entries',ArrayEntries,
'keys',ArrayKeys
]);
%AddNamedProperty(c.prototype,symbolIterator,ArrayValues,
2);
%AddNamedProperty(d.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(d.prototype,'values',ArrayValues,2);
%AddNamedProperty(d.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(d.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(e.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(e.prototype,'values',ArrayValues,2);
%AddNamedProperty(e.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(e.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(g.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(g.prototype,'values',ArrayValues,2);
%AddNamedProperty(g.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(g.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(h.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(h.prototype,'values',ArrayValues,2);
%AddNamedProperty(h.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(h.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(i.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(i.prototype,'values',ArrayValues,2);
%AddNamedProperty(i.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(i.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(j.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(j.prototype,'values',ArrayValues,2);
%AddNamedProperty(j.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(j.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(k.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(k.prototype,'values',ArrayValues,2);
%AddNamedProperty(k.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(k.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(l.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(l.prototype,'values',ArrayValues,2);
%AddNamedProperty(l.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(l.prototype,symbolIterator,ArrayValues,
2);

%AddNamedProperty(m.prototype,'entries',ArrayEntries,2);
%AddNamedProperty(m.prototype,'values',ArrayValues,2);
%AddNamedProperty(m.prototype,'keys',ArrayKeys,2);
%AddNamedProperty(m.prototype,symbolIterator,ArrayValues,
2);


b.Export(function(A){
A.ArrayIteratorCreateResultObject=CreateIteratorResultObject;
});
$arrayValues=ArrayValues;
})

<string-iterator=
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.String;
var d;
b.Import(function(e){
d=e.ArrayIteratorCreateResultObject;
});
var g=
(%CreateGlobalPrivateOwnSymbol("StringIterator#iteratedString"));
var h=(%CreateGlobalPrivateOwnSymbol("StringIterator#next"));
function StringIterator(){}
function CreateStringIterator(i){
var j=((typeof(%IS_VAR(i))==='string')?i:$nonStringToString(i));
var k=new StringIterator;
(k[g]=j);
(k[h]=0);
return k;
}
function StringIteratorNext(){
var k=$toObject(this);
if(!(!(k[h]===(void 0)))){
throw MakeTypeError(33,
'String Iterator.prototype.next');
}
var j=(k[g]);
if((j===(void 0))){
return d((void 0),true);
}
var l=(k[h]);
var m=(j.length>>>0);
if(l>=m){
(k[g]=(void 0));
return d((void 0),true);
}
var n=%_StringCharCodeAt(j,l);
var o=%_StringCharFromCode(n);
l++;
if(n>=0xD800&&n<=0xDBFF&&l<m){
var p=%_StringCharCodeAt(j,l);
if(p>=0xDC00&&p<=0xDFFF){
o+=%_StringCharFromCode(p);
l++;
}
}
(k[h]=l);
return d(o,false);
}
function StringPrototypeIterator(){
return CreateStringIterator(this);
}
%FunctionSetPrototype(StringIterator,{__proto__:$iteratorPrototype});
%FunctionSetInstanceClassName(StringIterator,'String Iterator');
b.InstallFunctions(StringIterator.prototype,2,[
'next',StringIteratorNext
]);
%AddNamedProperty(StringIterator.prototype,symbolToStringTag,
"String Iterator",1|2);
b.SetFunctionName(StringPrototypeIterator,symbolIterator);
%AddNamedProperty(c.prototype,symbolIterator,
StringPrototypeIterator,2);
})

$templatesÉ
var $getTemplateCallSite;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Map;
var d=b.InternalArray;
var e=new c;
var g=c.prototype.get;
var h=c.prototype.set;
function SameCallSiteElements(i,j){
var k=i.length;
var j=j.raw;
if(k!==j.length)return false;
for(var l=0;l<k;++l){
if(i[l]!==j[l])return false;
}
return true;
}
function GetCachedCallSite(m,n){
var o=%_CallFunction(e,n,g);
if((o===(void 0)))return;
var k=o.length;
for(var l=0;l<k;++l){
if(SameCallSiteElements(m,o[l]))return o[l];
}
}
function SetCachedCallSite(m,n){
var o=%_CallFunction(e,n,g);
var p;
if((o===(void 0))){
p=new d(1);
p[0]=m;
%_CallFunction(e,n,p,h);
}else{
o.push(m);
}
return m;
}
$getTemplateCallSite=function(m,i,n){
var q=GetCachedCallSite(i,n);
if(!(q===(void 0)))return q;
%AddNamedProperty(m,"raw",%ObjectFreeze(i),
1|2|4);
return SetCachedCallSite(%ObjectFreeze(m),n);
}
})

i18n
Ï
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Boolean;
var d=a.Date;
var e=a.Number;
var g=a.RegExp;
var h=a.String;
var i=b.ObjectDefineProperties;
var j=b.ObjectDefineProperty;
var k=b.SetFunctionName;
var l;
var m;
var n;
b.Import(function(o){
l=o.IsFinite;
m=o.IsNaN;
n=o.MathFloor;
});
var p={};
%AddNamedProperty(a,"Intl",p,2);
var q={
'collator':(void 0),
'numberformat':(void 0),
'dateformat':(void 0),
'breakiterator':(void 0)
};
var r=(void 0);
var t=(void 0);
function GetUnicodeExtensionRE(){
if(((void 0)===(void 0))){
t=new g('-u(-[a-z0-9]{2,8})+','g');
}
return t;
}
var u=(void 0);
function GetAnyExtensionRE(){
if((u===(void 0))){
u=new g('-[a-z0-9]{1}-.*','g');
}
return u;
}
var v=(void 0);
function GetQuotedStringRE(){
if((v===(void 0))){
v=new g("'[^']+'",'g');
}
return v;
}
var w=(void 0);
function GetServiceRE(){
if((w===(void 0))){
w=
new g('^(collator|numberformat|dateformat|breakiterator)$');
}
return w;
}
var x=(void 0);
function GetLanguageTagRE(){
if((x===(void 0))){
BuildLanguageTagREs();
}
return x;
}
var y=(void 0);
function GetLanguageVariantRE(){
if((y===(void 0))){
BuildLanguageTagREs();
}
return y;
}
var z=(void 0);
function GetLanguageSingletonRE(){
if((z===(void 0))){
BuildLanguageTagREs();
}
return z;
}
var A=(void 0);
function GetTimezoneNameCheckRE(){
if((A===(void 0))){
A=
new g('^([A-Za-z]+)/([A-Za-z]+)(?:_([A-Za-z]+))*$');
}
return A;
}
function addBoundMethod(B,C,D,E){
%CheckIsBootstrapping();
function getter(){
if(!%IsInitializedIntlObject(this)){
throw MakeTypeError(41,C);
}
var F='__bound'+C+'__';
if((this[F]===(void 0))){
var G=this;
var H;
if((E===(void 0))||E===2){
H=function(I,J){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
return D(G,I,J);
}
}else if(E===1){
H=function(I){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
return D(G,I);
}
}else{
H=function(){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
if(%_ArgumentsLength()>0){
return D(G,%_Arguments(0));
}else{
return D(G);
}
}
}
k(H,F);
%FunctionRemovePrototype(H);
%SetNativeFlag(H);
this[F]=H;
}
return this[F];
}
k(getter,C);
%FunctionRemovePrototype(getter);
%SetNativeFlag(getter);
j(B.prototype,C,{
get:getter,
enumerable:false,
configurable:true
});
}
function supportedLocalesOf(K,L,M){
if((K.match(GetServiceRE())===null)){
throw MakeError(6,K);
}
if((M===(void 0))){
M={};
}else{
M=$toObject(M);
}
var N=M.localeMatcher;
if(!(N===(void 0))){
N=h(N);
if(N!=='lookup'&&N!=='best fit'){
throw MakeRangeError(141,N);
}
}else{
N='best fit';
}
var O=initializeLocaleList(L);
if((q[K]===(void 0))){
q[K]=getAvailableLocalesOf(K);
}
if(N==='best fit'){
return initializeLocaleList(bestFitSupportedLocalesOf(
O,q[K]));
}
return initializeLocaleList(lookupSupportedLocalesOf(
O,q[K]));
}
function lookupSupportedLocalesOf(O,P){
var Q=[];
for(var R=0;R<O.length;++R){
var S=O[R].replace(GetUnicodeExtensionRE(),'');
do{
if(!(P[S]===(void 0))){
Q.push(O[R]);
break;
}
var T=S.lastIndexOf('-');
if(T===-1){
break;
}
S=S.substring(0,T);
}while(true);
}
return Q;
}
function bestFitSupportedLocalesOf(O,P){
return lookupSupportedLocalesOf(O,P);
}
function getGetOption(M,U){
if((M===(void 0)))throw MakeError(3,U);
var V=function getOption(W,X,Y,Z){
if(!(M[W]===(void 0))){
var aa=M[W];
switch(X){
case'boolean':
aa=c(aa);
break;
case'string':
aa=h(aa);
break;
case'number':
aa=e(aa);
break;
default:
throw MakeError(7);
}
if(!(Y===(void 0))&&Y.indexOf(aa)===-1){
throw MakeRangeError(151,aa,U,W);
}
return aa;
}
return Z;
}
return V;
}
function resolveLocale(K,O,M){
O=initializeLocaleList(O);
var V=getGetOption(M,K);
var N=V('localeMatcher','string',
['lookup','best fit'],'best fit');
var ab;
if(N==='lookup'){
ab=lookupMatcher(K,O);
}else{
ab=bestFitMatcher(K,O);
}
return ab;
}
function lookupMatcher(K,O){
if((K.match(GetServiceRE())===null)){
throw MakeError(6,K);
}
if((q[K]===(void 0))){
q[K]=getAvailableLocalesOf(K);
}
for(var R=0;R<O.length;++R){
var S=O[R].replace(GetAnyExtensionRE(),'');
do{
if(!(q[K][S]===(void 0))){
var ac=O[R].match(GetUnicodeExtensionRE());
var ad=(ac===null)?'':ac[0];
return{'locale':S,'extension':ad,'position':R};
}
var T=S.lastIndexOf('-');
if(T===-1){
break;
}
S=S.substring(0,T);
}while(true);
}
if((r===(void 0))){
r=%GetDefaultICULocale();
}
return{'locale':r,'extension':'','position':-1};
}
function bestFitMatcher(K,O){
return lookupMatcher(K,O);
}
function parseExtension(ad){
var ae=ad.split('-');
if(ae.length<=2||
(ae[0]!==''&&ae[1]!=='u')){
return{};
}
var af={};
var ag=(void 0);
for(var R=2;R<ae.length;++R){
var E=ae[R].length;
var ah=ae[R];
if(E===2){
af[ah]=(void 0);
ag=ah;
}else if(E>=3&&E<=8&&!(ag===(void 0))){
af[ag]=ah;
ag=(void 0);
}else{
return{};
}
}
return af;
}
function setOptions(ai,af,aj,V,ak){
var ad='';
var al=function updateExtension(am,aa){
return'-'+am+'-'+h(aa);
}
var an=function updateProperty(W,X,aa){
if(X==='boolean'&&(typeof aa==='string')){
aa=(aa==='true')?true:false;
}
if(!(W===(void 0))){
defineWEProperty(ak,W,aa);
}
}
for(var am in aj){
if(aj.hasOwnProperty(am)){
var aa=(void 0);
var ao=aj[am];
if(!(ao.property===(void 0))){
aa=V(ao.property,ao.type,ao.values);
}
if(!(aa===(void 0))){
an(ao.property,ao.type,aa);
ad+=al(am,aa);
continue;
}
if(af.hasOwnProperty(am)){
aa=af[am];
if(!(aa===(void 0))){
an(ao.property,ao.type,aa);
ad+=al(am,aa);
}else if(ao.type==='boolean'){
an(ao.property,ao.type,true);
ad+=al(am,true);
}
}
}
}
return ad===''?'':'-u'+ad;
}
function freezeArray(ap){
ap.forEach(function(ah,aq){
j(ap,aq,{value:ah,
configurable:false,
writable:false,
enumerable:true});
});
j(ap,'length',{value:ap.length,
writable:false});
return ap;
}
function getOptimalLanguageTag(ar,ab){
if(ar===ab){
return ar;
}
var L=%GetLanguageTagVariants([ar,ab]);
if(L[0].maximized!==L[1].maximized){
return ab;
}
var as=new g('^'+L[1].base);
return ab.replace(as,L[0].base);
}
function getAvailableLocalesOf(K){
var at=%AvailableLocalesOf(K);
for(var R in at){
if(at.hasOwnProperty(R)){
var au=R.match(/^([a-z]{2,3})-([A-Z][a-z]{3})-([A-Z]{2})$/);
if(au!==null){
at[au[1]+'-'+au[3]]=null;
}
}
}
return at;
}
function defineWEProperty(av,W,aa){
j(av,W,
{value:aa,writable:true,enumerable:true});
}
function addWEPropertyIfDefined(av,W,aa){
if(!(aa===(void 0))){
defineWEProperty(av,W,aa);
}
}
function defineWECProperty(av,W,aa){
j(av,W,{value:aa,
writable:true,
enumerable:true,
configurable:true});
}
function addWECPropertyIfDefined(av,W,aa){
if(!(aa===(void 0))){
defineWECProperty(av,W,aa);
}
}
function toTitleCaseWord(aw){
return aw.substr(0,1).toUpperCase()+aw.substr(1).toLowerCase();
}
function canonicalizeLanguageTag(ax){
if(typeof ax!=='string'&&typeof ax!=='object'||
(ax===null)){
throw MakeTypeError(40);
}
var ay=h(ax);
if(isValidLanguageTag(ay)===false){
throw MakeRangeError(133,ay);
}
var az=%CanonicalizeLanguageTag(ay);
if(az==='invalid-tag'){
throw MakeRangeError(133,ay);
}
return az;
}
function initializeLocaleList(L){
var aA=[];
if((L===(void 0))){
aA=[];
}else{
if(typeof L==='string'){
aA.push(canonicalizeLanguageTag(L));
return freezeArray(aA);
}
var aB=$toObject(L);
var aC=aB.length>>>0;
for(var aD=0;aD<aC;aD++){
if(aD in aB){
var aa=aB[aD];
var az=canonicalizeLanguageTag(aa);
if(aA.indexOf(az)===-1){
aA.push(az);
}
}
}
}
return freezeArray(aA);
}
function isValidLanguageTag(S){
if(GetLanguageTagRE().test(S)===false){
return false;
}
if(S.indexOf('x-')===0){
return true;
}
S=S.split(/-x-/)[0];
var aE=[];
var aF=[];
var au=S.split(/-/);
for(var R=1;R<au.length;R++){
var aa=au[R];
if(GetLanguageVariantRE().test(aa)===true&&aF.length===0){
if(aE.indexOf(aa)===-1){
aE.push(aa);
}else{
return false;
}
}
if(GetLanguageSingletonRE().test(aa)===true){
if(aF.indexOf(aa)===-1){
aF.push(aa);
}else{
return false;
}
}
}
return true;
}
function BuildLanguageTagREs(){
var aG='[a-zA-Z]';
var aH='[0-9]';
var aI='('+aG+'|'+aH+')';
var aJ='(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|'+
'zh-min|zh-min-nan|zh-xiang)';
var aK='(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|'+
'i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|'+
'i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)';
var aL='('+aK+'|'+aJ+')';
var aM='(x(-'+aI+'{1,8})+)';
var aN='('+aH+'|[A-WY-Za-wy-z])';
z=new g('^'+aN+'$','i');
var ad='('+aN+'(-'+aI+'{2,8})+)';
var aO='('+aI+'{5,8}|('+aH+aI+'{3}))';
y=new g('^'+aO+'$','i');
var aP='('+aG+'{2}|'+aH+'{3})';
var aQ='('+aG+'{4})';
var aR='('+aG+'{3}(-'+aG+'{3}){0,2})';
var aS='('+aG+'{2,3}(-'+aR+')?|'+aG+'{4}|'+
aG+'{5,8})';
var aT=aS+'(-'+aQ+')?(-'+aP+')?(-'+
aO+')*(-'+ad+')*(-'+aM+')?';
var aU=
'^('+aT+'|'+aM+'|'+aL+')$';
x=new g(aU,'i');
}
function initializeCollator(aV,L,M){
if(%IsInitializedIntlObject(aV)){
throw MakeTypeError(94,"Collator");
}
if((M===(void 0))){
M={};
}
var V=getGetOption(M,'collator');
var aW={};
defineWEProperty(aW,'usage',V(
'usage','string',['sort','search'],'sort'));
var aX=V('sensitivity','string',
['base','accent','case','variant']);
if((aX===(void 0))&&aW.usage==='sort'){
aX='variant';
}
defineWEProperty(aW,'sensitivity',aX);
defineWEProperty(aW,'ignorePunctuation',V(
'ignorePunctuation','boolean',(void 0),false));
var S=resolveLocale('collator',L,M);
var af=parseExtension(S.extension);
var aY={
'kn':{'property':'numeric','type':'boolean'},
'kf':{'property':'caseFirst','type':'string',
'values':['false','lower','upper']}
};
setOptions(
M,af,aY,V,aW);
var aZ='default';
var ad='';
if(af.hasOwnProperty('co')&&aW.usage==='sort'){
var ba=[
'big5han','dict','direct','ducet','gb2312','phonebk','phonetic',
'pinyin','reformed','searchjl','stroke','trad','unihan','zhuyin'
];
if(ba.indexOf(af.co)!==-1){
ad='-u-co-'+af.co;
aZ=af.co;
}
}else if(aW.usage==='search'){
ad='-u-co-search';
}
defineWEProperty(aW,'collation',aZ);
var bb=S.locale+ad;
var ab=i({},{
caseFirst:{writable:true},
collation:{value:aW.collation,writable:true},
ignorePunctuation:{writable:true},
locale:{writable:true},
numeric:{writable:true},
requestedLocale:{value:bb,writable:true},
sensitivity:{writable:true},
strength:{writable:true},
usage:{value:aW.usage,writable:true}
});
var bc=%CreateCollator(bb,
aW,
ab);
%MarkAsInitializedIntlObjectOfType(aV,'collator',bc);
j(aV,'resolved',{value:ab});
return aV;
}
%AddNamedProperty(p,'Collator',function(){
var L=%_Arguments(0);
var M=%_Arguments(1);
if(!this||this===p){
return new p.Collator(L,M);
}
return initializeCollator($toObject(this),L,M);
},
2
);
%AddNamedProperty(p.Collator.prototype,'resolvedOptions',function(){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
if(!%IsInitializedIntlObjectOfType(this,'collator')){
throw MakeTypeError(95,"Collator");
}
var bd=this;
var S=getOptimalLanguageTag(bd.resolved.requestedLocale,
bd.resolved.locale);
return{
locale:S,
usage:bd.resolved.usage,
sensitivity:bd.resolved.sensitivity,
ignorePunctuation:bd.resolved.ignorePunctuation,
numeric:bd.resolved.numeric,
caseFirst:bd.resolved.caseFirst,
collation:bd.resolved.collation
};
},
2
);
k(p.Collator.prototype.resolvedOptions,'resolvedOptions');
%FunctionRemovePrototype(p.Collator.prototype.resolvedOptions);
%SetNativeFlag(p.Collator.prototype.resolvedOptions);
%AddNamedProperty(p.Collator,'supportedLocalesOf',function(L){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
return supportedLocalesOf('collator',L,%_Arguments(1));
},
2
);
k(p.Collator.supportedLocalesOf,'supportedLocalesOf');
%FunctionRemovePrototype(p.Collator.supportedLocalesOf);
%SetNativeFlag(p.Collator.supportedLocalesOf);
function compare(aV,I,J){
return %InternalCompare(%GetImplFromInitializedIntlObject(aV),
h(I),h(J));
};
addBoundMethod(p.Collator,'compare',compare,2);
function isWellFormedCurrencyCode(be){
return typeof be=="string"&&
be.length==3&&
be.match(/[^A-Za-z]/)==null;
}
function getNumberOption(M,W,bf,bg,bh){
var aa=M[W];
if(!(aa===(void 0))){
aa=e(aa);
if(m(aa)||aa<bf||aa>bg){
throw MakeRangeError(144,W);
}
return n(aa);
}
return bh;
}
function initializeNumberFormat(bi,L,M){
if(%IsInitializedIntlObject(bi)){
throw MakeTypeError(94,"NumberFormat");
}
if((M===(void 0))){
M={};
}
var V=getGetOption(M,'numberformat');
var S=resolveLocale('numberformat',L,M);
var aW={};
defineWEProperty(aW,'style',V(
'style','string',['decimal','percent','currency'],'decimal'));
var be=V('currency','string');
if(!(be===(void 0))&&!isWellFormedCurrencyCode(be)){
throw MakeRangeError(129,be);
}
if(aW.style==='currency'&&(be===(void 0))){
throw MakeTypeError(21);
}
var bj=V(
'currencyDisplay','string',['code','symbol','name'],'symbol');
if(aW.style==='currency'){
defineWEProperty(aW,'currency',be.toUpperCase());
defineWEProperty(aW,'currencyDisplay',bj);
}
var bk=getNumberOption(M,'minimumIntegerDigits',1,21,1);
defineWEProperty(aW,'minimumIntegerDigits',bk);
var bl=getNumberOption(M,'minimumFractionDigits',0,20,0);
defineWEProperty(aW,'minimumFractionDigits',bl);
var bm=getNumberOption(M,'maximumFractionDigits',bl,20,3);
defineWEProperty(aW,'maximumFractionDigits',bm);
var bn=M['minimumSignificantDigits'];
var bo=M['maximumSignificantDigits'];
if(!(bn===(void 0))||!(bo===(void 0))){
bn=getNumberOption(M,'minimumSignificantDigits',1,21,0);
defineWEProperty(aW,'minimumSignificantDigits',bn);
bo=getNumberOption(M,'maximumSignificantDigits',bn,21,21);
defineWEProperty(aW,'maximumSignificantDigits',bo);
}
defineWEProperty(aW,'useGrouping',V(
'useGrouping','boolean',(void 0),true));
var af=parseExtension(S.extension);
var bp={
'nu':{'property':(void 0),'type':'string'}
};
var ad=setOptions(M,af,bp,
V,aW);
var bb=S.locale+ad;
var ab=i({},{
currency:{writable:true},
currencyDisplay:{writable:true},
locale:{writable:true},
maximumFractionDigits:{writable:true},
minimumFractionDigits:{writable:true},
minimumIntegerDigits:{writable:true},
numberingSystem:{writable:true},
requestedLocale:{value:bb,writable:true},
style:{value:aW.style,writable:true},
useGrouping:{writable:true}
});
if(aW.hasOwnProperty('minimumSignificantDigits')){
defineWEProperty(ab,'minimumSignificantDigits',(void 0));
}
if(aW.hasOwnProperty('maximumSignificantDigits')){
defineWEProperty(ab,'maximumSignificantDigits',(void 0));
}
var bq=%CreateNumberFormat(bb,
aW,
ab);
if(aW.style==='currency'){
j(ab,'currencyDisplay',{value:bj,
writable:true});
}
%MarkAsInitializedIntlObjectOfType(bi,'numberformat',bq);
j(bi,'resolved',{value:ab});
return bi;
}
%AddNamedProperty(p,'NumberFormat',function(){
var L=%_Arguments(0);
var M=%_Arguments(1);
if(!this||this===p){
return new p.NumberFormat(L,M);
}
return initializeNumberFormat($toObject(this),L,M);
},
2
);
%AddNamedProperty(p.NumberFormat.prototype,'resolvedOptions',function(){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
if(!%IsInitializedIntlObjectOfType(this,'numberformat')){
throw MakeTypeError(95,"NumberFormat");
}
var br=this;
var S=getOptimalLanguageTag(br.resolved.requestedLocale,
br.resolved.locale);
var bs={
locale:S,
numberingSystem:br.resolved.numberingSystem,
style:br.resolved.style,
useGrouping:br.resolved.useGrouping,
minimumIntegerDigits:br.resolved.minimumIntegerDigits,
minimumFractionDigits:br.resolved.minimumFractionDigits,
maximumFractionDigits:br.resolved.maximumFractionDigits,
};
if(bs.style==='currency'){
defineWECProperty(bs,'currency',br.resolved.currency);
defineWECProperty(bs,'currencyDisplay',
br.resolved.currencyDisplay);
}
if(br.resolved.hasOwnProperty('minimumSignificantDigits')){
defineWECProperty(bs,'minimumSignificantDigits',
br.resolved.minimumSignificantDigits);
}
if(br.resolved.hasOwnProperty('maximumSignificantDigits')){
defineWECProperty(bs,'maximumSignificantDigits',
br.resolved.maximumSignificantDigits);
}
return bs;
},
2
);
k(p.NumberFormat.prototype.resolvedOptions,'resolvedOptions');
%FunctionRemovePrototype(p.NumberFormat.prototype.resolvedOptions);
%SetNativeFlag(p.NumberFormat.prototype.resolvedOptions);
%AddNamedProperty(p.NumberFormat,'supportedLocalesOf',function(L){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
return supportedLocalesOf('numberformat',L,%_Arguments(1));
},
2
);
k(p.NumberFormat.supportedLocalesOf,'supportedLocalesOf');
%FunctionRemovePrototype(p.NumberFormat.supportedLocalesOf);
%SetNativeFlag(p.NumberFormat.supportedLocalesOf);
function formatNumber(bq,aa){
var bt=$toNumber(aa)+0;
return %InternalNumberFormat(%GetImplFromInitializedIntlObject(bq),
bt);
}
function parseNumber(bq,aa){
return %InternalNumberParse(%GetImplFromInitializedIntlObject(bq),
h(aa));
}
addBoundMethod(p.NumberFormat,'format',formatNumber,1);
addBoundMethod(p.NumberFormat,'v8Parse',parseNumber,1);
function toLDMLString(M){
var V=getGetOption(M,'dateformat');
var bu='';
var bv=V('weekday','string',['narrow','short','long']);
bu+=appendToLDMLString(
bv,{narrow:'EEEEE',short:'EEE',long:'EEEE'});
bv=V('era','string',['narrow','short','long']);
bu+=appendToLDMLString(
bv,{narrow:'GGGGG',short:'GGG',long:'GGGG'});
bv=V('year','string',['2-digit','numeric']);
bu+=appendToLDMLString(bv,{'2-digit':'yy','numeric':'y'});
bv=V('month','string',
['2-digit','numeric','narrow','short','long']);
bu+=appendToLDMLString(bv,{'2-digit':'MM','numeric':'M',
'narrow':'MMMMM','short':'MMM','long':'MMMM'});
bv=V('day','string',['2-digit','numeric']);
bu+=appendToLDMLString(
bv,{'2-digit':'dd','numeric':'d'});
var bw=V('hour12','boolean');
bv=V('hour','string',['2-digit','numeric']);
if((bw===(void 0))){
bu+=appendToLDMLString(bv,{'2-digit':'jj','numeric':'j'});
}else if(bw===true){
bu+=appendToLDMLString(bv,{'2-digit':'hh','numeric':'h'});
}else{
bu+=appendToLDMLString(bv,{'2-digit':'HH','numeric':'H'});
}
bv=V('minute','string',['2-digit','numeric']);
bu+=appendToLDMLString(bv,{'2-digit':'mm','numeric':'m'});
bv=V('second','string',['2-digit','numeric']);
bu+=appendToLDMLString(bv,{'2-digit':'ss','numeric':'s'});
bv=V('timeZoneName','string',['short','long']);
bu+=appendToLDMLString(bv,{short:'z',long:'zzzz'});
return bu;
}
function appendToLDMLString(bv,bx){
if(!(bv===(void 0))){
return bx[bv];
}else{
return'';
}
}
function fromLDMLString(bu){
bu=bu.replace(GetQuotedStringRE(),'');
var M={};
var by=bu.match(/E{3,5}/g);
M=appendToDateTimeObject(
M,'weekday',by,{EEEEE:'narrow',EEE:'short',EEEE:'long'});
by=bu.match(/G{3,5}/g);
M=appendToDateTimeObject(
M,'era',by,{GGGGG:'narrow',GGG:'short',GGGG:'long'});
by=bu.match(/y{1,2}/g);
M=appendToDateTimeObject(
M,'year',by,{y:'numeric',yy:'2-digit'});
by=bu.match(/M{1,5}/g);
M=appendToDateTimeObject(M,'month',by,{MM:'2-digit',
M:'numeric',MMMMM:'narrow',MMM:'short',MMMM:'long'});
by=bu.match(/L{1,5}/g);
M=appendToDateTimeObject(M,'month',by,{LL:'2-digit',
L:'numeric',LLLLL:'narrow',LLL:'short',LLLL:'long'});
by=bu.match(/d{1,2}/g);
M=appendToDateTimeObject(
M,'day',by,{d:'numeric',dd:'2-digit'});
by=bu.match(/h{1,2}/g);
if(by!==null){
M['hour12']=true;
}
M=appendToDateTimeObject(
M,'hour',by,{h:'numeric',hh:'2-digit'});
by=bu.match(/H{1,2}/g);
if(by!==null){
M['hour12']=false;
}
M=appendToDateTimeObject(
M,'hour',by,{H:'numeric',HH:'2-digit'});
by=bu.match(/m{1,2}/g);
M=appendToDateTimeObject(
M,'minute',by,{m:'numeric',mm:'2-digit'});
by=bu.match(/s{1,2}/g);
M=appendToDateTimeObject(
M,'second',by,{s:'numeric',ss:'2-digit'});
by=bu.match(/z|zzzz/g);
M=appendToDateTimeObject(
M,'timeZoneName',by,{z:'short',zzzz:'long'});
return M;
}
function appendToDateTimeObject(M,bv,by,bx){
if((by===null)){
if(!M.hasOwnProperty(bv)){
defineWEProperty(M,bv,(void 0));
}
return M;
}
var W=by[0];
defineWEProperty(M,bv,bx[W]);
return M;
}
function toDateTimeOptions(M,bz,bA){
if((M===(void 0))){
M={};
}else{
M=((%_IsSpecObject(%IS_VAR(M)))?M:$toObject(M));
}
var bB=true;
if((bz==='date'||bz==='any')&&
(!(M.weekday===(void 0))||!(M.year===(void 0))||
!(M.month===(void 0))||!(M.day===(void 0)))){
bB=false;
}
if((bz==='time'||bz==='any')&&
(!(M.hour===(void 0))||!(M.minute===(void 0))||
!(M.second===(void 0)))){
bB=false;
}
if(bB&&(bA==='date'||bA==='all')){
j(M,'year',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
j(M,'month',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
j(M,'day',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
}
if(bB&&(bA==='time'||bA==='all')){
j(M,'hour',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
j(M,'minute',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
j(M,'second',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
}
return M;
}
function initializeDateTimeFormat(bC,L,M){
if(%IsInitializedIntlObject(bC)){
throw MakeTypeError(94,"DateTimeFormat");
}
if((M===(void 0))){
M={};
}
var S=resolveLocale('dateformat',L,M);
M=toDateTimeOptions(M,'any','date');
var V=getGetOption(M,'dateformat');
var N=V('formatMatcher','string',
['basic','best fit'],'best fit');
var bu=toLDMLString(M);
var bD=canonicalizeTimeZoneID(M.timeZone);
var aW={};
var af=parseExtension(S.extension);
var bE={
'ca':{'property':(void 0),'type':'string'},
'nu':{'property':(void 0),'type':'string'}
};
var ad=setOptions(M,af,bE,
V,aW);
var bb=S.locale+ad;
var ab=i({},{
calendar:{writable:true},
day:{writable:true},
era:{writable:true},
hour12:{writable:true},
hour:{writable:true},
locale:{writable:true},
minute:{writable:true},
month:{writable:true},
numberingSystem:{writable:true},
pattern:{writable:true},
requestedLocale:{value:bb,writable:true},
second:{writable:true},
timeZone:{writable:true},
timeZoneName:{writable:true},
tz:{value:bD,writable:true},
weekday:{writable:true},
year:{writable:true}
});
var bq=%CreateDateTimeFormat(
bb,{skeleton:bu,timeZone:bD},ab);
if(!(bD===(void 0))&&bD!==ab.timeZone){
throw MakeRangeError(150,bD);
}
%MarkAsInitializedIntlObjectOfType(bC,'dateformat',bq);
j(bC,'resolved',{value:ab});
return bC;
}
%AddNamedProperty(p,'DateTimeFormat',function(){
var L=%_Arguments(0);
var M=%_Arguments(1);
if(!this||this===p){
return new p.DateTimeFormat(L,M);
}
return initializeDateTimeFormat($toObject(this),L,M);
},
2
);
%AddNamedProperty(p.DateTimeFormat.prototype,'resolvedOptions',function(){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
if(!%IsInitializedIntlObjectOfType(this,'dateformat')){
throw MakeTypeError(95,"DateTimeFormat");
}
var bF={
'gregorian':'gregory',
'japanese':'japanese',
'buddhist':'buddhist',
'roc':'roc',
'persian':'persian',
'islamic-civil':'islamicc',
'islamic':'islamic',
'hebrew':'hebrew',
'chinese':'chinese',
'indian':'indian',
'coptic':'coptic',
'ethiopic':'ethiopic',
'ethiopic-amete-alem':'ethioaa'
};
var br=this;
var bG=fromLDMLString(br.resolved.pattern);
var bH=bF[br.resolved.calendar];
if((bH===(void 0))){
bH=br.resolved.calendar;
}
var S=getOptimalLanguageTag(br.resolved.requestedLocale,
br.resolved.locale);
var bs={
locale:S,
numberingSystem:br.resolved.numberingSystem,
calendar:bH,
timeZone:br.resolved.timeZone
};
addWECPropertyIfDefined(bs,'timeZoneName',bG.timeZoneName);
addWECPropertyIfDefined(bs,'era',bG.era);
addWECPropertyIfDefined(bs,'year',bG.year);
addWECPropertyIfDefined(bs,'month',bG.month);
addWECPropertyIfDefined(bs,'day',bG.day);
addWECPropertyIfDefined(bs,'weekday',bG.weekday);
addWECPropertyIfDefined(bs,'hour12',bG.hour12);
addWECPropertyIfDefined(bs,'hour',bG.hour);
addWECPropertyIfDefined(bs,'minute',bG.minute);
addWECPropertyIfDefined(bs,'second',bG.second);
return bs;
},
2
);
k(p.DateTimeFormat.prototype.resolvedOptions,
'resolvedOptions');
%FunctionRemovePrototype(p.DateTimeFormat.prototype.resolvedOptions);
%SetNativeFlag(p.DateTimeFormat.prototype.resolvedOptions);
%AddNamedProperty(p.DateTimeFormat,'supportedLocalesOf',function(L){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
return supportedLocalesOf('dateformat',L,%_Arguments(1));
},
2
);
k(p.DateTimeFormat.supportedLocalesOf,'supportedLocalesOf');
%FunctionRemovePrototype(p.DateTimeFormat.supportedLocalesOf);
%SetNativeFlag(p.DateTimeFormat.supportedLocalesOf);
function formatDate(bq,bI){
var bJ;
if((bI===(void 0))){
bJ=d.now();
}else{
bJ=$toNumber(bI);
}
if(!l(bJ))throw MakeRangeError(123);
return %InternalDateFormat(%GetImplFromInitializedIntlObject(bq),
new d(bJ));
}
function parseDate(bq,aa){
return %InternalDateParse(%GetImplFromInitializedIntlObject(bq),
h(aa));
}
addBoundMethod(p.DateTimeFormat,'format',formatDate,0);
addBoundMethod(p.DateTimeFormat,'v8Parse',parseDate,1);
function canonicalizeTimeZoneID(bK){
if((bK===(void 0))){
return bK;
}
var bL=bK.toUpperCase();
if(bL==='UTC'||bL==='GMT'||
bL==='ETC/UTC'||bL==='ETC/GMT'){
return'UTC';
}
var by=GetTimezoneNameCheckRE().exec(bK);
if((by===null))throw MakeRangeError(124,bK);
var bs=toTitleCaseWord(by[1])+'/'+toTitleCaseWord(by[2]);
var R=3;
while(!(by[R]===(void 0))&&R<by.length){
bs=bs+'_'+toTitleCaseWord(by[R]);
R++;
}
return bs;
}
function initializeBreakIterator(bM,L,M){
if(%IsInitializedIntlObject(bM)){
throw MakeTypeError(94,"v8BreakIterator");
}
if((M===(void 0))){
M={};
}
var V=getGetOption(M,'breakiterator');
var aW={};
defineWEProperty(aW,'type',V(
'type','string',['character','word','sentence','line'],'word'));
var S=resolveLocale('breakiterator',L,M);
var ab=i({},{
requestedLocale:{value:S.locale,writable:true},
type:{value:aW.type,writable:true},
locale:{writable:true}
});
var bN=%CreateBreakIterator(S.locale,
aW,
ab);
%MarkAsInitializedIntlObjectOfType(bM,'breakiterator',
bN);
j(bM,'resolved',{value:ab});
return bM;
}
%AddNamedProperty(p,'v8BreakIterator',function(){
var L=%_Arguments(0);
var M=%_Arguments(1);
if(!this||this===p){
return new p.v8BreakIterator(L,M);
}
return initializeBreakIterator($toObject(this),L,M);
},
2
);
%AddNamedProperty(p.v8BreakIterator.prototype,'resolvedOptions',
function(){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
if(!%IsInitializedIntlObjectOfType(this,'breakiterator')){
throw MakeTypeError(95,"v8BreakIterator");
}
var bO=this;
var S=getOptimalLanguageTag(bO.resolved.requestedLocale,
bO.resolved.locale);
return{
locale:S,
type:bO.resolved.type
};
},
2
);
k(p.v8BreakIterator.prototype.resolvedOptions,
'resolvedOptions');
%FunctionRemovePrototype(p.v8BreakIterator.prototype.resolvedOptions);
%SetNativeFlag(p.v8BreakIterator.prototype.resolvedOptions);
%AddNamedProperty(p.v8BreakIterator,'supportedLocalesOf',
function(L){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
return supportedLocalesOf('breakiterator',L,%_Arguments(1));
},
2
);
k(p.v8BreakIterator.supportedLocalesOf,'supportedLocalesOf');
%FunctionRemovePrototype(p.v8BreakIterator.supportedLocalesOf);
%SetNativeFlag(p.v8BreakIterator.supportedLocalesOf);
function adoptText(bM,bP){
%BreakIteratorAdoptText(%GetImplFromInitializedIntlObject(bM),
h(bP));
}
function first(bM){
return %BreakIteratorFirst(%GetImplFromInitializedIntlObject(bM));
}
function next(bM){
return %BreakIteratorNext(%GetImplFromInitializedIntlObject(bM));
}
function current(bM){
return %BreakIteratorCurrent(%GetImplFromInitializedIntlObject(bM));
}
function breakType(bM){
return %BreakIteratorBreakType(%GetImplFromInitializedIntlObject(bM));
}
addBoundMethod(p.v8BreakIterator,'adoptText',adoptText,1);
addBoundMethod(p.v8BreakIterator,'first',first,0);
addBoundMethod(p.v8BreakIterator,'next',next,0);
addBoundMethod(p.v8BreakIterator,'current',current,0);
addBoundMethod(p.v8BreakIterator,'breakType',breakType,0);
var bQ={
'collator':p.Collator,
'numberformat':p.NumberFormat,
'dateformatall':p.DateTimeFormat,
'dateformatdate':p.DateTimeFormat,
'dateformattime':p.DateTimeFormat
};
var bR={
'collator':(void 0),
'numberformat':(void 0),
'dateformatall':(void 0),
'dateformatdate':(void 0),
'dateformattime':(void 0),
};
function cachedOrNewService(K,L,M,bA){
var bS=((bA===(void 0)))?M:bA;
if((L===(void 0))&&(M===(void 0))){
if((bR[K]===(void 0))){
bR[K]=new bQ[K](L,bS);
}
return bR[K];
}
return new bQ[K](L,bS);
}
function OverrideFunction(av,bT,bU){
%CheckIsBootstrapping();
j(av,bT,{value:bU,
writeable:true,
configurable:true,
enumerable:false});
k(bU,bT);
%FunctionRemovePrototype(bU);
%SetNativeFlag(bU);
}
OverrideFunction(h.prototype,'localeCompare',function(G){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
if((this==null)){
throw MakeTypeError(42);
}
var L=%_Arguments(1);
var M=%_Arguments(2);
var aV=cachedOrNewService('collator',L,M);
return compare(aV,this,G);
}
);
OverrideFunction(h.prototype,'normalize',function(G){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"String.prototype.normalize");
var bV=h(%_Arguments(0)||'NFC');
var bW=['NFC','NFD','NFKC','NFKD'];
var bX=bW.indexOf(bV);
if(bX===-1){
throw MakeRangeError(142,bW.join(', '));
}
return %StringNormalize(this,bX);
}
);
OverrideFunction(e.prototype,'toLocaleString',function(){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
if(!(this instanceof e)&&typeof(this)!=='number'){
throw MakeTypeError(43,"Number");
}
var L=%_Arguments(0);
var M=%_Arguments(1);
var bi=cachedOrNewService('numberformat',L,M);
return formatNumber(bi,this);
}
);
function toLocaleDateTime(bY,L,M,bz,bA,K){
if(!(bY instanceof d)){
throw MakeTypeError(43,"Date");
}
if(m(bY))return'Invalid Date';
var aW=toDateTimeOptions(M,bz,bA);
var bC=
cachedOrNewService(K,L,M,aW);
return formatDate(bC,bY);
}
OverrideFunction(d.prototype,'toLocaleString',function(){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
var L=%_Arguments(0);
var M=%_Arguments(1);
return toLocaleDateTime(
this,L,M,'any','all','dateformatall');
}
);
OverrideFunction(d.prototype,'toLocaleDateString',function(){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
var L=%_Arguments(0);
var M=%_Arguments(1);
return toLocaleDateTime(
this,L,M,'date','date','dateformatdate');
}
);
OverrideFunction(d.prototype,'toLocaleTimeString',function(){
if(%_IsConstructCall()){
throw MakeTypeError(74);
}
var L=%_Arguments(0);
var M=%_Arguments(1);
return toLocaleDateTime(
this,L,M,'time','time','dateformattime');
}
);
})

 0proxy)6
var $proxyDerivedGetTrap;
var $proxyDerivedHasTrap;
var $proxyDerivedSetTrap;
var $proxyEnumerate;
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Function;
var d=a.Object;
var e;
b.Import(function(f){
e=f.ToNameArray;
});
function ProxyCreate(g,h){
if(!(%_IsSpecObject(g)))
throw MakeTypeError(81,"create")
if((h===(void 0)))
h=null
else if(!((%_IsSpecObject(h))||(h===null)))
throw MakeTypeError(86)
return %CreateJSProxy(g,h)
}
function ProxyCreateFunction(g,i,j){
if(!(%_IsSpecObject(g)))
throw MakeTypeError(81,"createFunction")
if(!(%_ClassOf(i)==='Function'))
throw MakeTypeError(89,"call")
if((j===(void 0))){
j=DerivedConstructTrap(i)
}else if((%_ClassOf(j)==='Function')){
var k=j
j=function(){
return %Apply(k,(void 0),arguments,0,%_ArgumentsLength());
}
}else{
throw MakeTypeError(89,"construct")
}
return %CreateJSFunctionProxy(
g,i,j,c.prototype)
}
function DerivedConstructTrap(i){
return function(){
var h=this.prototype
if(!(%_IsSpecObject(h)))h=d.prototype
var l={__proto__:h};
var m=%Apply(i,l,arguments,0,%_ArgumentsLength());
return(%_IsSpecObject(m))?m:l
}
}
function DelegateCallAndConstruct(i,j){
return function(){
return %Apply(%_IsConstructCall()?j:i,
this,arguments,0,%_ArgumentsLength())
}
}
function DerivedGetTrap(n,o){
var p=this.getPropertyDescriptor(o)
if((p===(void 0))){return p}
if('value'in p){
return p.value
}else{
if((p.get===(void 0))){return p.get}
return %_CallFunction(n,p.get)
}
}
function DerivedSetTrap(n,o,q){
var p=this.getOwnPropertyDescriptor(o)
if(p){
if('writable'in p){
if(p.writable){
p.value=q
this.defineProperty(o,p)
return true
}else{
return false
}
}else{
if(p.set){
%_CallFunction(n,q,p.set)
return true
}else{
return false
}
}
}
p=this.getPropertyDescriptor(o)
if(p){
if('writable'in p){
if(p.writable){
}else{
return false
}
}else{
if(p.set){
%_CallFunction(n,q,p.set)
return true
}else{
return false
}
}
}
this.defineProperty(o,{
value:q,
writable:true,
enumerable:true,
configurable:true});
return true;
}
function DerivedHasTrap(o){
return!!this.getPropertyDescriptor(o)
}
function DerivedHasOwnTrap(o){
return!!this.getOwnPropertyDescriptor(o)
}
function DerivedKeysTrap(){
var r=this.getOwnPropertyNames()
var s=[]
for(var t=0,count=0;t<r.length;++t){
var o=r[t]
if((typeof(o)==='symbol'))continue
var p=this.getOwnPropertyDescriptor(((typeof(%IS_VAR(o))==='string')?o:$nonStringToString(o)))
if(!(p===(void 0))&&p.enumerable){
s[count++]=r[t]
}
}
return s
}
function DerivedEnumerateTrap(){
var r=this.getPropertyNames()
var s=[]
for(var t=0,count=0;t<r.length;++t){
var o=r[t]
if((typeof(o)==='symbol'))continue
var p=this.getPropertyDescriptor(((typeof(%IS_VAR(o))==='string')?o:$nonStringToString(o)))
if(!(p===(void 0))){
if(!p.configurable){
throw MakeTypeError(87,
this,o,"getPropertyDescriptor")
}
if(p.enumerable)s[count++]=r[t]
}
}
return s
}
function ProxyEnumerate(u){
var g=%GetHandler(u)
if((g.enumerate===(void 0))){
return %Apply(DerivedEnumerateTrap,g,[],0,0)
}else{
return e(g.enumerate(),"enumerate",false)
}
}
var v=new d();
%AddNamedProperty(a,"Proxy",v,2);
b.InstallFunctions(v,2,[
"create",ProxyCreate,
"createFunction",ProxyCreateFunction
])
$proxyDerivedGetTrap=DerivedGetTrap;
$proxyDerivedHasTrap=DerivedHasTrap;
$proxyDerivedSetTrap=DerivedSetTrap;
$proxyEnumerate=ProxyEnumerate;
b.Export(function(w){
w.ProxyDelegateCallAndConstruct=DelegateCallAndConstruct;
w.ProxyDerivedHasOwnTrap=DerivedHasOwnTrap;
w.ProxyDerivedKeysTrap=DerivedKeysTrap;
});
})

$generatorá
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Function;
var d;
b.Import(function(e){
d=e.NewFunctionString;
});
function GeneratorObjectNext(f){
if(!(%_ClassOf(this)==='Generator')){
throw MakeTypeError(33,
'[Generator].prototype.next',this);
}
var g=%GeneratorGetContinuation(this);
if(g>0){
if((%_DebugIsActive()!=0))%DebugPrepareStepInIfStepping(this);
try{
return %_GeneratorNext(this,f);
}catch(e){
%GeneratorClose(this);
throw e;
}
}else if(g==0){
return{value:void 0,done:true};
}else{
throw MakeTypeError(31);
}
}
function GeneratorObjectThrow(h){
if(!(%_ClassOf(this)==='Generator')){
throw MakeTypeError(33,
'[Generator].prototype.throw',this);
}
var g=%GeneratorGetContinuation(this);
if(g>0){
try{
return %_GeneratorThrow(this,h);
}catch(e){
%GeneratorClose(this);
throw e;
}
}else if(g==0){
throw h;
}else{
throw MakeTypeError(31);
}
}
function GeneratorFunctionConstructor(i){
var j=d(arguments,'function*');
var k=%GlobalProxy(GeneratorFunctionConstructor);
var l=%_CallFunction(k,%CompileString(j,true));
%FunctionMarkNameShouldPrintAsAnonymous(l);
return l;
}
%NeverOptimizeFunction(GeneratorObjectNext);
%NeverOptimizeFunction(GeneratorObjectThrow);
var m=GeneratorFunctionPrototype.prototype;
b.InstallFunctions(m,
2,
["next",GeneratorObjectNext,
"throw",GeneratorObjectThrow]);
%AddNamedProperty(m,"constructor",
GeneratorFunctionPrototype,2|1);
%AddNamedProperty(m,
symbolToStringTag,"Generator",2|1);
%InternalSetPrototype(GeneratorFunctionPrototype,c.prototype);
%AddNamedProperty(GeneratorFunctionPrototype,
symbolToStringTag,"GeneratorFunction",2|1);
%AddNamedProperty(GeneratorFunctionPrototype,"constructor",
GeneratorFunction,2|1);
%InternalSetPrototype(GeneratorFunction,c);
%SetCode(GeneratorFunction,GeneratorFunctionConstructor);
})

<harmony-atomics%#
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Object;
function CheckSharedTypedArray(d){
if(!%_IsSharedTypedArray(d)){
throw MakeTypeError(58,d);
}
}
function CheckSharedIntegerTypedArray(e){
if(!%_IsSharedIntegerTypedArray(e)){
throw MakeTypeError(59,e);
}
}
function AtomicsCompareExchangeJS(d,f,g,h){
CheckSharedTypedArray(d);
f=$toInteger(f);
if(f<0||f>=d.length){
return(void 0);
}
return %_AtomicsCompareExchange(d,f,g,h);
}
function AtomicsLoadJS(d,f){
CheckSharedTypedArray(d);
f=$toInteger(f);
if(f<0||f>=d.length){
return(void 0);
}
return %_AtomicsLoad(d,f);
}
function AtomicsStoreJS(d,f,i){
CheckSharedTypedArray(d);
f=$toInteger(f);
if(f<0||f>=d.length){
return(void 0);
}
return %_AtomicsStore(d,f,i);
}
function AtomicsAddJS(e,f,i){
CheckSharedIntegerTypedArray(e);
f=$toInteger(f);
if(f<0||f>=e.length){
return(void 0);
}
return %_AtomicsAdd(e,f,i);
}
function AtomicsSubJS(e,f,i){
CheckSharedIntegerTypedArray(e);
f=$toInteger(f);
if(f<0||f>=e.length){
return(void 0);
}
return %_AtomicsSub(e,f,i);
}
function AtomicsAndJS(e,f,i){
CheckSharedIntegerTypedArray(e);
f=$toInteger(f);
if(f<0||f>=e.length){
return(void 0);
}
return %_AtomicsAnd(e,f,i);
}
function AtomicsOrJS(e,f,i){
CheckSharedIntegerTypedArray(e);
f=$toInteger(f);
if(f<0||f>=e.length){
return(void 0);
}
return %_AtomicsOr(e,f,i);
}
function AtomicsXorJS(e,f,i){
CheckSharedIntegerTypedArray(e);
f=$toInteger(f);
if(f<0||f>=e.length){
return(void 0);
}
return %_AtomicsXor(e,f,i);
}
function AtomicsExchangeJS(e,f,i){
CheckSharedIntegerTypedArray(e);
f=$toInteger(f);
if(f<0||f>=e.length){
return(void 0);
}
return %_AtomicsExchange(e,f,i);
}
function AtomicsIsLockFreeJS(j){
return %_AtomicsIsLockFree(j);
}
function AtomicsConstructor(){}
var k=new AtomicsConstructor();
%InternalSetPrototype(k,c.prototype);
%AddNamedProperty(a,"Atomics",k,2);
%FunctionSetInstanceClassName(AtomicsConstructor,'Atomics');
%AddNamedProperty(k,symbolToStringTag,"Atomics",1|2);
b.InstallFunctions(k,2,[
"compareExchange",AtomicsCompareExchangeJS,
"load",AtomicsLoadJS,
"store",AtomicsStoreJS,
"add",AtomicsAddJS,
"sub",AtomicsSubJS,
"and",AtomicsAndJS,
"or",AtomicsOrJS,
"xor",AtomicsXorJS,
"exchange",AtomicsExchangeJS,
"isLockFree",AtomicsIsLockFreeJS,
]);
})

4harmony-arrayIE
(function(a,b){
'use strict';
%CheckIsBootstrapping();
var c=a.Array;
var d=a.Symbol;
var e;
var f;
var g;
var h;
var i;
b.Import(function(j){
e=j.GetIterator;
f=j.GetMethod;
g=j.MathMax;
h=j.MathMin;
i=j.ObjectIsFrozen;
});
function InnerArrayCopyWithin(k,l,m,n,o){
k=(%_IsSmi(%IS_VAR(k))?k:%NumberToInteger($toNumber(k)));
var p;
if(k<0){
p=g(o+k,0);
}else{
p=h(k,o);
}
l=(%_IsSmi(%IS_VAR(l))?l:%NumberToInteger($toNumber(l)));
var j;
if(l<0){
j=g(o+l,0);
}else{
j=h(l,o);
}
m=(m===(void 0))?o:(%_IsSmi(%IS_VAR(m))?m:%NumberToInteger($toNumber(m)));
var q;
if(m<0){
q=g(o+m,0);
}else{
q=h(m,o);
}
var r=h(q-j,o-p);
var s=1;
if(j<p&&p<(j+r)){
s=-1;
j=j+r-1;
p=p+r-1;
}
while(r>0){
if(j in n){
n[p]=n[j];
}else{
delete n[p];
}
j=j+s;
p=p+s;
r--;
}
return n;
}
function ArrayCopyWithin(k,l,m){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.copyWithin");
var n=((%_IsSpecObject(%IS_VAR(this)))?this:$toObject(this));
var o=$toLength(n.length);
return InnerArrayCopyWithin(k,l,m,n,o);
}
function InnerArrayFind(t,u,n,o){
if(!(%_ClassOf(t)==='Function')){
throw MakeTypeError(12,t);
}
var v=false;
if((u===null)){
if(%IsSloppyModeFunction(t))u=(void 0);
}else if(!(u===(void 0))){
v=(!(%_IsSpecObject(u))&&%IsSloppyModeFunction(t));
}
for(var w=0;w<o;w++){
if(w in n){
var x=n[w];
var y=v?$toObject(u):u;
if(%_CallFunction(y,x,w,n,t)){
return x;
}
}
}
return;
}
function ArrayFind(t,u){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.find");
var n=$toObject(this);
var o=$toInteger(n.length);
return InnerArrayFind(t,u,n,o);
}
function InnerArrayFindIndex(t,u,n,o){
if(!(%_ClassOf(t)==='Function')){
throw MakeTypeError(12,t);
}
var v=false;
if((u===null)){
if(%IsSloppyModeFunction(t))u=(void 0);
}else if(!(u===(void 0))){
v=(!(%_IsSpecObject(u))&&%IsSloppyModeFunction(t));
}
for(var w=0;w<o;w++){
if(w in n){
var x=n[w];
var y=v?$toObject(u):u;
if(%_CallFunction(y,x,w,n,t)){
return w;
}
}
}
return-1;
}
function ArrayFindIndex(t,u){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.findIndex");
var n=$toObject(this);
var o=$toInteger(n.length);
return InnerArrayFindIndex(t,u,n,o);
}
function InnerArrayFill(z,l,m,n,o){
var w=(l===(void 0))?0:(%_IsSmi(%IS_VAR(l))?l:%NumberToInteger($toNumber(l)));
var m=(m===(void 0))?o:(%_IsSmi(%IS_VAR(m))?m:%NumberToInteger($toNumber(m)));
if(w<0){
w+=o;
if(w<0)w=0;
}else{
if(w>o)w=o;
}
if(m<0){
m+=o;
if(m<0)m=0;
}else{
if(m>o)m=o;
}
if((m-w)>0&&i(n)){
throw MakeTypeError(9);
}
for(;w<m;w++)
n[w]=z;
return n;
}
function ArrayFill(z,l,m){
if((this==null)&&!(%_IsUndetectableObject(this)))throw MakeTypeError(14,"Array.prototype.fill");
var n=$toObject(this);
var o=(n.length>>>0);
return InnerArrayFill(z,l,m,n,o);
}
function ArrayFrom(A,B,C){
var D=$toObject(A);
var E=!(B===(void 0));
if(E){
if(!(%_ClassOf(B)==='Function')){
throw MakeTypeError(12,B);
}else if(%IsSloppyModeFunction(B)){
if((C===null)){
C=(void 0);
}else if(!(C===(void 0))){
C=((%_IsSpecObject(%IS_VAR(C)))?C:$toObject(C));
}
}
}
var F=f(D,symbolIterator);
var G;
var H;
var I;
var J;
if(!(F===(void 0))){
H=%IsConstructor(this)?new this():[];
var K=e(D,F);
G=0;
while(true){
var L=K.next();
if(!(%_IsObject(L))){
throw MakeTypeError(38,L);
}
if(L.done){
H.length=G;
return H;
}
J=L.value;
if(E){
I=%_CallFunction(C,J,G,B);
}else{
I=J;
}
%AddElement(H,G++,I,0);
}
}else{
var M=$toLength(D.length);
H=%IsConstructor(this)?new this(M):new c(M);
for(G=0;G<M;++G){
J=D[G];
if(E){
I=%_CallFunction(C,J,G,B);
}else{
I=J;
}
%AddElement(H,G,I,0);
}
H.length=G;
return H;
}
}
function ArrayOf(){
var o=%_ArgumentsLength();
var N=this;
var n=%IsConstructor(N)?new N(o):[];
for(var w=0;w<o;w++){
%AddElement(n,w,%_Arguments(w),0);
}
n.length=o;
return n;
}
b.InstallConstants(d,[
"isConcatSpreadable",symbolIsConcatSpreadable
]);
%FunctionSetLength(ArrayCopyWithin,2);
%FunctionSetLength(ArrayFrom,1);
%FunctionSetLength(ArrayFill,1);
%FunctionSetLength(ArrayFind,1);
%FunctionSetLength(ArrayFindIndex,1);
b.InstallFunctions(c,2,[
"from",ArrayFrom,
"of",ArrayOf
]);
b.InstallFunctions(c.prototype,2,[
"copyWithin",ArrayCopyWithin,
"find",ArrayFind,
"findIndex",ArrayFindIndex,
"fill",ArrayFill
]);
b.Export(function(p){
p.ArrayFrom=ArrayFrom;
p.InnerArrayCopyWithin=InnerArrayCopyWithin;
p.InnerArrayFill=InnerArrayFill;
p.InnerArrayFind=InnerArrayFind;
p.InnerArrayFindIndex=InnerArrayFindIndex;
});
})

Xharmony-array-includesñ
(function(a,b){
'use strict';
%CheckIsBootstrapping();
var c=a.Array;
function ArrayIncludes(d,e){
var f=$toObject(this);
var g=$toLength(f.length);
if(g===0){
return false;
}
var h=$toInteger(e);
var i;
if(h>=0){
i=h;
}else{
i=g+h;
if(i<0){
i=0;
}
}
while(i<g){
var j=f[i];
if($sameValueZero(d,j)){
return true;
}
++i;
}
return false;
}
%FunctionSetLength(ArrayIncludes,1);
b.InstallFunctions(c.prototype,2,[
"includes",ArrayIncludes
]);
})

@harmony-tostring
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Symbol;
b.InstallConstants(c,[
"toStringTag",symbolToStringTag
]);
})

Hharmony-typedarrayQ¥
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Uint8Array;

var d=a.Int8Array;

var e=a.Uint16Array;

var f=a.Int16Array;

var g=a.Uint32Array;

var h=a.Int32Array;

var i=a.Float32Array;

var j=a.Float64Array;

var k=a.Uint8ClampedArray;


var l=a.Array;

var m;
var n;
var o;
var p;
var q;
var r;
var s;
var t;
var u;
var v;
var w;
var x;
var y;
var z;
var A;
var B;
var C;
var D;
b.Import(function(E){
m=E.ArrayFrom;
n=E.ArrayToString;
o=E.InnerArrayCopyWithin;
p=E.InnerArrayEvery;
q=E.InnerArrayFill;
r=E.InnerArrayFilter;
s=E.InnerArrayFind;
t=E.InnerArrayFindIndex;
u=E.InnerArrayForEach;
v=E.InnerArrayIndexOf;
w=E.InnerArrayJoin;
x=E.InnerArrayLastIndexOf;
y=E.InnerArrayMap;
InnerArrayReduce=E.InnerArrayReduce;
InnerArrayReduceRight=E.InnerArrayReduceRight;
z=E.InnerArrayReverse;
A=E.InnerArraySome;
B=E.InnerArraySort;
C=E.InnerArrayToLocaleString;
D=E.IsNaN;
});
function ConstructTypedArray(F,G){
if(!%IsConstructor(F)||(F.prototype===(void 0))||
!%HasOwnProperty(F.prototype,"BYTES_PER_ELEMENT")){
throw MakeTypeError(57);
}
return new F(G);
}
function ConstructTypedArrayLike(H,I){
return ConstructTypedArray(H.constructor,I);
}
function TypedArrayCopyWithin(J,K,L){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return o(J,K,L,this,M);
}
%FunctionSetLength(TypedArrayCopyWithin,2);
function TypedArrayEvery(N,O){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return p(N,O,this,M);
}
%FunctionSetLength(TypedArrayEvery,1);
function TypedArrayForEach(N,O){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
u(N,O,this,M);
}
%FunctionSetLength(TypedArrayForEach,1);
function TypedArrayFill(P,K,L){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return q(P,K,L,this,M);
}
%FunctionSetLength(TypedArrayFill,1);
function TypedArrayFilter(Q,R){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
var G=r(Q,R,this,M);
return ConstructTypedArrayLike(this,G);
}
%FunctionSetLength(TypedArrayFilter,1);
function TypedArrayFind(Q,R){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return s(Q,R,this,M);
}
%FunctionSetLength(TypedArrayFind,1);
function TypedArrayFindIndex(Q,R){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return t(Q,R,this,M);
}
%FunctionSetLength(TypedArrayFindIndex,1);
function TypedArrayReverse(){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return z(this,M);
}
function TypedArrayComparefn(S,T){
if(D(S)&&D(T)){
return D(T)?0:1;
}
if(D(S)){
return 1;
}
if(S===0&&S===T){
if(%_IsMinusZero(S)){
if(!%_IsMinusZero(T)){
return-1;
}
}else if(%_IsMinusZero(T)){
return 1;
}
}
return S-T;
}
function TypedArraySort(U){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
if((U===(void 0))){
U=TypedArrayComparefn;
}
return %_CallFunction(this,M,U,B);
}
function TypedArrayIndexOf(V,W){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return %_CallFunction(this,V,W,M,v);
}
%FunctionSetLength(TypedArrayIndexOf,1);
function TypedArrayLastIndexOf(V,W){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return %_CallFunction(this,V,W,M,
%_ArgumentsLength(),x);
}
%FunctionSetLength(TypedArrayLastIndexOf,1);
function TypedArrayMap(Q,R){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
var G=y(Q,R,this,M);
return ConstructTypedArrayLike(this,G);
}
%FunctionSetLength(TypedArrayMap,1);
function TypedArraySome(N,O){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return A(N,O,this,M);
}
%FunctionSetLength(TypedArraySome,1);
function TypedArrayToLocaleString(){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return C(this,M);
}
function TypedArrayToString(){
return %_CallFunction(this,n);
}
function TypedArrayJoin(X){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return w(X,this,M);
}
function TypedArrayReduce(Y,Z){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return InnerArrayReduce(Y,Z,this,M,
%_ArgumentsLength());
}
%FunctionSetLength(TypedArrayReduce,1);
function TypedArrayReduceRight(Y,Z){
if(!%IsTypedArray(this))throw MakeTypeError(57);
var M=%_TypedArrayGetLength(this);
return InnerArrayReduceRight(Y,Z,this,M,
%_ArgumentsLength());
}
%FunctionSetLength(TypedArrayReduceRight,1);
function TypedArrayOf(){
var M=%_ArgumentsLength();
var G=new this(M);
for(var aa=0;aa<M;aa++){
G[aa]=%_Arguments(aa);
}
return G;
}
function TypedArrayFrom(ab,ac,R){
var G=%_CallFunction(l,ab,ac,R,m);
return ConstructTypedArray(this,G);
}
%FunctionSetLength(TypedArrayFrom,1);
b.InstallFunctions(c,2|4|1,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallFunctions(c.prototype,2,[
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"some",TypedArraySome,
"sort",TypedArraySort,
"toString",TypedArrayToString,
"toLocaleString",TypedArrayToLocaleString
]);

b.InstallFunctions(d,2|4|1,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallFunctions(d.prototype,2,[
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"some",TypedArraySome,
"sort",TypedArraySort,
"toString",TypedArrayToString,
"toLocaleString",TypedArrayToLocaleString
]);

b.InstallFunctions(e,2|4|1,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallFunctions(e.prototype,2,[
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"some",TypedArraySome,
"sort",TypedArraySort,
"toString",TypedArrayToString,
"toLocaleString",TypedArrayToLocaleString
]);

b.InstallFunctions(f,2|4|1,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallFunctions(f.prototype,2,[
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"some",TypedArraySome,
"sort",TypedArraySort,
"toString",TypedArrayToString,
"toLocaleString",TypedArrayToLocaleString
]);

b.InstallFunctions(g,2|4|1,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallFunctions(g.prototype,2,[
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"some",TypedArraySome,
"sort",TypedArraySort,
"toString",TypedArrayToString,
"toLocaleString",TypedArrayToLocaleString
]);

b.InstallFunctions(h,2|4|1,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallFunctions(h.prototype,2,[
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"some",TypedArraySome,
"sort",TypedArraySort,
"toString",TypedArrayToString,
"toLocaleString",TypedArrayToLocaleString
]);

b.InstallFunctions(i,2|4|1,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallFunctions(i.prototype,2,[
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"some",TypedArraySome,
"sort",TypedArraySort,
"toString",TypedArrayToString,
"toLocaleString",TypedArrayToLocaleString
]);

b.InstallFunctions(j,2|4|1,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallFunctions(j.prototype,2,[
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"some",TypedArraySome,
"sort",TypedArraySort,
"toString",TypedArrayToString,
"toLocaleString",TypedArrayToLocaleString
]);

b.InstallFunctions(k,2|4|1,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallFunctions(k.prototype,2,[
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"some",TypedArraySome,
"sort",TypedArraySort,
"toString",TypedArrayToString,
"toLocaleString",TypedArrayToLocaleString
]);


})

8harmony-regexp¹
(function(a,b){
'use strict';
%CheckIsBootstrapping();
var c=a.RegExp;
function RegExpGetFlags(){
if(!(%_IsSpecObject(this))){
throw MakeTypeError(29,$toString(this));
}
var d='';
if(this.global)d+='g';
if(this.ignoreCase)d+='i';
if(this.multiline)d+='m';
if(this.unicode)d+='u';
if(this.sticky)d+='y';
return d;
}
%DefineAccessorPropertyUnchecked(c.prototype,'flags',
RegExpGetFlags,null,2);
%SetNativeFlag(RegExpGetFlags);
})

<harmony-reflect}
(function(a,b){
'use strict';
%CheckIsBootstrapping();
var c=a.Reflect;
b.InstallFunctions(c,2,[
"apply",$reflectApply,
"construct",$reflectConstruct
]);
})

8harmony-spready
var $spreadArguments;
var $spreadIterable;
(function(a,b){
'use strict';
var c=b.InternalArray;
function SpreadArguments(){
var d=%_ArgumentsLength();
var e=new c();
for(var f=0;f<d;++f){
var g=%_Arguments(f);
var h=g.length;
for(var i=0;i<h;++i){
e.push(g[i]);
}
}
return e;
}
function SpreadIterable(j){
if((j==null)){
throw MakeTypeError(56,j);
}
var e=new c();
for(var k of j){
e.push(k);
}
return e;
}
$spreadArguments=SpreadArguments;
$spreadIterable=SpreadIterable;
})

8harmony-objectÉ
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Object;
var d;
b.Import(function(e){
d=e.OwnPropertyKeys;
});
function ObjectAssign(f,g){
var h=((%_IsSpecObject(%IS_VAR(f)))?f:$toObject(f));
var i=%_ArgumentsLength();
if(i<2)return h;
for(var j=1;j<i;++j){
var k=%_Arguments(j);
if((k==null)){
continue;
}
var e=((%_IsSpecObject(%IS_VAR(k)))?k:$toObject(k));
var l=d(e);
var m=l.length;
for(var n=0;n<m;++n){
var o=l[n];
if(%IsPropertyEnumerable(e,o)){
var p=e[o];
h[o]=p;
}
}
}
return h;
}
b.InstallFunctions(c,2,[
"assign",ObjectAssign
]);
})

dharmony-sharedarraybuffer1
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.SharedArrayBuffer;
var d=a.Object;
function SharedArrayBufferConstructor(e){
if(%_IsConstructCall()){
var f=$toPositiveInteger(e,125);
%ArrayBufferInitialize(this,f,true);
}else{
throw MakeTypeError(20,"SharedArrayBuffer");
}
}
function SharedArrayBufferGetByteLen(){
if(!(%_ClassOf(this)==='SharedArrayBuffer')){
throw MakeTypeError(33,
'SharedArrayBuffer.prototype.byteLength',this);
}
return %_ArrayBufferGetByteLength(this);
}
function SharedArrayBufferIsViewJS(g){
return %ArrayBufferIsView(g);
}
%SetCode(c,SharedArrayBufferConstructor);
%FunctionSetPrototype(c,new d());
%AddNamedProperty(c.prototype,"constructor",
c,2);
%AddNamedProperty(c.prototype,
symbolToStringTag,"SharedArrayBuffer",2|1);
b.InstallGetter(c.prototype,"byteLength",
SharedArrayBufferGetByteLen);
b.InstallFunctions(c,2,[
"isView",SharedArrayBufferIsViewJS
]);
})

 dummy<(function() {})